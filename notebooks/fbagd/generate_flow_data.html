<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Import simulation output &mdash; Vivarium E. coli 0.0.1 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> Vivarium E. coli
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../reference/processes.html">Processes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/composites.html">Composites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/experiments.html">Experiments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs.html">Working with Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/index.html">Reference Material</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Vivarium E. coli</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Import simulation output</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/notebooks/fbagd/generate_flow_data.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">dill</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">xmltodict</span>
<span class="kn">import</span> <span class="nn">cvxpy</span> <span class="k">as</span> <span class="nn">cp</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">logsumexp</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;darkgrid&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">)</span>

<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">&#39;~/vivarium-ecoli&#39;</span><span class="p">))</span>

<span class="kn">from</span> <span class="nn">ecoli.processes.metabolism_redux</span> <span class="kn">import</span> <span class="n">NetworkFlowModel</span><span class="p">,</span> <span class="n">FlowResult</span>
</pre></div>
</div>
</div>
<section id="Import-simulation-output">
<h1>Import simulation output<a class="headerlink" href="#Import-simulation-output" title="Permalink to this heading"></a></h1>
<p>Before running this, run a sim in ecoli/experiments/metabolism_redux_sim.py with -n 2 to generate a simulation output. This is necessary to replicate the simulation environment. Use the default .json config.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time</span> <span class="o">=</span> <span class="s1">&#39;10&#39;</span>
<span class="n">date</span> <span class="o">=</span> <span class="s1">&#39;2023-04-14&#39;</span>
<span class="n">experiment</span> <span class="o">=</span> <span class="s1">&#39;fba-redux-standard&#39;</span>
<span class="n">entry</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">experiment</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">time</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">date</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="n">folder</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;out/fbagd/</span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="s1">/&#39;</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">folder</span> <span class="o">+</span> <span class="s1">&#39;output.npy&#39;</span><span class="p">,</span><span class="n">allow_pickle</span><span class="o">=</span><span class="s1">&#39;TRUE&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
<span class="c1"># output = np.load(r&quot;out/geneRxnVerifData/output_glc.npy&quot;, allow_pickle=True, encoding=&#39;ASCII&#39;).tolist()</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="s1">&#39;agents&#39;</span><span class="p">][</span><span class="s1">&#39;0&#39;</span><span class="p">]</span>
<span class="n">fba</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="s1">&#39;listeners&#39;</span><span class="p">][</span><span class="s1">&#39;fba_results&#39;</span><span class="p">]</span>
<span class="n">mass</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="s1">&#39;listeners&#39;</span><span class="p">][</span><span class="s1">&#39;mass&#39;</span><span class="p">]</span>
<span class="n">bulk</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">output</span><span class="p">[</span><span class="s1">&#39;bulk&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">folder</span> <span class="o">+</span> <span class="s1">&#39;agent_steps.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span>
<span class="n">agent</span> <span class="o">=</span> <span class="n">dill</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stoichiometry</span> <span class="o">=</span> <span class="n">agent</span><span class="p">[</span><span class="s1">&#39;ecoli-metabolism&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">stoichiometry</span>
<span class="n">maintenance_reaction</span> <span class="o">=</span> <span class="n">agent</span><span class="p">[</span><span class="s1">&#39;ecoli-metabolism&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">maintenance_reaction</span>
<span class="n">stoichiometry</span><span class="p">[</span><span class="s2">&quot;maintenance_reaction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">maintenance_reaction</span>

<span class="n">bad_rxns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;RXN-12440&quot;</span><span class="p">,</span> <span class="s2">&quot;TRANS-RXN-121&quot;</span><span class="p">,</span> <span class="s2">&quot;TRANS-RXN-300&quot;</span><span class="p">,</span> <span class="s2">&quot;TRANS-RXN-8&quot;</span><span class="p">,</span> <span class="s2">&quot;R15-RXN-MET/CPD-479//CPD-479/MET.25.&quot;</span><span class="p">]</span>
<span class="c1"># generate carbon mistake in parca, efflux/influx proton gen, iron cheating, mass gen</span>
<span class="k">for</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="n">bad_rxns</span><span class="p">:</span>
    <span class="n">stoichiometry</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">rxn</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<p>Pandas automatically understands dicts of dicts as matrices.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim_fluxes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">fba</span><span class="p">[</span><span class="s2">&quot;estimated_fluxes&quot;</span><span class="p">])</span>
<span class="n">sim_fluxes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">sim_fluxes</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="n">sim_fluxes</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># plot the top 10 fluxes from sim_fluxes as a bar plot.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sim_fluxes</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>

<span class="c1"># shorten all xtick names to 10 characters</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sim_fluxes</span><span class="o">.</span><span class="n">index</span><span class="p">[:</span><span class="mi">10</span><span class="p">]],</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Flux (mmol/gDCW/hr)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Top 10 Fluxes&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_fbagd_generate_flow_data_7_0.png" src="../../_images/notebooks_fbagd_generate_flow_data_7_0.png" />
</div>
</div>
</section>
<section id="Test-changing-nutrient-composition">
<h1>Test changing nutrient composition<a class="headerlink" href="#Test-changing-nutrient-composition" title="Permalink to this heading"></a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uptake</span> <span class="o">=</span> <span class="p">(</span><span class="n">fba</span><span class="p">[</span><span class="s2">&quot;unconstrained_molecules&quot;</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">uptake_c</span> <span class="o">=</span> <span class="n">fba</span><span class="p">[</span><span class="s2">&quot;constrained_molecules&quot;</span><span class="p">]</span>

<span class="n">uptake</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">uptake_c</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
<span class="n">uptake</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">uptake</span><span class="p">)</span>

<span class="c1"># addition = set([&quot;CPD0-1074[c]&quot;])</span>
<span class="n">addition</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span>
        <span class="s2">&quot;FRU[p]&quot;</span><span class="p">,</span>
        <span class="c1"># &quot;NITRATE[p]&quot;</span>
        <span class="c1"># &#39;THIAMINE[p]&#39;,</span>
        <span class="c1"># &#39;HYDROGEN-MOLECULE[p]&#39;,</span>
        <span class="c1"># &#39;FUM[p]&#39;</span>
<span class="p">])</span>
<span class="n">removals</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span>
                  <span class="s2">&quot;GLC[p]&quot;</span><span class="p">,</span>
               <span class="c1">#      # &#39;AMMONIUM[c]&#39;,</span>
               <span class="c1">#      # &#39;WATER[p]&#39;</span>
               <span class="c1">#       # &#39;Pi[p]&#39;,</span>
               <span class="c1">#       # &#39;SULFATE[p]&#39;</span>
               <span class="c1"># &#39;OXYGEN-MOLECULE[p]&#39;</span>
<span class="p">])</span>


<span class="n">uptake</span> <span class="o">=</span> <span class="n">uptake</span> <span class="o">|</span> <span class="n">addition</span>
<span class="n">uptake</span> <span class="o">=</span> <span class="n">uptake</span> <span class="o">-</span> <span class="n">removals</span>
<span class="n">uptake</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;AMMONIUM[c]&#39;,
 &#39;CA+2[p]&#39;,
 &#39;CARBON-DIOXIDE[p]&#39;,
 &#39;CL-[p]&#39;,
 &#39;CO+2[p]&#39;,
 &#39;FE+2[p]&#39;,
 &#39;FRU[p]&#39;,
 &#39;K+[p]&#39;,
 &#39;L-SELENOCYSTEINE[c]&#39;,
 &#39;MG+2[p]&#39;,
 &#39;MN+2[p]&#39;,
 &#39;NA+[p]&#39;,
 &#39;NI+2[p]&#39;,
 &#39;OXYGEN-MOLECULE[p]&#39;,
 &#39;Pi[p]&#39;,
 &#39;SULFATE[p]&#39;,
 &#39;WATER[p]&#39;,
 &#39;ZN+2[p]&#39;}
</pre></div></div>
</div>
</section>
<section id="Use-NetworkFlowModel-class-to-run-model">
<h1>Use NetworkFlowModel class to run model<a class="headerlink" href="#Use-NetworkFlowModel-class-to-run-model" title="Permalink to this heading"></a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">homeostatic</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">fba</span><span class="p">[</span><span class="s2">&quot;target_homeostatic_dmdt&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="p">:]</span>
<span class="n">exchanges</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">fba</span><span class="p">[</span><span class="s2">&quot;estimated_exchange_dmdt&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="p">:]</span>
<span class="n">maintenance</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">fba</span><span class="p">[</span><span class="s2">&quot;target_maintenance_flux&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">kinetic</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">fba</span><span class="p">[</span><span class="s2">&quot;target_kinetic_fluxes&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="p">:]</span>
<span class="n">homeostatic</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2-3-DIHYDROXYBENZOATE[c]          73
2-KETOGLUTARATE[c]               187
2-PG[c]                           49
2K-4CH3-PENTANOATE[c]             72
4-AMINO-BUTYRATE[c]              161
                              ...
WATER[c]                    22086088
XYLULOSE-5-PHOSPHATE[c]           89
ZN+2[c]                           89
ZN+2[p]                           53
glycogen-monomer[c]            35110
Name: 4, Length: 172, dtype: int64
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">NetworkFlowModel</span><span class="p">(</span><span class="n">reactions</span><span class="o">=</span><span class="n">stoichiometry</span><span class="p">,</span> <span class="n">homeostatic_metabolites</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">homeostatic</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">set_up_exchanges</span><span class="p">(</span><span class="n">exchanges</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">exchanges</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> <span class="n">uptakes</span><span class="o">=</span><span class="n">uptake</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solution</span><span class="p">:</span> <span class="n">FlowResult</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">homeostatic_targets</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">homeostatic</span><span class="p">),</span>
                                   <span class="n">maintenance_target</span><span class="o">=</span><span class="n">maintenance</span><span class="p">,</span>
                                   <span class="n">kinetic_targets</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">kinetic</span><span class="p">),</span>
                                   <span class="n">binary_kinetic_targets</span><span class="o">=</span><span class="p">{},</span>
                                   <span class="n">objective_weights</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;secretion&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span> <span class="s1">&#39;efficiency&#39;</span><span class="p">:</span> <span class="mf">0.00001</span><span class="p">,</span> <span class="s1">&#39;kinetics&#39;</span><span class="p">:</span> <span class="mf">0.000001</span><span class="p">},</span>
                                   <span class="n">upper_flux_bound</span><span class="o">=</span><span class="mi">100000000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">solution</span><span class="o">.</span><span class="n">exchanges</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
WATER[p]              1.736816e+07
FRU[p]                1.410108e+06
AMMONIUM[c]           1.375859e+06
OXYGEN-MOLECULE[p]    1.289748e+06
Pi[p]                 1.776750e+05
K+[p]                 5.145700e+04
SULFATE[p]            3.335100e+04
MG+2[p]               2.287000e+03
FE+2[p]               1.930000e+03
CA+2[p]               1.425000e+03
dtype: float64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">solution</span><span class="o">.</span><span class="n">velocities</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
TRANS-RXN-145                                                                  1.736816e+07
ATPSYN-RXN (reverse)                                                           4.181745e+06
maintenance_reaction                                                           3.058992e+06
GAPOXNPHOSPHN-RXN                                                              2.307510e+06
PHOSGLYPHOS-RXN (reverse)                                                      2.307502e+06
NADH-DEHYDROG-A-RXN-NADH/UBIQUINONE-8/PROTON//NAD/CPD-9956/PROTON.46.          2.223745e+06
3PGAREARR-RXN (reverse)                                                        2.083406e+06
2PGADEHYDRAT-RXN                                                               2.083357e+06
TRANS-RXN0-545[CCO-PM-BAC-NEG]-CARBON-DIOXIDE//CARBON-DIOXIDE.47. (reverse)    1.893273e+06
RXN0-6717                                                                      1.410108e+06
dtype: float64
</pre></div></div>
</div>
</section>
<section id="Filter-S-matrix-to-only-include-nonzero-fluxes.">
<h1>Filter S matrix to only include nonzero fluxes.<a class="headerlink" href="#Filter-S-matrix-to-only-include-nonzero-fluxes." title="Permalink to this heading"></a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># only include nonzero fluxes in solution.velocities</span>
<span class="n">nonzero_velocities</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">solution</span><span class="o">.</span><span class="n">velocities</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use nonzero_velocities to filter S matrix</span>
<span class="n">S_matrix</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">Sd</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">nonzero_velocities</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>

<span class="c1"># remove rows of S_used that sum to zero.</span>
<span class="n">S_matrix</span> <span class="o">=</span> <span class="n">S_matrix</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">S_matrix</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nonzero_velocities</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;1.5.1.20-RXN-5-METHYL-THF/NAD//METHYLENE-THF/NADH/PROTON.44. (reverse)&#39;: 3851.0,
 &#39;1.5.1.20-RXN-CPD-1302/NAD//CPD-12996/NADH/PROTON.36. (reverse)&#39;: 16094.999999999989,
 &#39;1PFRUCTPHOSN-RXN&#39;: 1238117.9886565732,
 &#39;1TRANSKETO-RXN-D-SEDOHEPTULOSE-7-P/GAP//CPD-16551/XYLULOSE-5-PHOSPHATE.56. (reverse)&#39;: 7974.0,
 &#39;2-DEHYDROPANTOATE-REDUCT-RXN (reverse)&#39;: 1131.0000000000148,
 &#39;2-ISOPROPYLMALATESYN-RXN&#39;: 56297.00000000001,
 &#39;2-OCTAPRENYL-6-METHOXYPHENOL-HYDROX-RXN&#39;: 300.0,
 &#39;2-OCTAPRENYL-6-OHPHENOL-METHY-RXN&#39;: 300.0,
 &#39;2-OCTAPRENYL-METHOXY-BENZOQ-METH-RXN&#39;: 300.0,
 &#39;2-OCTAPRENYLPHENOL-HYDROX-RXN&#39;: 300.0,
 &#39;2.3.1.157-RXN&#39;: 16505.000000000004,
 &#39;2.5.1.19-RXN&#39;: 50577.000000000015,
 &#39;2.5.1.64-RXN&#39;: 105.99999999999997,
 &#39;2.7.1.148-RXN&#39;: 47391.00000000001,
 &#39;2.7.7.60-RXN&#39;: 47391.00000000001,
 &#39;2.8.1.6-RXN&#39;: 10.0,
 &#39;2OXOGLUTARATEDEH-RXN&#39;: 248858.9773131477,
 &#39;2PGADEHYDRAT-RXN&#39;: 2083356.9773131495,
 &#39;2TRANSKETO-RXN (reverse)&#39;: 50658.00000000003,
 &#39;3-CH3-2-OXOBUTANOATE-OH-CH3-XFER-RXN-CPD-12996/2-KETO-ISOVALERATE/WATER//2-DEHYDROPANTOATE/CPD-1301.63.&#39;: 1131.0000000000148,
 &#39;3-DEHYDROQUINATE-DEHYDRATASE-RXN&#39;: 50584.00000000002,
 &#39;3-DEHYDROQUINATE-SYNTHASE-RXN&#39;: 50584.00000000003,
 &#39;3-OCTAPRENYL-4-OHBENZOATE-DECARBOX-RXN&#39;: 300.0,
 &#39;3.2.2.10-RXN-CMP/WATER//RIBOSE-5P/CYTOSINE.30.&#39;: 4.0,
 &#39;3.2.2.10-RXN-UMP/WATER//RIBOSE-5P/URACIL.28.&#39;: 1967.9999999999993,
 &#39;325-BISPHOSPHATE-NUCLEOTIDASE-RXN&#39;: 30709.000000000004,
 &#39;3PGAREARR-RXN (reverse)&#39;: 2083405.9773131497,
 &#39;4OHBENZOATE-OCTAPRENYLTRANSFER-RXN&#39;: 300.0,
 &#39;5.1.3.20-RXN&#39;: 7772.0,
 &#39;5.4.2.10-RXN-CPD-13469//GLUCOSAMINE-1P.26.&#39;: 16505.0,
 &#39;6PGLUCONOLACT-RXN&#39;: 75194.99999999833,
 &#39;ACECOATRANS-RXN-PROPIONYL-COA/ACET//PROPIONATE/ACETYL-COA.42.&#39;: 83124.0,
 &#39;ACETATEKIN-RXN&#39;: 568.0,
 &#39;ACETOLACTREDUCTOISOM-RXN (reverse)&#39;: 111928.0,
 &#39;ACETOLACTSYN-RXN&#39;: 90266.0,
 &#39;ACETOOHBUTREDUCTOISOM-RXN (reverse)&#39;: 39206.99999999999,
 &#39;ACETOOHBUTSYN-RXN&#39;: 39206.99999999999,
 &#39;ACETYL-COA-ACETYLTRANSFER-RXN&#39;: 10.0,
 &#39;ACETYLGLUTKIN-RXN&#39;: 46480.0,
 &#39;ACETYLORNDEACET-RXN&#39;: 46458.00000000001,
 &#39;ACETYLORNTRANSAM-RXN (reverse)&#39;: 46480.0,
 &#39;ACONITATEDEHYDR-RXN&#39;: 6.999999999999999,
 &#39;ACSERLY-RXN&#39;: 33348.0,
 &#39;ADCLY-RXN&#39;: 99.00000000000341,
 &#39;ADENOSYLHOMOCYSTEINE-NUCLEOSIDASE-RXN&#39;: 1070.9999999999998,
 &#39;ADENPRIBOSYLTRAN-RXN (reverse)&#39;: 2823.0,
 &#39;ADENYL-KIN-RXN&#39;: 277347.9999999967,
 &#39;ADENYLOSUCCINATE-SYNTHASE-RXN&#39;: 36221.99999999834,
 &#39;ADENYLYLSULFKIN-RXN&#39;: 33348.00000000001,
 &#39;ADOMET-DMK-METHYLTRANSFER-RXN&#39;: 53.0,
 &#39;AICARSYN-RXN&#39;: 43908.99999999835,
 &#39;AICARTRANSFORM-RXN-10-FORMYL-THF/AICAR//THF/PHOSPHORIBOSYL-FORMAMIDO-CARBOXAMIDE.62.&#39;: 57150.99999999835,
 &#39;AIRS-RXN&#39;: 43957.99999999835,
 &#39;ALANINE-AMINOTRANSFERASE-RXN (reverse)&#39;: 81414.99999999999,
 &#39;ALARACECAT-RXN&#39;: 4789.999999999999,
 &#39;AMPSYN-RXN&#39;: 36221.99999999834,
 &#39;ANTHRANSYN-RXN&#39;: 6468.0,
 &#39;ARGSUCCINLYA-RXN&#39;: 36239.0,
 &#39;ARGSUCCINSYN-RXN&#39;: 36332.0,
 &#39;ASNSYNA-RXN&#39;: 29512.999999999996,
 &#39;ASPAMINOTRANS-RXN&#39;: 128030.97731314934,
 &#39;ASPARTASE-RXN (reverse)&#39;: 427027.9773131461,
 &#39;ASPARTATE-SEMIALDEHYDE-DEHYDROGENASE-RXN (reverse)&#39;: 67322.99999999997,
 &#39;ASPARTATEKIN-RXN&#39;: 43983.999999999985,
 &#39;ASPCARBTRANS-RXN&#39;: 42406.00000000001,
 &#39;ASPDECARBOX-RXN&#39;: 1131.0000000000148,
 &#39;ATPPHOSPHORIBOSYLTRANS-RXN (reverse)&#39;: 13242.0,
 &#39;ATPSYN-RXN (reverse)&#39;: 4181744.9891011864,
 &#39;BRANCHED-CHAINAMINOTRANSFERILEU-RXN (reverse)&#39;: 39207.0,
 &#39;BRANCHED-CHAINAMINOTRANSFERLEU-RXN (reverse)&#39;: 56224.99999999999,
 &#39;BRANCHED-CHAINAMINOTRANSFERVAL-RXN (reverse)&#39;: 54499.99999999999,
 &#39;CARDIOLIPSYN-RXN-CPD-8260//CPD-12824/GLYCEROL.29.&#39;: 1486.0,
 &#39;CDPDIGLYSYN-RXN-CTP/CPD0-1422/PROTON//CPD-12815/PPI.36.&#39;: 30629.0,
 &#39;CDPKIN-RXN&#39;: 90768.0,
 &#39;CHORISMATE-SYNTHASE-RXN&#39;: 50577.000000000015,
 &#39;CHORPYRLY-RXN&#39;: 326.99999999999994,
 &#39;CITSYN-RXN&#39;: 482742.9773131495,
 &#39;CPM-KDOSYNTH-RXN&#39;: 3886.0,
 &#39;CYSTATHIONINE-BETA-LYASE-RXN&#39;: 19070.999999999993,
 &#39;D-PPENTOMUT-RXN (reverse)&#39;: 1970.9999999999993,
 &#39;DAPASYN-RXN&#39;: 10.0,
 &#39;DEOXYADENPHOSPHOR-RXN (reverse)&#39;: 2.0,
 &#39;DEOXYGUANPHOSPHOR-RXN (reverse)&#39;: 1.0,
 &#39;DEOXYRIBOSE-P-ALD-RXN (reverse)&#39;: 2130.9999999999995,
 &#39;DEPHOSPHOCOAKIN-RXN&#39;: 1107.0000000000146,
 &#39;DETHIOBIOTIN-SYN-RXN&#39;: 10.0,
 &#39;DHBDEHYD-RXN&#39;: 234.99999999999997,
 &#39;DHHB-METHYLTRANSFER-RXN&#39;: 300.0,
 &#39;DIAMINOPIMDECARB-RXN&#39;: 44068.0,
 &#39;DIAMINOPIMEPIM-RXN&#39;: 48067.99999999999,
 &#39;DIHYDRODIPICSYN-RXN&#39;: 48126.0,
 &#39;DIHYDROFOLATESYNTH-RXN&#39;: 99.00000000000341,
 &#39;DIHYDRONEOPTERIN-MONO-P-DEPHOS-RXN&#39;: 99.00000000000342,
 &#39;DIHYDROOROT-RXN (reverse)&#39;: 42093.00000000001,
 &#39;DIHYDROOROTATE-DEHYDROGENASE-RXN-DI-H-OROTATE/UBIQUINONE-8//OROTATE/CPD-9956.44.&#39;: 41059.0,
 &#39;DIHYDROXYISOVALDEHYDRAT-RXN&#39;: 111928.0,
 &#39;DIHYDROXYMETVALDEHYDRAT-RXN&#39;: 39206.99999999999,
 &#39;DIMETHUROPORDEHYDROG-RXN&#39;: 54.00000000000001,
 &#39;DIOHBUTANONEPSYN-RXN&#39;: 258.0,
 &#39;DMK-RXN&#39;: 105.99999999999997,
 &#39;DTDPKIN-RXN&#39;: 2455.9999999999995,
 &#39;DTMPKI-RXN&#39;: 2655.9999999999995,
 &#39;DURIDKI-RXN&#39;: 1967.9999999999995,
 &#39;DXPREDISOM-RXN (reverse)&#39;: 47391.00000000001,
 &#39;DXS-RXN&#39;: 47489.00000000001,
 &#39;ENTMULTI-RXN&#39;: 54.00000000000001,
 &#39;ERYTH4PDEHYDROG-RXN&#39;: 48.99999999999999,
 &#39;ERYTHRON4PDEHYDROG-RXN&#39;: 48.99999999999999,
 &#39;FADSYN-RXN&#39;: 91.0,
 &#39;FGAMSYN-RXN&#39;: 43957.99999999835,
 &#39;FPPSYN-RXN&#39;: 4419.000000000001,
 &#39;FRUCTOKINASE-RXN&#39;: 171989.99999999834,
 &#39;GAPOXNPHOSPHN-RXN&#39;: 2307509.9773131465,
 &#39;GART-RXN-10-FORMYL-THF/5-PHOSPHO-RIBOSYL-GLYCINEAMIDE//THF/5-P-RIBOSYL-N-FORMYLGLYCINEAMIDE/PROTON.90.&#39;: 43957.999999998356,
 &#39;GDPKIN-RXN&#39;: 65152.99999999835,
 &#39;GDPPYPHOSKIN-RXN&#39;: 24.999999999999996,
 &#39;GLU6PDEHYDROG-RXN-GLC-6-P/NADP//D-6-P-GLUCONO-DELTA-LACTONE/NADPH/PROTON.55.&#39;: 75194.99999999833,
 &#39;GLUC1PADENYLTRANS-RXN&#39;: 35111.0,
 &#39;GLUC1PURIDYLTRANS-RXN&#39;: 9401.0,
 &#39;GLUCOSAMINE-6-P-DEAMIN-RXN (reverse)&#39;: 17117.0,
 &#39;GLUTAMINESYN-RXN&#39;: 122975.99999999673,
 &#39;GLUTATHIONE-SYN-RXN&#39;: 7682.0,
 &#39;GLUTCYSLIG-RXN&#39;: 7682.0,
 &#39;GLUTDEHYD-RXN (reverse)&#39;: 708489.0226868491,
 &#39;GLUTKIN-RXN&#39;: 25565.0,
 &#39;GLUTRACE-RXN&#39;: 3999.9999999999995,
 &#39;GLUTRNAREDUCT-RXN (reverse)&#39;: 864.0000000000003,
 &#39;GLUTSEMIALDEHYDROG-RXN (reverse)&#39;: 25565.0,
 &#39;GLYC3PDEHYDROGBIOSYN-RXN-GLYCEROL-3P/NAD//DIHYDROXY-ACETONE-PHOSPHATE/NADH/PROTON.57. (reverse)&#39;: 39046.00000000001,
 &#39;GLYCDEH-RXN&#39;: 1485.9999999999998,
 &#39;GLYCOLALD-DEHYDROG-RXN&#39;: 99.0000000000034,
 &#39;GLYCOLATEDEHYDRO-RXN&#39;: 99.00000000000341,
 &#39;GLYOHMETRANS-RXN-SER/CPD-1301//GLY/CPD-12996/WATER.34.&#39;: 17226.000000000004,
 &#39;GLYOHMETRANS-RXN-SER/THF//GLY/METHYLENE-THF/WATER.33.&#39;: 107665.99999999671,
 &#39;GLYRIBONUCSYN-RXN&#39;: 43957.99999999834,
 &#39;GMKALT-RXN (reverse)&#39;: 26.999999999999996,
 &#39;GMP-SYN-NH3-RXN&#39;: 20522.000000000007,
 &#39;GPPSYN-RXN&#39;: 4419.000000000001,
 &#39;GSAAMINOTRANS-RXN&#39;: 864.0000000000003,
 &#39;GTP-CYCLOHYDRO-I-RXN&#39;: 99.00000000000342,
 &#39;GTP-CYCLOHYDRO-II-RXN&#39;: 129.0,
 &#39;GUANYL-KIN-RXN&#39;: 29205.000000000004,
 &#39;H2NEOPTERINALDOL-RXN&#39;: 99.00000000000341,
 &#39;H2NEOPTERINP3PYROPHOSPHOHYDRO-RXN&#39;: 99.00000000000342,
 &#39;H2PTERIDINEPYROPHOSPHOKIN-RXN&#39;: 99.00000000000341,
 &#39;H2PTEROATESYNTH-RXN&#39;: 99.00000000000341,
 &#39;HISTAMINOTRANS-RXN (reverse)&#39;: 13241.999999999998,
 &#39;HISTCYCLOHYD-RXN&#39;: 13241.999999999996,
 &#39;HISTIDPHOS-RXN[CCO-CYTOSOL]-L-HISTIDINOL-P/WATER//HISTIDINOL/Pi.49.&#39;: 13241.999999999998,
 &#39;HISTPRATPHYD-RXN&#39;: 13241.999999999998,
 &#39;HOMOCYSMET-RXN&#39;: 16094.999999999989,
 &#39;HOMOCYSMETB12-RXN-HOMO-CYS/5-METHYL-THF//MET/THF.31.&#39;: 3850.9999999999995,
 &#39;HOMOSERDEHYDROG-RXN-HOMO-SER/NAD//L-ASPARTATE-SEMIALDEHYDE/NADH/PROTON.51. (reverse)&#39;: 19196.999999999993,
 &#39;HOMSUCTRAN-RXN&#39;: 19070.99999999999,
 &#39;IGPSYN-RXN&#39;: 6467.0,
 &#39;IMIDPHOSDEHYD-RXN&#39;: 13242.0,
 &#39;IMP-DEHYDROG-RXN&#39;: 20522.000000000007,
 &#39;IMPCYCLOHYDROLASE-RXN (reverse)&#39;: 57150.999999998356,
 &#39;INOPHOSPHOR-RXN (reverse)&#39;: 2.0000000000000004,
 &#39;INORGPYROPHOSPHAT-RXN[CCO-CYTOSOL]-PPI/WATER//Pi/PROTON.34.&#39;: 535477.9999999984,
 &#39;INOSINEKIN-RXN&#39;: 3.0000000000000004,
 &#39;ISOCHORMAT-RXN&#39;: 234.99999999999997,
 &#39;ISOCIT-CLEAV-RXN&#39;: 62574.00000000164,
 &#39;ISOCITDEH-RXN&#39;: 419041.9773131478,
 &#39;ISPH2-RXN (reverse)&#39;: 42972.0,
 &#39;KDO-8PPHOSPHAT-RXN&#39;: 3886.0,
 &#39;KDO-8PSYNTH-RXN&#39;: 3886.0,
 &#39;KDOTRANS-RXN&#39;: 1943.0,
 &#39;KDOTRANS2-RXN&#39;: 1943.0,
 &#39;LIPIDADISACCHARIDESYNTH-RXN&#39;: 1943.0,
 &#39;LIPIDXSYNTHESIS-RXN&#39;: 1943.0,
 &#39;LUMAZINESYN-RXN&#39;: 258.0,
 &#39;MALSYN-RXN&#39;: 1055.0,
 &#39;METHENYLTHFCYCLOHYDRO-RXN-5-10-METHENYL-THF/WATER//10-FORMYL-THF/PROTON.46.&#39;: 101108.9999999967,
 &#39;METHYLENETHFDEHYDROG-NADP-RXN-METHYLENE-THF/NADP//5-10-METHENYL-THF/NADPH.44.&#39;: 101108.99999999671,
 &#39;METHYLMALONYL-COA-MUT-RXN (reverse)&#39;: 2.9999999999949027,
 &#39;METHYLTHIOADENOSINE-NUCLEOSIDASE-RXN&#39;: 1638.0,
 &#39;N-ACETYLGLUTPREDUCT-RXN (reverse)&#39;: 46480.0,
 &#39;N-ACETYLTRANSFER-RXN&#39;: 46479.99999999999,
 &#39;NACGLCTRANS-RXN&#39;: 4000.0,
 &#39;NAD-KIN-RXN&#39;: 137.99999999995487,
 &#39;NAD-SYNTH-NH3-RXN&#39;: 1407.999999999983,
 &#39;NADH-DEHYDROG-A-RXN-NADH/UBIQUINONE-8/PROTON//NAD/CPD-9956/PROTON.46.&#39;: 2223744.8865657323,
 &#39;NAG1P-URIDYLTRANS-RXN&#39;: 16463.0,
 &#39;NAPHTHOATE-SYN-RXN&#39;: 105.99999999999997,
 &#39;NICONUCADENYLYLTRAN-RXN&#39;: 1407.999999999983,
 &#39;NUCLEOSIDE-DIPHOSPHATASE-RXN-DUDP/WATER//DUMP/Pi/PROTON.27.&#39;: 687.9999999999999,
 &#39;O-SUCCHOMOSERLYASE-RXN&#39;: 19070.999999999993,
 &#39;O-SUCCINYLBENZOATE-COA-LIG-RXN&#39;: 105.99999999999997,
 &#39;O-SUCCINYLBENZOATE-COA-SYN-RXN&#39;: 105.99999999999997,
 &#39;OCTAPRENYL-METHYL-METHOXY-BENZOQ-OH-RXN&#39;: 300.0,
 &#39;OHMETHYLBILANESYN-RXN&#39;: 108.00000000000003,
 &#39;ORNCARBAMTRANSFER-RXN&#39;: 36737.0,
 &#39;ORNDECARBOX-RXN&#39;: 9716.0,
 &#39;OROPRIBTRANS-RXN (reverse)&#39;: 38151.00000000001,
 &#39;OROTPDECARB-RXN&#39;: 38151.00000000001,
 &#39;P-PANTOCYSDECARB-RXN&#39;: 1107.0000000000146,
 &#39;P-PANTOCYSLIG-RXN&#39;: 1107.0000000000146,
 &#39;PABASYN-RXN&#39;: 99.00000000000341,
 &#39;PANTEPADENYLYLTRAN-RXN&#39;: 1107.0000000000146,
 &#39;PANTOATE-BETA-ALANINE-LIG-RXN&#39;: 1131.0000000000148,
 &#39;PANTOTHENATE-KIN-RXN&#39;: 1107.0000000000146,
 &#39;PDXJ-RXN&#39;: 48.99999999999999,
 &#39;PEPCARBOX-RXN (reverse)&#39;: 354713.0000000001,
 &#39;PEPDEPHOS-RXN (reverse)&#39;: 209423.98865657835,
 &#39;PGLUCISOM-RXN-GLC-6-P//FRUCTOSE-6P.21. (reverse)&#39;: 122063.99999999831,
 &#39;PGLYCDEHYDROG-RXN&#39;: 223276.9999999967,
 &#39;PGPPHOSPHA-RXN-CPD-12821/WATER//CPD-8260/Pi.29.&#39;: 8324.000000000002,
 &#39;PHOSGLYPHOS-RXN (reverse)&#39;: 2307501.977313146,
 &#39;PHOSNACMURPENTATRANS-RXN&#39;: 4000.0,
 &#39;PHOSPHAGLYPSYN-RXN-CPD-12815/GLYCEROL-3P//CMP/CPD-12821/PROTON.44.&#39;: 8324.0,
 &#39;PHOSPHASERDECARB-RXN-CPD-12817/PROTON//CPD-12819/CARBON-DIOXIDE.43.&#39;: 22305.0,
 &#39;PHOSPHASERSYN-RXN-CPD-12815/SER//CMP/CPD-12817/PROTON.36.&#39;: 22305.0,
 &#39;PHOSPHOGLUCMUT-RXN-GLC-1-P//GLC-6-P.17. (reverse)&#39;: 44511.99999999999,
 &#39;PNPOXI-RXN&#39;: 48.99999999999999,
 &#39;PORPHOBILSYNTH-RXN&#39;: 432.00000000000017,
 &#39;PRAISOM-RXN&#39;: 6467.0,
 &#39;PREPHENATEDEHYDRAT-RXN&#39;: 23552.000000000004,
 &#39;PREPHENATEDEHYDROG-RXN&#39;: 19736.0,
 &#39;PRIBFAICARPISOM-RXN&#39;: 13241.999999999996,
 &#39;PROTOHEMEFERROCHELAT-RXN[CCO-CYTOSOL]-PROTOHEME/PROTON//PROTOPORPHYRIN_IX/FE+2.54. (reverse)&#39;: 54.00000000000001,
 &#39;PRPPAMIDOTRANS-RXN (reverse)&#39;: 43957.99999999834,
 &#39;PRPPSYN-RXN&#39;: 1711.9999999999998,
 &#39;PRPPSYN-RXN-CPD-16551/ATP//PRPP/AMP/PROTON.31.&#39;: 104473.99999999834,
 &#39;PRTRANS-RXN (reverse)&#39;: 6467.0,
 &#39;PSERTRANSAM-RXN (reverse)&#39;: 222526.99999999668,
 &#39;PSERTRANSAMPYR-RXN (reverse)&#39;: 48.99999999999999,
 &#39;PYRIMSYN1-RXN&#39;: 49.00000000000001,
 &#39;PYRIMSYN3-RXN&#39;: 49.00000000000001,
 &#39;PYRROLINECARBREDUCT-RXN-PRO/NAD//L-DELTA1-PYRROLINE_5-CARBOXYLATE/NADH/PROTON.54. (reverse)&#39;: 25565.0,
 &#39;PYRUVDEH-RXN&#39;: 1027758.9773131494,
 &#39;QUINOLINATE-SYNTHA-RXN&#39;: 1412.9999999999834,
 &#39;QUINOPRIBOTRANS-RXN (reverse)&#39;: 1407.9999999999832,
 &#39;R15-RXN-MET/2-KETOGLUTARATE//CPD-479/GLT.33. (reverse)&#39;: 61618.000000001644,
 &#39;R15-RXN-MET/GLYOX//CPD-479/GLY.23.&#39;: 61618.00000000164,
 &#39;RIB5PISOM-RXN-CPD-16551//RIBULOSE-5P.23. (reverse)&#39;: 112399.99999999834,
 &#39;RIBOFLAVIN-SYN-RXN&#39;: 129.0,
 &#39;RIBOFLAVINKIN-RXN&#39;: 119.0,
 &#39;RIBOFLAVINSYNDEAM-RXN&#39;: 129.0,
 &#39;RIBOFLAVINSYNREDUC-RXN (reverse)&#39;: 129.0,
 &#39;RIBOPHOSPHAT-RXN&#39;: 129.0,
 &#39;RIBOSYLHOMOCYSTEINASE-RXN&#39;: 1070.9999999999998,
 &#39;RIBULP3EPIM-RXN (reverse)&#39;: 42595.00000000003,
 &#39;RXN-10814 (reverse)&#39;: 23505.0,
 &#39;RXN-11032 (reverse)&#39;: 200.9999999999966,
 &#39;RXN-11319&#39;: 49.00000000000001,
 &#39;RXN-11475&#39;: 10.0,
 &#39;RXN-11484&#39;: 10.0,
 &#39;RXN-11832&#39;: 90785.0,
 &#39;RXN-12002&#39;: 48258.0,
 &#39;RXN-12588&#39;: 10.0,
 &#39;RXN-12611&#39;: 49.0,
 &#39;RXN-13158&#39;: 56297.0,
 &#39;RXN-13163 (reverse)&#39;: 56297.0,
 &#39;RXN-13179&#39;: 48.99999999999999,
 &#39;RXN-13202&#39;: 79143.0,
 &#39;RXN-13403&#39;: 54.00000000000001,
 &#39;RXN-14014-DELTA1-PIPERIDEINE-2-6-DICARBOXYLATE/NAD/WATER//CPD-14443/NADH/PROTON.70. (reverse)&#39;: 48125.99999999999,
 &#39;RXN-14025[CCO-CYTOSOL]-UMP/WATER//URIDINE/Pi.35.&#39;: 1111.0,
 &#39;RXN-14026[CCO-CYTOSOL]-CMP/WATER//CYTIDINE/Pi.36.&#39;: 0.9999999999999999,
 &#39;RXN-14047&#39;: 481759.97731314943,
 &#39;RXN-14325&#39;: 14879.000000000013,
 &#39;RXN-15216&#39;: 1071.0,
 &#39;RXN-15878 (reverse)&#39;: 47391.00000000001,
 &#39;RXN-15943 (reverse)&#39;: 1071.0,
 &#39;RXN-16804&#39;: 3886.0,
 &#39;RXN-17900&#39;: 13241.999999999998,
 &#39;RXN-19329 (reverse)&#39;: 2755.000000000003,
 &#39;RXN-19737&#39;: 1943.0,
 &#39;RXN-21483-PROTOPORPHYRINOGEN/UBIQUINONE-8//PROTOPORPHYRIN_IX/CPD-9956.60.&#39;: 54.000000000000014,
 &#39;RXN-21817-CPD-9956/PROTON/OXYGEN-MOLECULE//UBIQUINONE-8/PROTON/WATER.59.&#39;: 1288717.4319394408,
 &#39;RXN-6081&#39;: 200.9999999999966,
 &#39;RXN-6161&#39;: 80807.00000000001,
 &#39;RXN-8001&#39;: 13235.999999999998,
 &#39;RXN-8992&#39;: 405.99999999999994,
 &#39;RXN-8999&#39;: 4013.0000000000005,
 &#39;RXN-9310&#39;: 105.99999999999997,
 &#39;RXN-9311&#39;: 105.99999999999997,
 &#39;RXN-9772&#39;: 1412.9999999999834,
 &#39;RXN-9952&#39;: 74069.99999999831,
 &#39;RXN0-12&#39;: 89.0,
 &#39;RXN0-1461&#39;: 54.000000000000014,
 &#39;RXN0-16&#39;: 181.0,
 &#39;RXN0-2421&#39;: 1878.0000000000002,
 &#39;RXN0-2501&#39;: 686.0000000000001,
 &#39;RXN0-268 (reverse)&#39;: 83124.0,
 &#39;RXN0-302&#39;: 47391.00000000001,
 &#39;RXN0-305&#39;: 750.0,
 &#39;RXN0-310&#39;: 2.999999999994903,
 &#39;RXN0-313 (reverse)&#39;: 1454.9999999999998,
 &#39;RXN0-4301&#39;: 7772.0,
 &#39;RXN0-4341&#39;: 7772.0,
 &#39;RXN0-4342&#39;: 7772.0,
 &#39;RXN0-4361&#39;: 7772.0,
 &#39;RXN0-5038&#39;: 1.0000000000000002,
 &#39;RXN0-5061&#39;: 1943.0,
 &#39;RXN0-5114[CCO-CYTOSOL]-3-P-SERINE/WATER//SER/Pi.38.&#39;: 222526.9999999967,
 &#39;RXN0-5118&#39;: 1943.0,
 &#39;RXN0-5120&#39;: 1943.0,
 &#39;RXN0-5121&#39;: 1943.0,
 &#39;RXN0-5122&#39;: 1943.0,
 &#39;RXN0-5123&#39;: 1943.0,
 &#39;RXN0-5124&#39;: 1943.0,
 &#39;RXN0-5125&#39;: 1943.0,
 &#39;RXN0-5126&#39;: 1943.0,
 &#39;RXN0-5127&#39;: 1943.0,
 &#39;RXN0-5185[CCO-CYTOSOL]-CPD-2961/WATER//GLUCONATE/Pi.42.&#39;: 21.0,
 &#39;RXN0-5186&#39;: 169010.99999999834,
 &#39;RXN0-5199&#39;: 3.0,
 &#39;RXN0-5224 (reverse)&#39;: 974623.9999999985,
 &#39;RXN0-5289 (reverse)&#39;: 750.0000000000001,
 &#39;RXN0-5461&#39;: 1071.0,
 &#39;RXN0-6550&#39;: 117.99999999999999,
 &#39;RXN0-6562&#39;: 750.0,
 &#39;RXN0-7352-GMP/WATER//GUANINE/CPD-16551.29.&#39;: 47.99999999999999,
 &#39;RXN0-742&#39;: 43908.99999999835,
 &#39;RXN0-743&#39;: 43908.99999999835,
 &#39;RXN0-884 (reverse)&#39;: 4419.000000000001,
 &#39;RXN3O-470-ACETALD//CPD-255.17. (reverse)&#39;: 200.99999999999696,
 &#39;S-ADENMETSYN-RXN&#39;: 2934.0000000000005,
 &#39;SAICARSYN-RXN&#39;: 43908.99999999835,
 &#39;SAMDECARB-RXN&#39;: 1638.0,
 &#39;SHIKIMATE-5-DEHYDROGENASE-RXN (reverse)&#39;: 50584.00000000002,
 &#39;SHIKIMATE-KINASE-RXN&#39;: 50577.00000000002,
 &#39;SIROHEME-FERROCHELAT-RXN&#39;: 54.00000000000001,
 &#39;SPERMIDINESYN-RXN&#39;: 1638.0,
 &#39;SPONTPRO-RXN (reverse)&#39;: 25565.0,
 &#39;SUCCCOASYN-RXN (reverse)&#39;: 98411.97731314773,
 &#39;SUCCDIAMINOPIMDESUCC-RXN&#39;: 48125.99999999999,
 &#39;SUCCINATE-DEHYDROGENASE-UBIQUINONE-RXN-SUC/UBIQUINONE-8//FUM/CPD-9956.31.&#39;: 312468.9773131494,
 &#39;SUCCINYLDIAMINOPIMTRANS-RXN (reverse)&#39;: 48125.99999999999,
 &#39;SULFATE-ADENYLYLTRANS-RXN&#39;: 33351.00000000001,
 &#39;SULFITE-REDUCT-RXN (reverse)&#39;: 33348.00000000001,
 &#39;TETHYDPICSUCC-RXN&#39;: 48125.99999999999,
 &#39;TETRAACYLDISACC4KIN-RXN&#39;: 1943.0,
 &#39;THI-P-KIN-RXN&#39;: 48.99999999999999,
 &#39;THREDEHYD-RXN&#39;: 39207.0,
 &#39;THREONINE-ALDOLASE-RXN (reverse)&#39;: 79078.00000000001,
 &#39;THYMIDYLATESYN-RXN-METHYLENE-THF/DUMP//TMP/DIHYDROFOLATE.38.&#39;: 2655.9999999999995,
 &#39;TRANS-RXN-1&#39;: 497.00000000000347,
 &#39;TRANS-RXN-114&#39;: 177621.99999999587,
 &#39;TRANS-RXN-141&#39;: 2287.0,
 &#39;TRANS-RXN-141A&#39;: 6.999999999999999,
 &#39;TRANS-RXN-141B&#39;: 85.0,
 &#39;TRANS-RXN-145&#39;: 17368157.068060577,
 &#39;TRANS-RXN-3&#39;: 51456.99999999999,
 &#39;TRANS-RXN-62A&#39;: 999.9999999999999,
 &#39;TRANS-RXN0-277 (reverse)&#39;: 1067381.045373708,
 &#39;TRANS-RXN0-286&#39;: 3999.9999999999995,
 &#39;TRANS-RXN0-459&#39;: 10.0,
 &#39;TRANS-RXN0-461&#39;: 1638.0,
 &#39;TRANS-RXN0-474&#39;: 1289695.9319394408,
 &#39;TRANS-RXN0-497&#39;: 1372.0,
 &#39;TRANS-RXN0-500&#39;: 49.00000000000001,
 &#39;TRANS-RXN0-545[CCO-PM-BAC-NEG]-CARBON-DIOXIDE//CARBON-DIOXIDE.47. (reverse)&#39;: 1893272.931939446,
 &#39;TRANS-RXN0-556[CCO-PM-BAC-NEG]-CARBON-MONOXIDE//CARBON-MONOXIDE.49. (reverse)&#39;: 49.00000000000001,
 &#39;TRANS-RXN0-586&#39;: 33351.00000000001,
 &#39;TRIOSEPISOMERIZATION-RXN (reverse)&#39;: 1177220.9886565732,
 &#39;TRYPSYN-RXN&#39;: 6466.999999999999,
 &#39;TYROSINE-AMINOTRANSFERASE-RXN (reverse)&#39;: 19736.0,
 &#39;UDP-NACMUR-ALA-LIG-RXN&#39;: 4000.0,
 &#39;UDP-NACMURALA-GLU-LIG-RXN&#39;: 4000.0,
 &#39;UDP-NACMURALGLDAPAALIG-RXN&#39;: 4000.0,
 &#39;UDP-NACMURALGLDAPLIG-RXN&#39;: 4000.0,
 &#39;UDPACYLGLCNACDEACETYL-RXN&#39;: 3886.0,
 &#39;UDPGLUCEPIM-RXN&#39;: 1942.9999999999998,
 &#39;UDPKIN-RXN&#39;: 62721.00000000001,
 &#39;UDPNACETYLGLUCOSAMENOLPYRTRANS-RXN&#39;: 4000.0,
 &#39;UDPNACETYLMURAMATEDEHYDROG-RXN (reverse)&#39;: 4000.0,
 &#39;UGD-RXN&#39;: 301.0,
 &#39;UNDECAPRENYL-DIPHOSPHATASE-RXN[CCO-CYTOSOL]-UNDECAPRENYL-DIPHOSPHATE/WATER//CPD-9646/Pi/PROTON.64.&#39;: 3857.0,
 &#39;URA-PHOSPH-RXN (reverse)&#39;: 1967.9999999999998,
 &#39;UROGENDECARBOX-RXN&#39;: 54.000000000000014,
 &#39;UROGENIIISYN-RXN&#39;: 108.00000000000004,
 &#39;glycogen-monomer-extension&#39;: 35110.0,
 &#39;GLURS-RXN-GLT-tRNAs/GLT/ATP/PROTON//Charged-GLT-tRNAs/AMP/PPI.52.&#39;: 864.0000000000003,
 &#39;RXN0-5405&#39;: 1999.9999999999998,
 &#39;RXN-11302&#39;: 999.9999999999999,
 &#39;1.8.4.8-RXN (reverse)&#39;: 33348.00000000001,
 &#39;2.3.1.180-RXN&#39;: 72916.00000000001,
 &#39;3-HYDROXYDECANOYL-ACP-DEHYDR-RXN-POLYMER-INST-OH-ACYL-ACP-C0-H0//POLYMER-INST-TRANS-D2-ENOYL-ACP-C0-H0/WATER.76.&#39;: 72916.0,
 &#39;3-HYDROXYDECANOYL-ACP-DEHYDR-RXN-POLYMER-INST-OH-ACYL-ACP-C12-H24//2-Hexadecenoyl-ACPs/WATER.60.&#39;: 61258.0,
 &#39;3-OXOACYL-ACP-REDUCT-RXN-POLYMER-INST-OH-ACYL-ACP-C0-H0/NADP//Acetoacetyl-ACPs/NADPH/PROTON.67. (reverse)&#39;: 72916.0,
 &#39;3-OXOACYL-ACP-REDUCT-RXN-POLYMER-INST-OH-ACYL-ACP-C12-H24/NADP//3-oxo-palmitoyl-ACPs/NADPH/PROTON.73. (reverse)&#39;: 61258.0,
 &#39;4.2.1.59-RXN&#39;: 72916.00000000001,
 &#39;BIOTIN-CARBOXYL-RXN&#39;: 496859.0000000001,
 &#39;ENOYL-ACP-REDUCT-NADH-RXN-Butanoyl-ACPs/NAD//POLYMER-INST-TRANS-D2-ENOYL-ACP-C0-H0/NADH/PROTON.69. (reverse)&#39;: 72916.0,
 &#39;FERREDOXIN--NAD+-REDUCTASE-RXN (reverse)&#39;: 9.999999999999998,
 &#39;LAUROYLACYLTRAN-RXN&#39;: 1943.0,
 &#39;MALONYL-COA-ACP-TRANSACYL-RXN&#39;: 496841.00000000006,
 &#39;MYRISTOYLACYLTRAN-RXN&#39;: 1943.0,
 &#39;PRODISULFREDUCT-A-RXN-GLUTATHIONE/Oxidized-NrdH-Proteins//OXIDIZED-GLUTATHIONE/Reduced-NrdH-Proteins.79.&#39;: 714.9999999999999,
 &#39;PYFLAVOXRE-RXN&#39;: 47391.00000000001,
 &#39;PYRUFLAVREDUCT-RXN&#39;: 47440.00000000001,
 &#39;RXN-11474&#39;: 10.0,
 &#39;RXN-11476 (reverse)&#39;: 10.0,
 &#39;RXN-11477&#39;: 10.0,
 &#39;RXN-11478 (reverse)&#39;: 10.0,
 &#39;RXN-11479&#39;: 10.0,
 &#39;RXN-11480 (reverse)&#39;: 10.0,
 &#39;RXN-11481&#39;: 10.0,
 &#39;RXN-11482 (reverse)&#39;: 10.0,
 &#39;RXN-11483&#39;: 10.0,
 &#39;RXN-17018&#39;: 30629.0,
 &#39;RXN-9516&#39;: 72916.0,
 &#39;RXN-9518 (reverse)&#39;: 72916.0,
 &#39;RXN-9520&#39;: 72916.0,
 &#39;RXN-9523&#39;: 72916.0,
 &#39;RXN-9524 (reverse)&#39;: 72916.00000000001,
 &#39;RXN-9527&#39;: 72916.0,
 &#39;RXN-9528 (reverse)&#39;: 72916.0,
 &#39;RXN-9531&#39;: 72916.0,
 &#39;RXN-9532 (reverse)&#39;: 72916.0,
 &#39;RXN-9533&#39;: 72916.0,
 &#39;RXN-9535&#39;: 70854.00000000001,
 &#39;RXN-9536 (reverse)&#39;: 70973.0,
 &#39;RXN-9537&#39;: 63201.0,
 &#39;RXN-9539&#39;: 61258.00000000001,
 &#39;RXN-9655&#39;: 72916.00000000001,
 &#39;RXN-9658 (reverse)&#39;: 72916.0,
 &#39;RXN-9659 (reverse)&#39;: 72916.00000000001,
 &#39;RXN-9660 (reverse)&#39;: 72916.0,
 &#39;RXN-9661 (reverse)&#39;: 72916.00000000001,
 &#39;RXN-9662 (reverse)&#39;: 63201.0,
 &#39;RXN-9663 (reverse)&#39;: 61258.0,
 &#39;RXN-9787&#39;: 48.99999999999999,
 &#39;RXN-9788&#39;: 49.0,
 &#39;RXN-9789&#39;: 49.0,
 &#39;RXN0-5055&#39;: 496859.0000000001,
 &#39;RXN0-6705&#39;: 30628.999999999996,
 &#39;RXN0-6717&#39;: 1410107.9886565716,
 &#39;RXN0-722 (reverse)&#39;: 688.0,
 &#39;RXN0-723&#39;: 18.0,
 &#39;RXN0-745&#39;: 12.000000000000002,
 &#39;RXN0-746&#39;: 8.000000000000002,
 &#39;RXN0-748 (reverse)&#39;: 26.999999999999993,
 &#39;THIAZOLSYN2-RXN&#39;: 49.0,
 &#39;THIOREDOXIN-REDUCT-NADPH-RXN (reverse)&#39;: 33348.0,
 &#39;TRANS-RXN0-582-FRU/PTSI-PHOSPHORYLATED//FRU1P/PTSI-MONOMER.44.&#39;: 1410107.9886565716,
 &#39;UDPHYDROXYMYRGLUCOSAMNACETYLTRANS-RXN&#39;: 3886.0,
 &#39;UDPNACETYLGLUCOSAMACYLTRANS-RXN&#39;: 3886.0,
 &#39;325-BISPHOSPHATE-NUCLEOTIDASE-RXN__EG10043-MONOMER&#39;: 2639.0,
 &#39;ACETOLACTSYN-RXN__ACETOLACTSYNI-CPLX&#39;: 21863.000000000004,
 &#39;ALARACECAT-RXN__CPLX0-8202&#39;: 2318.0,
 &#39;ASNSYNA-RXN__ASNSYNB-CPLX&#39;: 381.0,
 &#39;ASPARTATEKIN-RXN__ASPKINIHOMOSERDEHYDROGI-CPLX&#39;: 23339.0,
 &#39;CATAL-RXN__CPLX0-1683&#39;: 24.499999999999996,
 &#39;CHORISMATEMUT-RXN__CHORISMUTPREPHENDEHYDROG-CPLX&#39;: 43288.0,
 &#39;DAHPSYN-RXN__AROG-CPLX&#39;: 36475.00000000003,
 &#39;DAHPSYN-RXN__AROH-CPLX&#39;: 14109.0,
 &#39;DALADALALIG-RXN__DALADALALIGB-CPLX&#39;: 1869.9999999999998,
 &#39;DALADALALIG-RXN__DALADALALIGA-MONOMER&#39;: 2184.0,
 &#39;DARAB5PISOM-RXN__CPLX0-1262 (reverse)&#39;: 3886.0,
 &#39;F16ALDOLASE-RXN__FRUCBISALD-CLASSII&#39;: 1217576.988656573,
 &#39;F16ALDOLASE-RXN__FRUCBISALD-CLASSI&#39;: 35.0,
 &#39;F16BDEPHOS-RXN[CCO-CYTOSOL]-FRUCTOSE-16-DIPHOSPHATE/WATER//FRUCTOSE-6P/Pi.59.__F16B-CPLX&#39;: 11249.0,
 &#39;F16BDEPHOS-RXN[CCO-CYTOSOL]-FRUCTOSE-16-DIPHOSPHATE/WATER//FRUCTOSE-6P/Pi.59.__EG11239-MONOMER&#39;: 3294.0,
 &#39;F16BDEPHOS-RXN[CCO-CYTOSOL]-FRUCTOSE-16-DIPHOSPHATE/WATER//FRUCTOSE-6P/Pi.59.__CPLX0-303&#39;: 2570.0,
 &#39;F16BDEPHOS-RXN[CCO-CYTOSOL]-FRUCTOSE-16-DIPHOSPHATE/WATER//FRUCTOSE-6P/Pi.59.__CPLX0-7776&#39;: 4.0,
 &#39;GLUTDECARBOX-RXN__GLUTDECARBOXB-CPLX&#39;: 161.00000000000003,
 &#39;ISOCHORSYN-RXN__ENTC-MONOMER&#39;: 315.99999999999994,
 &#39;ISOCHORSYN-RXN__MENF-CPLX&#39;: 24.999999999999996,
 &#39;RXN-7609[CCO-CYTOSOL]-GMP/WATER//GUANOSINE/Pi.37.__G7742-MONOMER&#39;: 3.0,
 &#39;RXN-9535__FABB-CPLX&#39;: 119.0,
 &#39;RXN0-313__CPLX0-201 (reverse)&#39;: 30.999999999999996,
 &#39;RXN0-384__H2NEOPTERINP3PYROPHOSPHOHYDRO-MONOMER&#39;: 4.000000000000001,
 &#39;RXN0-5186__G7408-MONOMER&#39;: 2979.0,
 &#39;SERINE-O-ACETTRAN-RXN__CPLX0-237&#39;: 17162.000000000007,
 &#39;SERINE-O-ACETTRAN-RXN__CYSSYNMULTI-CPLX&#39;: 16186.0,
 &#39;UNDECAPRENYL-DIPHOSPHATASE-RXN[CCO-CYTOSOL]-UNDECAPRENYL-DIPHOSPHATE/WATER//CPD-9646/Pi/PROTON.64.__PGPPHOSPHAB-MONOMER&#39;: 143.0,
 &#39;maintenance_reaction&#39;: 3058991.943727506}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">S_matrix</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1.5.1.20-RXN-5-METHYL-THF/NAD//METHYLENE-THF/NADH/PROTON.44. (reverse)</th>
      <th>1.5.1.20-RXN-CPD-1302/NAD//CPD-12996/NADH/PROTON.36. (reverse)</th>
      <th>1PFRUCTPHOSN-RXN</th>
      <th>1TRANSKETO-RXN-D-SEDOHEPTULOSE-7-P/GAP//CPD-16551/XYLULOSE-5-PHOSPHATE.56. (reverse)</th>
      <th>2-DEHYDROPANTOATE-REDUCT-RXN (reverse)</th>
      <th>2-ISOPROPYLMALATESYN-RXN</th>
      <th>2-OCTAPRENYL-6-METHOXYPHENOL-HYDROX-RXN</th>
      <th>2-OCTAPRENYL-6-OHPHENOL-METHY-RXN</th>
      <th>2-OCTAPRENYL-METHOXY-BENZOQ-METH-RXN</th>
      <th>2-OCTAPRENYLPHENOL-HYDROX-RXN</th>
      <th>...</th>
      <th>ISOCHORSYN-RXN__MENF-CPLX</th>
      <th>RXN-7609[CCO-CYTOSOL]-GMP/WATER//GUANOSINE/Pi.37.__G7742-MONOMER</th>
      <th>RXN-9535__FABB-CPLX</th>
      <th>RXN0-313__CPLX0-201 (reverse)</th>
      <th>RXN0-384__H2NEOPTERINP3PYROPHOSPHOHYDRO-MONOMER</th>
      <th>RXN0-5186__G7408-MONOMER</th>
      <th>SERINE-O-ACETTRAN-RXN__CPLX0-237</th>
      <th>SERINE-O-ACETTRAN-RXN__CYSSYNMULTI-CPLX</th>
      <th>UNDECAPRENYL-DIPHOSPHATASE-RXN[CCO-CYTOSOL]-UNDECAPRENYL-DIPHOSPHATE/WATER//CPD-9646/Pi/PROTON.64.__PGPPHOSPHAB-MONOMER</th>
      <th>maintenance_reaction</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>NAD[c]</th>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>NADH[c]</th>
      <td>-1</td>
      <td>-1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>PROTON[c]</th>
      <td>-1</td>
      <td>-1</td>
      <td>1</td>
      <td>0</td>
      <td>-1</td>
      <td>1</td>
      <td>-1</td>
      <td>1</td>
      <td>1</td>
      <td>-1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>-1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>GLUCONATE[c]</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>NADP[c]</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>R-3-hydroxymyristoyl-ACPs[c]</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Adenylated-ThiS-Proteins[c]</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>ThiS-CoASH-proteins[c]</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Thi-S[c]</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>FRU[p]</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>491 rows × 471 columns</p>
</div></div>
</div>
</section>
<section id="First-test.-Single-flux-set.-No-eQuilibrator-or-regulation.">
<h1>First test. Single flux set. No eQuilibrator or regulation.<a class="headerlink" href="#First-test.-Single-flux-set.-No-eQuilibrator-or-regulation." title="Permalink to this heading"></a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sort nonzero_velocities to be in same order as S_matrix columns.</span>
<span class="n">vE_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">nonzero_velocities</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">S_matrix</span><span class="o">.</span><span class="n">columns</span><span class="p">}</span>
<span class="n">vE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">vE_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()))])</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Sd</span> <span class="o">=</span> <span class="n">S_matrix</span>
<span class="c1"># Sd = pd.DataFrame(stoich_dict, dtype=np.int8).fillna(0).astype(np.int8)</span>
<span class="c1"># Sd = Sd.iloc[0:7, 0:2]</span>

<span class="n">Sd</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1.5.1.20-RXN-5-METHYL-THF/NAD//METHYLENE-THF/NADH/PROTON.44. (reverse)</th>
      <th>1.5.1.20-RXN-CPD-1302/NAD//CPD-12996/NADH/PROTON.36. (reverse)</th>
      <th>1PFRUCTPHOSN-RXN</th>
      <th>1TRANSKETO-RXN-D-SEDOHEPTULOSE-7-P/GAP//CPD-16551/XYLULOSE-5-PHOSPHATE.56. (reverse)</th>
      <th>2-DEHYDROPANTOATE-REDUCT-RXN (reverse)</th>
      <th>2-ISOPROPYLMALATESYN-RXN</th>
      <th>2-OCTAPRENYL-6-METHOXYPHENOL-HYDROX-RXN</th>
      <th>2-OCTAPRENYL-6-OHPHENOL-METHY-RXN</th>
      <th>2-OCTAPRENYL-METHOXY-BENZOQ-METH-RXN</th>
      <th>2-OCTAPRENYLPHENOL-HYDROX-RXN</th>
      <th>...</th>
      <th>ISOCHORSYN-RXN__MENF-CPLX</th>
      <th>RXN-7609[CCO-CYTOSOL]-GMP/WATER//GUANOSINE/Pi.37.__G7742-MONOMER</th>
      <th>RXN-9535__FABB-CPLX</th>
      <th>RXN0-313__CPLX0-201 (reverse)</th>
      <th>RXN0-384__H2NEOPTERINP3PYROPHOSPHOHYDRO-MONOMER</th>
      <th>RXN0-5186__G7408-MONOMER</th>
      <th>SERINE-O-ACETTRAN-RXN__CPLX0-237</th>
      <th>SERINE-O-ACETTRAN-RXN__CYSSYNMULTI-CPLX</th>
      <th>UNDECAPRENYL-DIPHOSPHATASE-RXN[CCO-CYTOSOL]-UNDECAPRENYL-DIPHOSPHATE/WATER//CPD-9646/Pi/PROTON.64.__PGPPHOSPHAB-MONOMER</th>
      <th>maintenance_reaction</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>NAD[c]</th>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>NADH[c]</th>
      <td>-1</td>
      <td>-1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>PROTON[c]</th>
      <td>-1</td>
      <td>-1</td>
      <td>1</td>
      <td>0</td>
      <td>-1</td>
      <td>1</td>
      <td>-1</td>
      <td>1</td>
      <td>1</td>
      <td>-1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>-1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>GLUCONATE[c]</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>NADP[c]</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>R-3-hydroxymyristoyl-ACPs[c]</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Adenylated-ThiS-Proteins[c]</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>ThiS-CoASH-proteins[c]</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Thi-S[c]</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>FRU[p]</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>491 rows × 471 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># K_eq = np.log(keq)</span>
<span class="c1"># K_eq_mod = K_eq[:, np.newaxis].T</span>
<span class="c1"># vE = np.array([[90, 70, -30, 50], [100, 100, 30, 50], [110, 60, 75, 50]])</span>

<span class="c1"># n_flux_set = vE.shape[0]</span>
<span class="n">n_flux_set</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">Sr</span> <span class="o">=</span> <span class="kc">None</span>

<span class="c1"># K_eq[vE &lt; 0] = 1/K_eq[vE &lt; 0]</span>

<span class="n">lvE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">vE</span><span class="p">))</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">vE</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">vE</span><span class="p">)]),</span> <span class="n">columns</span><span class="o">=</span><span class="n">Sd</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
             <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;$v_1$&quot;</span><span class="p">,</span> <span class="s2">&quot;sign 1&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1.5.1.20-RXN-5-METHYL-THF/NAD//METHYLENE-THF/NADH/PROTON.44. (reverse)</th>
      <th>1.5.1.20-RXN-CPD-1302/NAD//CPD-12996/NADH/PROTON.36. (reverse)</th>
      <th>1PFRUCTPHOSN-RXN</th>
      <th>1TRANSKETO-RXN-D-SEDOHEPTULOSE-7-P/GAP//CPD-16551/XYLULOSE-5-PHOSPHATE.56. (reverse)</th>
      <th>2-DEHYDROPANTOATE-REDUCT-RXN (reverse)</th>
      <th>2-ISOPROPYLMALATESYN-RXN</th>
      <th>2-OCTAPRENYL-6-METHOXYPHENOL-HYDROX-RXN</th>
      <th>2-OCTAPRENYL-6-OHPHENOL-METHY-RXN</th>
      <th>2-OCTAPRENYL-METHOXY-BENZOQ-METH-RXN</th>
      <th>2-OCTAPRENYLPHENOL-HYDROX-RXN</th>
      <th>...</th>
      <th>ISOCHORSYN-RXN__MENF-CPLX</th>
      <th>RXN-7609[CCO-CYTOSOL]-GMP/WATER//GUANOSINE/Pi.37.__G7742-MONOMER</th>
      <th>RXN-9535__FABB-CPLX</th>
      <th>RXN0-313__CPLX0-201 (reverse)</th>
      <th>RXN0-384__H2NEOPTERINP3PYROPHOSPHOHYDRO-MONOMER</th>
      <th>RXN0-5186__G7408-MONOMER</th>
      <th>SERINE-O-ACETTRAN-RXN__CPLX0-237</th>
      <th>SERINE-O-ACETTRAN-RXN__CYSSYNMULTI-CPLX</th>
      <th>UNDECAPRENYL-DIPHOSPHATASE-RXN[CCO-CYTOSOL]-UNDECAPRENYL-DIPHOSPHATE/WATER//CPD-9646/Pi/PROTON.64.__PGPPHOSPHAB-MONOMER</th>
      <th>maintenance_reaction</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>$v_1$</th>
      <td>3851.0</td>
      <td>16095.0</td>
      <td>1.238118e+06</td>
      <td>7974.0</td>
      <td>1131.0</td>
      <td>56297.0</td>
      <td>300.0</td>
      <td>300.0</td>
      <td>300.0</td>
      <td>300.0</td>
      <td>...</td>
      <td>25.0</td>
      <td>3.0</td>
      <td>119.0</td>
      <td>31.0</td>
      <td>4.0</td>
      <td>2979.0</td>
      <td>17162.0</td>
      <td>16186.0</td>
      <td>143.0</td>
      <td>3.058992e+06</td>
    </tr>
    <tr>
      <th>sign 1</th>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000e+00</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000e+00</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 471 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set up variables</span>

<span class="n">n_met</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Sd</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">n_rxn</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Sd</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

<span class="n">S_mol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Sd</span><span class="p">)</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">S_mol</span><span class="p">)</span> <span class="c1">#</span>
<span class="n">S_s</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">S</span><span class="p">)</span> <span class="c1"># reverse neg sign</span>
<span class="n">S_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="n">S_s</span><span class="p">[</span><span class="n">S</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># zeros products</span>
<span class="n">S_p</span><span class="p">[</span><span class="n">S</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># zeros substrates</span>
<span class="n">S_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Sr</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># reaction direction does not matter</span>
<span class="n">S_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Sr</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>


<span class="n">S_s_nz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">S_s</span><span class="o">.</span><span class="n">nonzero</span><span class="p">())</span>
<span class="n">S_p_nz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">S_p</span><span class="o">.</span><span class="n">nonzero</span><span class="p">())</span>
<span class="n">S_i_nz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">S_i</span><span class="o">.</span><span class="n">nonzero</span><span class="p">())</span>
<span class="n">S_a_nz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">S_a</span><span class="o">.</span><span class="n">nonzero</span><span class="p">())</span>
<span class="n">S_s_mol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">S_mol</span><span class="p">)[</span><span class="n">S_s</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()]</span>
<span class="n">S_p_mol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">S_mol</span><span class="p">)[</span><span class="n">S_p</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()]</span>

<span class="c1"># TODO Refactor all the below lines as one liners</span>
<span class="c1"># first coordinate, e.g. metabolites w nonzero substrate/product coeff across all reactions. also works as substrate indices.</span>
<span class="n">met_s_nz</span> <span class="o">=</span> <span class="n">S_s_nz</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
<span class="n">met_p_nz</span> <span class="o">=</span> <span class="n">S_p_nz</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
<span class="n">met_i_nz</span> <span class="o">=</span> <span class="n">S_i_nz</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="k">if</span> <span class="n">Sr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
<span class="n">met_a_nz</span> <span class="o">=</span> <span class="n">S_a_nz</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="k">if</span> <span class="n">Sr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>

<span class="c1"># second coordinate, e.g. reactions indices for those concentrations. works to index substrates as well.</span>
<span class="n">rxn_s_nz</span> <span class="o">=</span> <span class="n">S_s_nz</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
<span class="n">rxn_p_nz</span> <span class="o">=</span> <span class="n">S_p_nz</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
<span class="n">rxn_i_nz</span> <span class="o">=</span> <span class="n">S_i_nz</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="k">if</span> <span class="n">Sr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
<span class="n">rxn_a_nz</span> <span class="o">=</span> <span class="n">S_a_nz</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="k">if</span> <span class="n">Sr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>

<span class="c1"># one dim is always 2</span>
<span class="n">n_Km_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">met_s_nz</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">n_Km_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">met_p_nz</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">n_Km_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">met_i_nz</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="k">if</span> <span class="n">Sr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
<span class="n">n_Km_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">met_a_nz</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="k">if</span> <span class="n">Sr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">([</span><span class="n">n_met</span><span class="p">,</span> <span class="n">n_flux_set</span><span class="p">])</span>
<span class="n">Km_s</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">n_Km_s</span><span class="p">)</span>
<span class="n">Km_p</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">n_Km_p</span><span class="p">)</span>
<span class="n">Km_i</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">n_Km_i</span><span class="p">)</span> <span class="k">if</span> <span class="n">n_Km_i</span> <span class="k">else</span> <span class="kc">None</span>
<span class="n">Km_a</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">n_Km_a</span><span class="p">)</span> <span class="k">if</span> <span class="n">n_Km_a</span> <span class="k">else</span> <span class="kc">None</span>

<span class="n">cfwd</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">n_rxn</span><span class="p">)</span>
<span class="n">crev</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">n_rxn</span><span class="p">)</span>

<span class="c1"># define y vecs</span>
<span class="n">y_s_t</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">y_p_t</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">y_i_t</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">y_a_t</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># define Km positions by nonzero S matrix concentrations. Activation is reverse val of inhibition.</span>
<span class="c1"># TODO Add molecularity here.</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_flux_set</span><span class="p">):</span>
    <span class="n">y_s_t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">S_s_mol</span><span class="p">,</span> <span class="n">c</span><span class="p">[</span><span class="n">met_s_nz</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">Km_s</span><span class="p">))</span>
    <span class="n">y_p_t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">S_p_mol</span><span class="p">,</span> <span class="n">c</span><span class="p">[</span><span class="n">met_p_nz</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">Km_p</span><span class="p">))</span>
    <span class="n">y_i_t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="n">met_i_nz</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">Km_i</span> <span class="k">if</span> <span class="n">n_Km_i</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">y_a_t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="n">met_a_nz</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">Km_a</span><span class="p">)</span> <span class="k">if</span> <span class="n">n_Km_a</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>

<span class="n">y_s</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">y_s_t</span><span class="p">)</span>
<span class="n">y_p</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">y_p_t</span><span class="p">)</span>
<span class="n">y_i</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">y_i_t</span><span class="p">)</span>
<span class="n">y_a</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">y_a_t</span><span class="p">)</span>

<span class="c1"># saturation stacks</span>
<span class="n">y_f_vec</span> <span class="o">=</span> <span class="p">[</span><span class="n">y_s</span><span class="p">]</span>
<span class="n">y_r_vec</span> <span class="o">=</span> <span class="p">[</span><span class="n">y_p</span><span class="p">]</span>
<span class="k">if</span> <span class="n">n_Km_i</span><span class="p">:</span>
    <span class="n">y_f_vec</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_i</span><span class="p">)</span>
    <span class="n">y_r_vec</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_i</span><span class="p">)</span>
<span class="k">if</span> <span class="n">n_Km_a</span><span class="p">:</span>
    <span class="n">y_f_vec</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_a</span><span class="p">)</span>
    <span class="n">y_r_vec</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_a</span><span class="p">)</span>

<span class="n">y_f</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="n">y_f_vec</span><span class="p">)</span>
<span class="n">y_r</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="n">y_r_vec</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of metabolites: </span><span class="si">{</span><span class="n">n_met</span><span class="si">}</span><span class="s2">, number of reactions: </span><span class="si">{</span><span class="n">n_rxn</span><span class="si">}</span><span class="s2">, number of flux sets: </span><span class="si">{</span><span class="n">n_flux_set</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="sa">f</span><span class="s2">&quot;Number of Km_s: </span><span class="si">{</span><span class="n">n_Km_s</span><span class="si">}</span><span class="s2">, number of Km_p: </span><span class="si">{</span><span class="n">n_Km_p</span><span class="si">}</span><span class="s2">, number of Km_i: </span><span class="si">{</span><span class="n">n_Km_i</span><span class="si">}</span><span class="s2">, number of Km_a: </span><span class="si">{</span><span class="n">n_Km_a</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="sa">f</span><span class="s2">&quot;Number of concentrations: </span><span class="si">{</span><span class="n">c</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">, number of y_f: </span><span class="si">{</span><span class="n">y_f</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">, number of y_r: </span><span class="si">{</span><span class="n">y_r</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Number of metabolites: 491, number of reactions: 471, number of flux sets: 1
Number of Km_s: 998, number of Km_p: 1117, number of Km_i: None, number of Km_a: None
Number of concentrations: (491, 1), number of y_f: (1, 998), number of y_r: (1, 1117)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/var/folders/dx/0239zgvj0tgf46b5h8l7v_fc0000gn/T/ipykernel_10498/2838292308.py:18: DeprecationWarning: Calling nonzero on 0d arrays is deprecated, as it behaves surprisingly. Use `atleast_1d(cond).nonzero()` if the old behavior was intended. If the context of this warning is of the form `arr[nonzero(cond)]`, just use `arr[cond]`.
  S_i_nz = np.array(S_i.nonzero())
/var/folders/dx/0239zgvj0tgf46b5h8l7v_fc0000gn/T/ipykernel_10498/2838292308.py:19: DeprecationWarning: Calling nonzero on 0d arrays is deprecated, as it behaves surprisingly. Use `atleast_1d(cond).nonzero()` if the old behavior was intended. If the context of this warning is of the form `arr[nonzero(cond)]`, just use `arr[cond]`.
  S_a_nz = np.array(S_a.nonzero())
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># number of saturation terms for sub, prod</span>
<span class="n">S_s_comb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">S_s</span><span class="p">,</span> <span class="n">S_i</span><span class="p">,</span> <span class="n">S_a</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="n">Sr</span> <span class="k">else</span> <span class="n">S_s</span>
<span class="n">S_p_comb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">S_p</span><span class="p">,</span> <span class="n">S_i</span><span class="p">,</span> <span class="n">S_a</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="n">Sr</span> <span class="k">else</span> <span class="n">S_p</span>
<span class="n">n_alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">S_s_comb</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">n_beta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">S_p_comb</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># saturation matrix setup, first sub, then inhib, then act.</span>
<span class="n">C_alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">n_alpha</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">met_s_nz</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">met_i_nz</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">met_a_nz</span><span class="p">)])</span> <span class="k">if</span> <span class="n">Sr</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">n_alpha</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">met_s_nz</span><span class="p">)])</span>
<span class="n">C_beta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">n_beta</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">met_p_nz</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">met_i_nz</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">met_a_nz</span><span class="p">)])</span> <span class="k">if</span> <span class="n">Sr</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">n_beta</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">met_p_nz</span><span class="p">)])</span>

<span class="c1"># to separate different reactions saturation terms to their individual reaction equations.</span>
<span class="n">d_alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_alpha</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
<span class="n">d_beta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_beta</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>


<span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_rxn</span><span class="p">):</span>

    <span class="c1"># pick one reaction at a time (get substrate indicies)</span>
    <span class="c1">#idx_cur_rxn = rxn_s_nz == i</span>
    <span class="c1"># TODO This does not properly multiply by molecularity. Alternatively, generate C_alpha and</span>
    <span class="c1"># TODO beta without molecularity (first ==1) and then multiply by molecularity in the end.</span>
    <span class="n">idx_cur_rxn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">rxn_s_nz</span> <span class="o">==</span> <span class="n">i</span><span class="p">,</span> <span class="n">rxn_i_nz</span> <span class="o">==</span> <span class="n">i</span><span class="p">,</span> <span class="n">rxn_a_nz</span> <span class="o">==</span> <span class="n">i</span><span class="p">))</span> <span class="k">if</span> <span class="n">Sr</span> <span class="k">else</span> <span class="n">rxn_s_nz</span> <span class="o">==</span> <span class="n">i</span>

    <span class="c1"># generates all binary permutations minus the first one since that would result in -1</span>
    <span class="n">sat_perm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">repeat</span><span class="o">=</span><span class="nb">sum</span><span class="p">(</span><span class="n">idx_cur_rxn</span><span class="p">))))</span>
    <span class="n">sat_perm</span> <span class="o">=</span> <span class="n">sat_perm</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:]</span>

    <span class="n">r</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">sat_perm</span><span class="o">.</span><span class="n">shape</span>

    <span class="c1"># replace zeros with saturation matrix</span>
    <span class="n">C_alpha</span><span class="p">[</span><span class="n">idx</span><span class="p">:(</span><span class="n">idx</span><span class="o">+</span><span class="n">r</span><span class="p">),</span> <span class="n">idx_cur_rxn</span><span class="p">]</span> <span class="o">=</span> <span class="n">sat_perm</span>
    <span class="n">d_alpha</span><span class="p">[</span><span class="n">idx</span><span class="p">:(</span><span class="n">idx</span><span class="o">+</span><span class="n">r</span><span class="p">)]</span> <span class="o">=</span> <span class="n">i</span>

    <span class="n">idx</span> <span class="o">+=</span> <span class="n">r</span> <span class="c1"># add row #</span>

<span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_rxn</span><span class="p">):</span>
    <span class="n">idx_cur_rxn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">rxn_p_nz</span> <span class="o">==</span> <span class="n">i</span><span class="p">,</span> <span class="n">rxn_i_nz</span> <span class="o">==</span> <span class="n">i</span><span class="p">,</span> <span class="n">rxn_a_nz</span> <span class="o">==</span> <span class="n">i</span><span class="p">))</span> <span class="k">if</span> <span class="n">Sr</span> <span class="k">else</span> <span class="n">rxn_p_nz</span> <span class="o">==</span> <span class="n">i</span>

    <span class="n">sat_perm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">repeat</span><span class="o">=</span><span class="nb">sum</span><span class="p">(</span><span class="n">idx_cur_rxn</span><span class="p">))))</span>
    <span class="n">sat_perm</span> <span class="o">=</span> <span class="n">sat_perm</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:]</span>

    <span class="n">r</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">sat_perm</span><span class="o">.</span><span class="n">shape</span>

    <span class="n">C_beta</span><span class="p">[</span><span class="n">idx</span><span class="p">:(</span><span class="n">idx</span><span class="o">+</span><span class="n">r</span><span class="p">),</span> <span class="n">idx_cur_rxn</span><span class="p">]</span> <span class="o">=</span> <span class="n">sat_perm</span>
    <span class="n">d_beta</span><span class="p">[</span><span class="n">idx</span><span class="p">:(</span><span class="n">idx</span><span class="o">+</span><span class="n">r</span><span class="p">)]</span> <span class="o">=</span> <span class="n">i</span>

    <span class="n">idx</span> <span class="o">+=</span> <span class="n">r</span> <span class="c1"># add row #</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_lse_terms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">S_s</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span> <span class="o">+</span>  <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">S_p</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">LSE_expr</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">denom_expr</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">sign</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">vE</span><span class="p">)</span>
<span class="n">lvE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sign</span> <span class="o">*</span> <span class="n">vE</span><span class="p">)</span>

<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_flux_set</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_rxn</span><span class="p">):</span>
        <span class="c1"># sum terms are separate in logsumexp. one per saturation term (row in C_alpha, C_beta)</span>

        <span class="n">n_term_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">d_alpha</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">n_term_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">d_beta</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">n_term</span> <span class="o">=</span> <span class="n">n_term_s</span> <span class="o">+</span> <span class="n">n_term_p</span>

        <span class="n">Km_s_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">S_s_nz</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">S_s_idx</span> <span class="o">=</span> <span class="n">S_s_nz</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">S_s_nz</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span> <span class="c1"># negate -1 entries</span>

        <span class="n">Km_p_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">S_p_nz</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">S_p_idx</span> <span class="o">=</span> <span class="n">S_p_nz</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">S_p_nz</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">sign</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">LSE_expr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span> <span class="p">[</span>
                                         <span class="n">lvE</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">C_alpha</span> <span class="o">@</span> <span class="n">cp</span><span class="o">.</span><span class="n">vec</span><span class="p">(</span><span class="n">y_f</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:]))[</span><span class="n">d_alpha</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span>
                                            <span class="o">-</span> <span class="n">cp</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_term_s</span><span class="p">),</span> <span class="o">-</span> <span class="n">S</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">S_s_idx</span><span class="p">]</span> <span class="o">@</span> <span class="n">cp</span><span class="o">.</span><span class="n">vec</span><span class="p">(</span><span class="n">y_s</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">Km_s_idx</span><span class="p">]))</span> <span class="o">-</span> <span class="n">cfwd</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                         <span class="n">lvE</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">C_beta</span> <span class="o">@</span> <span class="n">cp</span><span class="o">.</span><span class="n">vec</span><span class="p">(</span><span class="n">y_r</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:]))[</span><span class="n">d_beta</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span>
                                            <span class="o">-</span> <span class="n">cp</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_term_p</span><span class="p">),</span> <span class="o">-</span> <span class="n">S</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">S_s_idx</span><span class="p">]</span> <span class="o">@</span> <span class="n">cp</span><span class="o">.</span><span class="n">vec</span><span class="p">(</span><span class="n">y_s</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">Km_s_idx</span><span class="p">]))</span> <span class="o">-</span> <span class="n">cfwd</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>

                                         <span class="n">lvE</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mi">0</span> <span class="o">-</span> <span class="n">cp</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">S</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">S_s_idx</span><span class="p">]</span> <span class="o">@</span> <span class="n">cp</span><span class="o">.</span><span class="n">vec</span><span class="p">(</span><span class="n">y_s</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">Km_s_idx</span><span class="p">]))</span>  <span class="o">-</span> <span class="n">cfwd</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>

                                         <span class="n">cp</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">S</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">S_p_idx</span><span class="p">]</span> <span class="o">@</span> <span class="n">cp</span><span class="o">.</span><span class="n">vec</span><span class="p">(</span><span class="n">y_p</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">Km_p_idx</span><span class="p">]))</span>  <span class="o">+</span> <span class="n">crev</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                            <span class="o">-</span> <span class="n">cp</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">S</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">S_s_idx</span><span class="p">]</span> <span class="o">@</span> <span class="n">cp</span><span class="o">.</span><span class="n">vec</span><span class="p">(</span><span class="n">y_s</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">Km_s_idx</span><span class="p">]))</span>  <span class="o">-</span> <span class="n">cfwd</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>

                                       <span class="p">]</span>
                                     <span class="p">)</span>
                           <span class="p">)</span>  <span class="c1"># remove +1 here, could also have cfwd outside objec.</span>

            <span class="n">denom_expr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">S</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">S_s_idx</span><span class="p">]</span> <span class="o">@</span> <span class="n">cp</span><span class="o">.</span><span class="n">vec</span><span class="p">(</span><span class="n">y_s</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">Km_s_idx</span><span class="p">]))</span> <span class="o">+</span> <span class="n">cfwd</span><span class="p">[</span><span class="n">i</span><span class="p">],)</span>


        <span class="c1"># keep saturation term the same, switch around fwd and rev terms. flip all signs with S matrix since it&#39;s signed.</span>
        <span class="k">if</span> <span class="n">sign</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">LSE_expr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span> <span class="p">[</span> <span class="n">lvE</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">C_alpha</span> <span class="o">@</span> <span class="n">cp</span><span class="o">.</span><span class="n">vec</span><span class="p">(</span><span class="n">y_f</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:]))[</span><span class="n">d_alpha</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span>
                                            <span class="o">-</span> <span class="n">cp</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_term_s</span><span class="p">),</span> <span class="n">S</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">S_p_idx</span><span class="p">]</span> <span class="o">@</span> <span class="n">cp</span><span class="o">.</span><span class="n">vec</span><span class="p">(</span><span class="n">y_p</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">Km_p_idx</span><span class="p">]))</span> <span class="o">-</span> <span class="n">crev</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>

                                         <span class="n">lvE</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">C_beta</span> <span class="o">@</span> <span class="n">cp</span><span class="o">.</span><span class="n">vec</span><span class="p">(</span><span class="n">y_r</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:]))[</span><span class="n">d_beta</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span>
                                            <span class="o">-</span> <span class="n">cp</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_term_p</span><span class="p">),</span> <span class="n">S</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">S_p_idx</span><span class="p">]</span> <span class="o">@</span> <span class="n">cp</span><span class="o">.</span><span class="n">vec</span><span class="p">(</span><span class="n">y_p</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">Km_p_idx</span><span class="p">]))</span> <span class="o">-</span> <span class="n">crev</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>

                                         <span class="n">lvE</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mi">0</span> <span class="o">-</span> <span class="n">cp</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">S</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">S_p_idx</span><span class="p">]</span> <span class="o">@</span> <span class="n">cp</span><span class="o">.</span><span class="n">vec</span><span class="p">(</span><span class="n">y_p</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">Km_p_idx</span><span class="p">]))</span> <span class="o">-</span> <span class="n">crev</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>

                                         <span class="n">cp</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span> <span class="n">S</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">S_s_idx</span><span class="p">]</span> <span class="o">@</span> <span class="n">cp</span><span class="o">.</span><span class="n">vec</span><span class="p">(</span><span class="n">y_s</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">Km_s_idx</span><span class="p">]))</span>  <span class="o">+</span> <span class="n">cfwd</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                            <span class="o">-</span> <span class="n">cp</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">S</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">S_p_idx</span><span class="p">]</span> <span class="o">@</span> <span class="n">cp</span><span class="o">.</span><span class="n">vec</span><span class="p">(</span><span class="n">y_p</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">Km_p_idx</span><span class="p">]))</span> <span class="o">-</span> <span class="n">crev</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>

                                       <span class="p">]</span>
                                     <span class="p">)</span>
                           <span class="p">)</span>

            <span class="n">denom_expr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">S</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">S_p_idx</span><span class="p">]</span> <span class="o">@</span> <span class="n">cp</span><span class="o">.</span><span class="n">vec</span><span class="p">(</span><span class="n">y_p</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">Km_p_idx</span><span class="p">]))</span> <span class="o">+</span> <span class="n">crev</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>


<span class="c1">#LSE_expr = cp.vstack(LSE_expr)</span>
<span class="n">LSE_expr</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[Expression(AFFINE, UNKNOWN, (12,)),
 Expression(AFFINE, UNKNOWN, (12,)),
 Expression(AFFINE, UNKNOWN, (12,)),
 Expression(AFFINE, UNKNOWN, (8,)),
 Expression(AFFINE, UNKNOWN, (12,)),
 Expression(AFFINE, UNKNOWN, (16,)),
 Expression(AFFINE, UNKNOWN, (24,)),
 Expression(AFFINE, UNKNOWN, (12,)),
 Expression(AFFINE, UNKNOWN, (12,)),
 Expression(AFFINE, UNKNOWN, (24,))]
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l</span> <span class="o">=</span> <span class="mf">0.001</span>
<span class="n">e</span> <span class="o">=</span> <span class="mf">0.001</span>
<span class="n">f</span> <span class="o">=</span> <span class="mf">0.000001</span>
<span class="n">reg</span> <span class="o">=</span>  <span class="n">cp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">cfwd</span><span class="p">,</span> <span class="n">crev</span><span class="p">,</span> <span class="n">cp</span><span class="o">.</span><span class="n">vec</span><span class="p">(</span><span class="n">c</span><span class="p">)]))</span> <span class="o">+</span> <span class="n">cp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="o">-</span><span class="n">Km_s</span><span class="p">,</span> <span class="o">-</span><span class="n">Km_p</span><span class="p">]))</span> <span class="c1"># regularization</span>
<span class="n">reg2</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">norm1</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">cfwd</span><span class="p">,</span> <span class="n">crev</span><span class="p">,</span> <span class="n">cp</span><span class="o">.</span><span class="n">vec</span><span class="p">(</span><span class="n">c</span><span class="p">)]))</span> <span class="o">+</span> <span class="n">cp</span><span class="o">.</span><span class="n">norm1</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="o">-</span><span class="n">Km_s</span><span class="p">,</span> <span class="o">-</span><span class="n">Km_p</span><span class="p">]))</span> <span class="c1"># regularization</span>
<span class="n">reg3</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">huber</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">y_s</span><span class="p">,</span> <span class="n">y_p</span><span class="p">]),</span> <span class="mi">1</span><span class="p">))</span> <span class="c1"># issue with matrix</span>

<span class="k">if</span> <span class="n">n_Km_i</span><span class="p">:</span>
    <span class="n">reg</span> <span class="o">+=</span> <span class="n">cp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="o">-</span><span class="n">Km_i</span><span class="p">]))</span>
<span class="k">if</span> <span class="n">n_Km_a</span><span class="p">:</span>
    <span class="n">reg</span> <span class="o">+=</span> <span class="n">cp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="o">-</span><span class="n">Km_a</span><span class="p">]))</span>
<span class="c1">#reg3 = cp.norm1(cp.hstack([y_s, y_p])) # take a look at this</span>

<span class="n">loss</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">LSE_expr</span><span class="p">)):</span>
    <span class="n">loss</span> <span class="o">+=</span> <span class="n">cp</span><span class="o">.</span><span class="n">norm1</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">pos</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">log_sum_exp</span><span class="p">(</span><span class="n">LSE_expr</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">denom_expr</span><span class="p">)):</span>
    <span class="n">loss</span> <span class="o">+=</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">denom_expr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="n">loss</span> <span class="o">+=</span> <span class="n">l</span> <span class="o">*</span> <span class="n">reg</span>
<span class="n">loss</span> <span class="o">+=</span> <span class="n">e</span> <span class="o">*</span> <span class="n">reg2</span>
<span class="n">loss</span> <span class="o">+=</span> <span class="n">f</span> <span class="o">*</span> <span class="n">reg3</span>
<span class="c1">#</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">constr</span> <span class="o">=</span> <span class="p">[</span><span class="n">cp</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">cfwd</span><span class="p">,</span> <span class="n">crev</span><span class="p">,</span> <span class="n">cp</span><span class="o">.</span><span class="n">vec</span><span class="p">(</span><span class="n">c</span><span class="p">),</span> <span class="n">Km_s</span><span class="p">,</span> <span class="n">Km_p</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">12</span><span class="p">,</span>
          <span class="n">cp</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">cfwd</span><span class="p">,</span> <span class="n">crev</span><span class="p">,</span> <span class="n">cp</span><span class="o">.</span><span class="n">vec</span><span class="p">(</span><span class="n">c</span><span class="p">),</span> <span class="n">Km_s</span><span class="p">,</span> <span class="n">Km_p</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mi">18</span><span class="p">,</span>
          <span class="p">]</span>

<span class="k">if</span> <span class="n">n_Km_i</span><span class="p">:</span>
    <span class="n">constr</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">Km_i</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">12</span><span class="p">,</span> <span class="n">Km_i</span> <span class="o">&lt;=</span> <span class="mi">18</span><span class="p">])</span>
<span class="k">if</span> <span class="n">n_Km_a</span><span class="p">:</span>
    <span class="n">constr</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">Km_a</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">12</span><span class="p">,</span> <span class="n">Km_a</span> <span class="o">&lt;=</span> <span class="mi">18</span><span class="p">])</span>
<br/><br/></pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># haldane = []</span>
<span class="c1"># fwd_flux = []</span>
<span class="c1">#</span>
<span class="c1"># for i, r in enumerate(S.T):</span>
<span class="c1">#     Km_s_idx = np.nonzero(S_s_nz[1, :] == i)</span>
<span class="c1">#     S_s_idx = S_s_nz[0, S_s_nz[1, :] == i] # negate -1 entries</span>
<span class="c1">#</span>
<span class="c1">#     Km_p_idx = np.nonzero(S_p_nz[1, :] == i)</span>
<span class="c1">#     S_p_idx = S_p_nz[0, S_p_nz[1, :] == i]</span>
<span class="c1">#</span>
<span class="c1">#     haldane.append(K_eq[i] == cfwd[i] - crev[i] + r[S_p_idx] @ Km_p[Km_p_idx] - (-r[S_s_idx]) @ Km_s[Km_s_idx])</span>
<span class="c1">#</span>
<span class="c1"># for j in range(n_flux_set):</span>
<span class="c1">#     for i, r in enumerate(S.T):</span>
<span class="c1">#         Km_s_idx = np.nonzero(S_s_nz[1, :] == i)</span>
<span class="c1">#         S_s_idx = S_s_nz[0, S_s_nz[1, :] == i] # negate -1 entries</span>
<span class="c1">#</span>
<span class="c1">#         Km_p_idx = np.nonzero(S_p_nz[1, :] == i)</span>
<span class="c1">#         S_p_idx = S_p_nz[0, S_p_nz[1, :] == i]</span>
<span class="c1">#</span>
<span class="c1">#         if sign[j, i] == 1:</span>
<span class="c1">#             fwd_flux.append(cfwd[i] + (-r[S_s_idx]) @ cp.vec(y_s[j, Km_s_idx]) - (crev[i] + r[S_p_idx] @ cp.vec(y_p[j, Km_p_idx]))  &gt;= 0)  # add minus since s matrix has minus</span>
<span class="c1">#             # equilibrium.append(r @ c &lt;= K_eq[i])</span>
<span class="c1">#</span>
<span class="c1">#         if sign[j, i] == -1:</span>
<span class="c1">#             fwd_flux.append(cfwd[i] + (-r[S_s_idx]) @ cp.vec(y_s[j, Km_s_idx]) - (crev[i] + r[S_p_idx] @ cp.vec(y_p[j, Km_p_idx]))  &lt;= 0)  # add minus since s matrix has minus</span>
<span class="c1">#             # equilibrium.append(r @ c &gt;= K_eq[i])</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#     constr.extend([cp.multiply(S.T @ cp.vec(c[:, j]), sign[j, :])  &lt;= cp.multiply(K_eq, sign[j, :])])</span>
<span class="c1">#</span>
<span class="c1"># constr.extend(haldane)</span>
<span class="c1"># constr.extend(fwd_flux)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">Minimize</span><span class="p">(</span><span class="n">loss</span><span class="p">),</span> <span class="n">constr</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="n">cp</span><span class="o">.</span><span class="n">ECOS</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/cyrus/.pyenv/versions/3.9.9/envs/viv/lib/python3.9/site-packages/cvxpy/problems/problem.py:155: UserWarning: Objective contains too many subexpressions. Consider vectorizing your CVXPY code to speed up compilation.
  warnings.warn(&#34;Objective contains too many subexpressions. &#34;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
52.08053021504205
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># print(&#39;Substrate Km:&#39;, [f&#39;{val:.3f}&#39; for val in np.exp(Km_s.value)])</span>
<span class="c1"># print(&#39;Product Km:&#39;, [f&#39;{val:.3f}&#39; for val in np.exp(Km_p.value)])</span>
<span class="c1"># print(&#39;Fwd kcat:&#39;, [f&#39;{val:.3f}&#39; for val in np.exp(cfwd.value)])</span>
<span class="c1"># print(&#39;Rev kcat:&#39;, [f&#39;{val:.3f}&#39; for val in np.exp(crev.value)])</span>
<span class="c1">#</span>
<span class="c1"># concs = np.exp(c.value).T</span>
<span class="c1"># for row in concs:</span>
<span class="c1">#     print(&#39;Concentration:&#39;, [f&#39;{val:.4f}&#39; for val in row])</span>
<span class="c1">#</span>
<span class="c1"># if n_Km_i:</span>
<span class="c1">#     print(&#39;Inhibition Km:&#39;, [f&#39;{val:.3f}&#39; for val in np.exp(Km_i.value)])</span>
<span class="c1"># if n_Km_a:</span>
<span class="c1">#     print(&#39;Activation Km:&#39;, [f&#39;{val:.3f}&#39; for val in np.exp(Km_a.value)])</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">LSE_expr</span><span class="p">:</span>
    <span class="c1">#print(v.value)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">logsumexp</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
-6.278086065458766e-07
-6.274765030900298e-07
-5.727522455201139e-07
-4.227623290886662e-07
-6.28103507094302e-07
-7.777828692212552e-07
-1.188284308839549e-06
-5.734419813996361e-07
-5.734406918200818e-07
-1.1882844157540262e-06
-5.730378362378552e-07
-4.2239225916951284e-07
-6.290469742875615e-07
-5.72972879531175e-07
-6.272708403809446e-07
-1.9543037428348953e-06
-7.776879303866835e-07
-3.194665726680146e-07
-4.2238797559601693e-07
-6.280953567250336e-07
-3.2000106078844404e-07
-3.1998815550049464e-07
-4.236856294137503e-07
-4.263705176699162e-07
-4.230769426460945e-07
-4.2249933085436453e-07
-2.3335306004179657e-07
-4.237769823944859e-07
-2.3775633820055653e-07
-2.3681670366371144e-07
-4.2235785602251497e-07
-4.2230218810779263e-07
-4.231540752241969e-07
-6.270820404052913e-07
-4.2167442054763526e-07
-6.272501212878367e-07
-6.272128901807505e-07
-3.2228418062052455e-07
-4.2240876951815665e-07
-4.2238623987334023e-07
-4.2239364406171376e-07
-3.233696784232798e-07
-5.72992752578827e-07
-4.7122311086500446e-07
-4.2325662841236067e-07
-4.2304701830531144e-07
-3.359369015187852e-07
-1.045845456792982e-06
-5.730070920528796e-07
-5.731842213085869e-07
-3.1996626209673806e-07
-4.2230766389428354e-07
-8.449241648555983e-07
-4.2232266345143543e-07
-2.383921945126044e-07
-3.200218912091657e-07
-8.450629266354426e-07
-3.1969058969516517e-07
-1.0500328022633454e-06
-1.0491957297409371e-06
-4.2224168572690957e-07
-3.365384876330424e-07
-7.777338963954605e-07
-4.2241732256531606e-07
-5.729864090975312e-07
-4.232159507289168e-07
-4.2267124228390074e-07
-5.540418090976829e-07
-4.2208210326855067e-07
-4.220179004588154e-07
-4.2202703942617603e-07
-3.198216510513774e-07
-6.273665873468559e-07
-4.2232038122147486e-07
-3.200215378529325e-07
-3.213069701413218e-07
-7.51785650288106e-07
-4.2296603003366684e-07
-5.730604584752719e-07
-2.394570126074136e-07
-4.2546041945090707e-07
-4.272232890234484e-07
-4.2804622141234816e-07
-3.4175958885107605e-07
-5.733854785971992e-07
-1.0435736385039363e-06
-5.736297868930151e-07
-5.729608840709943e-07
-4.2200622440979885e-07
-2.3569970844516952e-07
-5.729918917674048e-07
-1.0505912817482255e-06
-4.242846746160822e-07
-4.224391781937342e-07
-4.2244178632966367e-07
-3.198843320229017e-07
-3.2004716546407685e-07
-5.712077592034959e-07
-4.7106391712348206e-07
-7.783458222387907e-07
-4.227043323701274e-07
-4.2303993552650354e-07
-5.732917395251391e-07
-6.272218436853549e-07
-6.272099891679872e-07
-1.0108600374536536e-06
-7.759445648236607e-07
-5.737713892339791e-07
-6.288351267480508e-07
-1.9683119849567277e-06
-4.22935344857045e-07
-5.728576246144534e-07
-6.266737706539516e-07
-5.728940810079131e-07
-4.223790217028345e-07
-5.733206875357943e-07
-5.729446954094719e-07
-6.273307591175836e-07
-6.27632473770845e-07
-4.2261432886547823e-07
-1.0501270365503856e-06
-1.0503070315692753e-06
-1.0502613658758264e-06
-9.649556862445507e-07
-4.2252725218627774e-07
-2.385911675450991e-07
-7.780862318895743e-07
-7.7779782214904e-07
-6.273204788964648e-07
-5.733622884807055e-07
-7.758523348222468e-07
-4.2423866547514066e-07
-5.730423129346462e-07
-5.728721836351092e-07
-1.0501265491624778e-06
-4.2472402028703726e-07
-1.045867597526673e-06
-4.229202854033609e-07
-2.4021799296947144e-07
-5.736289610536183e-07
-8.365271914057004e-07
-4.2251904341927826e-07
-3.2179305975432726e-07
-5.736598097105805e-07
-5.736078186324711e-07
-4.242949832033993e-07
-4.2264022714899596e-07
-3.394899303899024e-07
-4.2265622884896104e-07
-5.730917909119171e-07
-4.2253028709193785e-07
-4.2284320550534105e-07
-6.274406009199041e-07
-4.2255002496993654e-07
-5.730575876050636e-07
-3.2026128629625283e-07
-7.779253523576557e-07
-3.199888775617943e-07
-4.2766258667725765e-07
-4.206594774736061e-07
-5.742358137883485e-07
-4.2387339260763213e-07
-3.199040340129411e-07
-5.726991743060239e-07
-7.746531085484065e-07
-4.2294038804513434e-07
-6.277942448118523e-07
-5.732437244332367e-07
-5.732437703409587e-07
-5.732205713426808e-07
-5.707617300454437e-07
-8.413668063922408e-07
-7.776703999651247e-07
-4.2230717178792787e-07
-4.2228367680419154e-07
-2.3302288357229806e-07
-4.231376240504403e-07
-7.777447497137047e-07
-5.729418331434921e-07
-5.731434560840576e-07
-5.736288585800331e-07
-1.0503512477555432e-06
-6.238452687767904e-07
-6.275031285696286e-07
-4.2426347224289174e-07
-6.28097674870709e-07
-5.734116426125979e-07
-5.729671128662517e-07
-7.784015093603713e-07
-3.218155321116356e-07
-7.783035873565325e-07
-4.2087509288801783e-07
-5.729979356550174e-07
-4.2265083372017287e-07
-4.224537889507829e-07
-4.2238854458531705e-07
-4.232170868201379e-07
-1.0503068860190368e-06
-4.242915237484546e-07
-6.28173057903858e-07
-1.0502836861325804e-06
-5.733662504781023e-07
-8.414346627794167e-07
-4.2208045769598357e-07
-6.271323513828975e-07
-2.3491211276205348e-07
-5.728619885680963e-07
-4.227956098556973e-07
-4.113191064969435e-07
-4.228980637899227e-07
-5.730916213808612e-07
-4.221297741913155e-07
-5.729950913191395e-07
-2.3577474320135572e-07
-4.2429612823191576e-07
-4.68265986930394e-07
-2.3797147502557792e-07
-5.729300368018109e-07
-5.729389431219367e-07
-2.370769561776953e-07
-4.226231297699279e-07
-7.778152080195611e-07
-5.733040662203592e-07
-5.728903622048698e-07
-4.228256287874821e-07
-4.2213345363695254e-07
-4.246750364700347e-07
-2.290353387779387e-06
-4.2469295807867624e-07
-6.263219365365558e-07
-6.993765666596374e-07
-5.708027869255616e-07
-7.762594456117711e-07
-4.223108985290658e-07
-4.223249530643791e-07
-2.349754443242702e-07
-4.234587639428966e-07
-5.736407409639988e-07
-6.290473699710475e-07
-6.289861192998458e-07
-4.2414545614599675e-07
-3.2085597592712567e-07
-2.3581895358670835e-07
-4.221778435731238e-07
-6.288246198193903e-07
-2.4064924808442356e-06
-4.2585838527786635e-07
-7.785683245886688e-07
-4.2229132890536647e-07
-4.2239032926882913e-07
-4.258989931837931e-07
-7.766360303751441e-07
-5.72834440104586e-07
-2.3554515235502116e-07
-5.736334972583634e-07
-1.042484326196913e-06
-5.703585611582795e-07
-7.778305461947355e-07
-4.229349891415879e-07
-4.2805179989446884e-07
-2.3403349183603872e-07
-1.0460048053273496e-06
-2.4002570916947796e-07
-8.448659054027807e-07
-4.233198692138451e-07
-2.3862355613690767e-07
-8.449401269206014e-07
-6.278156002847979e-07
-5.727475835826112e-07
-4.218572498548845e-07
-6.68584216989565e-07
-7.781971528286746e-07
-4.222664721775793e-07
-7.71112867226087e-07
-4.184787507632848e-07
-4.0110617460786813e-07
-3.2180377210200284e-07
-5.736156741265042e-07
-5.732421207715888e-07
-5.728399087856495e-07
-2.395497896157117e-07
-7.7334558512554e-07
-2.399292400590003e-07
-4.231758032324784e-07
-4.212875784892489e-07
-4.222336900117085e-07
-3.199656205266077e-07
-2.402682327817818e-07
-4.2707679026587897e-07
-3.4216425293109864e-07
-2.3773693813566865e-07
-5.731534545305728e-07
-6.276401386395847e-07
-4.22773718200542e-07
-4.2855483711745634e-07
-5.733000435492741e-07
-4.221945626992074e-07
-5.733000523755472e-07
-5.732225126786616e-07
-5.733022275800082e-07
-5.73300229622653e-07
-5.73302110062901e-07
-5.732173660177864e-07
-5.732224355736726e-07
-5.732224704346756e-07
-5.733000356111795e-07
-4.2489155677172263e-07
-4.22185783166551e-07
-4.2712415332379905e-07
-4.21957033480691e-07
-6.279056627978008e-07
-5.733689117937146e-07
-4.2376619913131464e-07
-4.2342552053487026e-07
-4.246657054896019e-07
-1.0458802448543025e-06
-2.357772085626042e-07
-7.747353544251823e-07
-2.3902615006732297e-07
-7.781461244249499e-07
-1.0501299000376108e-06
-4.2310394654521133e-07
-6.272051081834817e-07
-5.729669585452513e-07
-4.226229963211203e-07
-5.727805568733757e-07
-4.7060424324119055e-07
-7.776962100969342e-07
-4.2233439906391723e-07
-4.220908072505303e-07
-4.223874451869669e-07
-6.273368826636982e-07
-7.678603400895767e-07
-6.272252174310822e-07
-5.733021475329281e-07
-4.243028139394589e-07
-3.200435678418767e-07
-3.3766705109794515e-07
-4.229827843538203e-07
-2.40081634461653e-07
-4.222437453571537e-07
-2.389811018799204e-07
-2.364221709794112e-07
-2.39522584599694e-07
-2.0513783294262566e-07
-4.220701636525881e-07
-4.2339611422415047e-07
-6.96552059809008e-07
-2.3861554751536396e-07
-2.3738457710642535e-07
-2.3933319603930414e-07
-2.335665165165146e-07
-2.395021136691877e-07
-2.391845663751724e-07
-2.3318501010671788e-07
-2.3918500907660345e-07
-4.224931136609378e-07
-2.3360715220577255e-07
-5.726836888597653e-07
-4.225594468221239e-07
-1.0503009343354464e-06
-1.0502949787660754e-06
-1.050291678739157e-06
-1.050299034632829e-06
-4.2290118740240246e-07
-2.394572173880505e-07
-4.2237290931446125e-07
-4.22937105282184e-07
-6.277421573663844e-07
-7.714401951686156e-07
-5.732217369658343e-07
-4.2312109643782847e-07
-4.1966474362276074e-07
-3.218208552702162e-07
-3.197352822226218e-07
-7.781460228395431e-07
-4.688537782460145e-07
-3.1993346927272626e-07
-8.408340609888931e-07
-7.776190344976897e-07
-3.1993638227589827e-07
-3.1996693289348954e-07
-6.271441538308054e-07
-6.271724827255909e-07
-3.199363572958802e-07
-1.0128902420136754e-06
-6.271938481905437e-07
-5.709278599885792e-07
-4.2303770941831687e-07
-4.2198403954474273e-07
-4.2303673497556815e-07
-4.223856460705555e-07
-1.1879394832270407e-06
-1.0441379795222971e-06
-7.785721140018964e-07
-6.308222647577466e-07
-3.2342915023964025e-07
-6.308860437398423e-07
-7.785721846120808e-07
-6.308222622042337e-07
-3.2342913375282833e-07
-6.308854686443155e-07
-5.739459576492578e-07
-4.224042032263675e-07
-7.775287300670897e-07
-6.271440339267187e-07
-3.1993637342186965e-07
-7.775287578226653e-07
-6.271440748939483e-07
-7.775288028977201e-07
-6.271440036176301e-07
-7.775287391709185e-07
-6.271441266303412e-07
-3.1993643750949374e-07
-7.77527738748951e-07
-6.271704595661731e-07
-3.1996428997982385e-07
-7.775463015669004e-07
-3.199364714545627e-07
-6.271936199286898e-07
-6.271938092217155e-07
-6.271937699198205e-07
-6.272180115285408e-07
-6.272328532119786e-07
-6.272379172722609e-07
-4.246698816490202e-07
-1.0444050922986392e-06
-6.296218102441742e-07
-4.219934489624322e-07
-4.2240176756358494e-07
-4.219048309606066e-07
-5.733322563927779e-07
-7.7811117582538e-07
-7.787012539228755e-07
-7.78241750931663e-07
-5.737671240346742e-07
-7.758141182812039e-07
-6.272797872242108e-07
-4.2188461907288755e-07
-5.731301992994986e-07
-4.228568799558019e-07
-4.2305582903523486e-07
-4.2192290045095504e-07
-2.3929297812697037e-07
-1.049519992801784e-06
-4.2253809823256105e-07
-3.2099476332536625e-07
-2.358026389426282e-07
-6.273049975025202e-07
-6.274917847548522e-07
-8.41312738308897e-07
-8.413016668318285e-07
-2.3862543757635635e-07
-3.195083152218725e-07
-3.22458431595285e-07
-4.226999055778613e-07
-4.2299202351880894e-07
-4.2305808700682235e-07
-4.268677897267814e-07
-4.2358585278234884e-07
-2.404879707318397e-07
-2.391483978902986e-07
-4.271913506825875e-07
-7.782035785774966e-07
-3.4169556739627183e-07
-5.73670554893102e-07
-4.2300561470254294e-07
-4.225709197003269e-07
-4.225829721704599e-07
-5.736093353636562e-07
-5.388210782553138e-07
</pre></div></div>
</div>
<p>Perfect? Wow.</p>
</section>
<section id="Check-flux-reconstruction-with-inhibition/activation">
<h1>Check flux reconstruction with inhibition/activation<a class="headerlink" href="#Check-flux-reconstruction-with-inhibition/activation" title="Permalink to this heading"></a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reconstructed_vE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">vE</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_flux_set</span><span class="p">):</span>
    <span class="n">sat_expr</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">fwd_sat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_rxn</span><span class="p">)</span>
    <span class="n">back_sat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_rxn</span><span class="p">)</span>
    <span class="n">sat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_rxn</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_rxn</span><span class="p">):</span>
        <span class="c1"># sum terms are separate in logsumexp. one per saturation term (row in C_alpha, C_beta)</span>
        <span class="n">n_term_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">d_alpha</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">n_term_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">d_beta</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">n_term</span> <span class="o">=</span> <span class="n">n_term_s</span> <span class="o">+</span> <span class="n">n_term_p</span>


        <span class="n">Km_s_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">S_s_nz</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">S_s_idx</span> <span class="o">=</span> <span class="n">S_s_nz</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">S_s_nz</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span> <span class="c1"># negate -1 entries</span>

        <span class="n">Km_p_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">S_p_nz</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">S_p_idx</span> <span class="o">=</span> <span class="n">S_p_nz</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">S_p_nz</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span>

        <span class="c1">#S_s_idx = S_s_nz[0, S_s_nz[1, :] == i]</span>

        <span class="n">sat_expr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>           <span class="p">[</span> <span class="p">(</span><span class="n">C_alpha</span> <span class="o">@</span> <span class="n">y_f</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">flatten</span><span class="p">())[</span><span class="n">d_alpha</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span> <span class="p">,</span>
                                     <span class="p">(</span><span class="n">C_beta</span> <span class="o">@</span> <span class="n">y_r</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">flatten</span><span class="p">())[</span><span class="n">d_beta</span> <span class="o">==</span> <span class="n">i</span><span class="p">],</span>
                                     <span class="mi">0</span><span class="p">,</span>
                                     <span class="c1">#-1*np.ones(n_lse_terms - n_term + 1)</span>
                                   <span class="p">]</span>
                       <span class="p">)</span>
        <span class="n">fwd_sat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">S</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">S_s_idx</span><span class="p">]</span> <span class="o">@</span> <span class="n">y_s</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">Km_s_idx</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span> <span class="c1"># + cfwd.value[i]</span>
        <span class="n">back_sat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">S_p_idx</span><span class="p">]</span> <span class="o">@</span> <span class="n">y_p</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">Km_p_idx</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span> <span class="c1"># + cfwd.value[i]</span>



    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sat_expr</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">rxn</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">term</span><span class="p">))</span>

        <span class="n">sat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="p">)</span>

    <span class="n">reconstr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">cfwd</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">*</span> <span class="n">fwd_sat</span><span class="o">/</span><span class="n">sat</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">crev</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">*</span> <span class="n">back_sat</span><span class="o">/</span><span class="n">sat</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">reconstr</span><span class="p">)</span>
    <span class="n">reconstructed_vE</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">reconstr</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[3.85100242e+03 1.60950101e+04 1.23811870e+06 7.97400337e+03
 1.13100071e+03 5.62970438e+04 3.00000356e+02 3.00000172e+02
 3.00000172e+02 3.00000356e+02 1.65050095e+04 5.05770214e+04
 1.06000067e+02 4.73910272e+04 4.73910297e+04 1.00000195e+01
 2.48859171e+05 2.08335764e+06 5.06580214e+04 1.13100071e+03
 5.05840162e+04 5.05840162e+04 3.00000127e+02 4.00000171e+00
 1.96800083e+03 3.07090130e+04 2.08340646e+06 3.00000127e+02
 7.77200185e+03 1.65050039e+04 7.51950318e+04 8.31240351e+04
 5.68000240e+02 1.11928070e+05 9.02660381e+04 3.92070246e+04
 3.92070246e+04 1.00000032e+01 4.64800196e+04 4.64580196e+04
 4.64800196e+04 7.00000226e+00 3.33480191e+04 9.90000467e+01
 1.07100045e+03 2.82300119e+03 2.77348093e+05 3.62220379e+04
 3.33480191e+04 5.30000304e+01 4.39090140e+04 5.71510241e+04
 4.39580371e+04 8.14150344e+04 4.79000114e+03 3.62220116e+04
 6.46800547e+03 3.62390116e+04 3.63320381e+04 2.95130310e+04
 1.28031031e+05 4.27028121e+05 6.73230524e+04 4.39840186e+04
 4.24060243e+04 1.13100048e+03 1.32420056e+04 4.18174731e+06
 3.92070165e+04 5.62250237e+04 5.45000230e+04 1.48600048e+03
 3.06290192e+04 9.07680383e+04 5.05770162e+04 3.27000105e+02
 4.82743340e+05 3.88600164e+03 1.90710109e+04 1.97100047e+03
 1.00000043e+01 2.00000085e+00 1.00000043e+00 2.13100073e+03
 1.10700063e+03 1.00000104e+01 2.35000135e+02 3.00000172e+02
 4.40680186e+04 4.80680113e+04 4.81260276e+04 9.90001040e+01
 9.90000420e+01 4.20930178e+04 4.10590173e+04 1.11928036e+05
 3.92070125e+04 5.40000308e+01 2.58000122e+02 1.06000083e+02
 2.45600104e+03 2.65600112e+03 1.96800113e+03 4.73910297e+04
 4.74890298e+04 5.40000546e+01 4.90000380e+01 4.90000281e+01
 9.10000572e+01 4.39580865e+04 4.41900187e+03 1.71990099e+05
 2.30751142e+06 4.39580252e+04 6.51530275e+04 2.50000143e+01
 7.51950431e+04 3.51110220e+04 9.40100590e+03 1.71170072e+04
 1.22976129e+05 7.68200807e+03 7.68200807e+03 7.08489706e+05
 2.55650108e+04 4.00000095e+03 8.64000672e+02 2.55650199e+04
 3.90460245e+04 1.48600085e+03 9.90000768e+01 9.90000420e+01
 1.72260099e+04 1.07666062e+05 4.39580462e+04 2.70000115e+01
 2.05220215e+04 4.41900187e+03 8.64000208e+02 9.90000568e+01
 1.29000108e+02 2.92050123e+04 9.90000319e+01 9.90000568e+01
 9.90000568e+01 9.90000420e+01 1.32420056e+04 1.32420045e+04
 1.32420056e+04 1.32420076e+04 1.60950068e+04 3.85100163e+03
 1.91970120e+04 1.90710081e+04 6.46700371e+03 1.32420042e+04
 2.05220160e+04 5.71510183e+04 2.00000086e+00 5.35478225e+05
 3.00000172e+00 2.35000100e+02 6.25740200e+04 4.19042217e+05
 4.29720333e+04 3.88600164e+03 3.88600244e+03 1.94300111e+03
 1.94300111e+03 1.94300111e+03 1.94300111e+03 2.58000217e+02
 1.05500082e+03 1.01109043e+05 1.01109043e+05 3.00000070e+00
 1.63800069e+03 4.64800361e+04 4.64800266e+04 4.00000229e+03
 1.38000079e+02 1.40800148e+03 2.22374627e+06 1.64630103e+04
 1.06000045e+02 1.40800088e+03 6.88000395e+02 1.90710109e+04
 1.06000083e+02 1.06000034e+02 3.00000233e+02 1.08000045e+02
 3.67370211e+04 9.71600411e+03 3.81510161e+04 3.81510161e+04
 1.10700047e+03 1.10700116e+03 9.90000420e+01 1.10700070e+03
 1.13100119e+03 1.10700063e+03 4.90000412e+01 3.54713150e+05
 2.09424120e+05 1.22064029e+05 2.23277128e+05 8.32400352e+03
 2.30750293e+06 4.00000169e+03 8.32400477e+03 2.23050094e+04
 2.23050128e+04 4.45120105e+04 4.90000208e+01 4.32000202e+02
 6.46700154e+03 2.35520135e+04 1.97360113e+04 1.32420031e+04
 5.40000228e+01 4.39580342e+04 1.71200098e+03 1.04474060e+05
 6.46700273e+03 2.22527094e+05 4.90000208e+01 4.90001122e+01
 4.90000208e+01 2.55650160e+04 1.02775970e+06 1.41300081e+03
 1.40800109e+03 6.16180260e+04 6.16180260e+04 1.12400026e+05
 1.29000055e+02 1.19000068e+02 1.29000081e+02 1.29000081e+02
 1.29000055e+02 1.07100034e+03 4.25950100e+04 2.35050099e+04
 2.01000126e+02 4.90001179e+01 1.00000043e+01 1.00000078e+01
 9.07850383e+04 4.82580204e+04 1.00000043e+01 4.90000381e+01
 5.62970322e+04 5.62970133e+04 4.90000281e+01 7.91430825e+04
 5.40000308e+01 4.81260374e+04 1.11100047e+03 1.00000043e+00
 4.81760090e+05 1.48790156e+04 1.07100026e+03 4.73910400e+04
 1.07100045e+03 3.88600093e+03 1.32420112e+04 2.75500173e+03
 1.94300111e+03 5.40000228e+01 1.28871829e+06 2.01000156e+02
 8.08070341e+04 1.32360102e+04 4.06000170e+02 4.01300161e+03
 1.06000034e+02 1.06000061e+02 1.41300081e+03 7.40700424e+04
 8.90000213e+01 5.40000418e+01 1.81000043e+02 1.87800079e+03
 6.86000289e+02 8.31240351e+04 4.73910152e+04 7.50000180e+02
 3.00000128e+00 1.45500050e+03 7.77200185e+03 7.77200445e+03
 7.77200488e+03 7.77200329e+03 1.00000043e+00 1.94300111e+03
 2.22527094e+05 1.94300111e+03 1.94300111e+03 1.94300111e+03
 1.94300111e+03 1.94300111e+03 1.94300111e+03 1.94300111e+03
 1.94300111e+03 1.94300111e+03 2.10000089e+01 1.69011071e+05
 3.00000128e+00 9.74624411e+05 7.50000471e+02 1.07100061e+03
 1.18000050e+02 7.50000318e+02 4.80000204e+01 4.39090459e+04
 4.39090104e+04 4.41900342e+03 2.01000048e+02 2.93400228e+03
 4.39090461e+04 1.63800069e+03 5.05840317e+04 5.05770290e+04
 5.40000228e+01 1.63800094e+03 2.55650120e+04 9.84120538e+04
 4.81260203e+04 3.12469109e+05 4.81260203e+04 3.33510209e+04
 3.33480256e+04 4.81260302e+04 1.94300111e+03 4.90000208e+01
 3.92070125e+04 7.90780267e+04 2.65600112e+03 4.97000119e+02
 1.77622075e+05 2.28700055e+03 7.00000165e+00 8.50000204e+01
 1.73681606e+07 5.14570217e+04 1.00000042e+03 1.06738179e+06
 4.00000095e+03 1.00000024e+01 1.63800039e+03 1.28969623e+06
 1.37200033e+03 4.90000117e+01 1.89327337e+06 4.90000117e+01
 3.33510141e+04 1.17722126e+06 6.46700370e+03 1.97360083e+04
 4.00000420e+03 4.00000420e+03 4.00000420e+03 4.00000420e+03
 3.88600164e+03 1.94300047e+03 6.27210265e+04 4.00000169e+03
 4.00000251e+03 3.01000232e+02 3.85700221e+03 1.96800083e+03
 5.40000227e+01 1.08000035e+02 3.51100112e+04 8.64000672e+02
 2.00000094e+03 1.00000032e+03 3.33480280e+04 7.29160567e+04
 7.29160233e+04 6.12580196e+04 7.29160457e+04 6.12580384e+04
 7.29160233e+04 4.96859503e+05 7.29160457e+04 1.00000057e+01
 1.94300082e+03 4.96841210e+05 1.94300082e+03 7.15000302e+02
 4.73910563e+04 4.74400495e+04 1.00000078e+01 1.00000063e+01
 1.00000032e+01 1.00000063e+01 1.00000078e+01 1.00000063e+01
 1.00000032e+01 1.00000063e+01 1.00000057e+01 3.06290129e+04
 7.29160567e+04 7.29160457e+04 7.29160233e+04 7.29160567e+04
 7.29160457e+04 7.29160567e+04 7.29160457e+04 7.29160567e+04
 7.29160457e+04 7.29160233e+04 7.08540551e+04 7.09730445e+04
 6.32010202e+04 6.12580476e+04 7.29160233e+04 7.29160457e+04
 7.29160457e+04 7.29160457e+04 7.29160457e+04 6.32010396e+04
 6.12580384e+04 4.90000208e+01 4.90000512e+01 4.90000309e+01
 4.96859210e+05 3.06290129e+04 1.41010858e+06 6.88000394e+02
 1.80000140e+01 1.20000093e+01 8.00000623e+00 2.70000155e+01
 4.90000380e+01 3.33480209e+04 1.41010858e+06 3.88600223e+03
 3.88600164e+03 2.63900112e+03 2.18630092e+04 2.31800055e+03
 3.81000400e+02 2.33390099e+04 2.45000079e+01 4.32880102e+04
 3.64750229e+04 1.41090089e+04 1.87000157e+03 2.18400184e+03
 3.88600093e+03 1.21757738e+06 3.50000113e+01 1.12490048e+04
 3.29400139e+03 2.57000109e+03 4.00000171e+00 1.61000068e+02
 3.16000076e+02 2.50000060e+01 3.00000128e+00 1.19000093e+02
 3.10000106e+01 4.00000229e+00 2.97900126e+03 1.71620073e+04
 1.61860068e+04 1.43000082e+02 3.05899359e+06]
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_vE</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">vE</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">Sd</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Flux set 1&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">ignore_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">df_vE</span><span class="p">[</span><span class="s2">&quot;kind&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Actual flux&quot;</span>
<span class="n">df_recon</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">reconstructed_vE</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">Sd</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Flux set 1&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">ignore_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">df_recon</span><span class="p">[</span><span class="s2">&quot;kind&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Reconstructed flux&quot;</span>

<span class="n">df_reconstr_comp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_vE</span><span class="p">,</span> <span class="n">df_recon</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># df_reconstr_comp</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sort df_reconstr_comp by value</span>
<span class="n">df_reconstr_comp</span> <span class="o">=</span> <span class="n">df_reconstr_comp</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;variable&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_reconstr_comp</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="c1"># change x axis to log scale</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>

<span class="c1"># limit length of y axis labels to 20 characters</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="n">t</span><span class="o">.</span><span class="n">get_text</span><span class="p">()[:</span><span class="mi">20</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">()])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[Text(0, 0, &#39;TRANS-RXN-145&#39;),
 Text(0, 1, &#39;ATPSYN-RXN (reverse)&#39;),
 Text(0, 2, &#39;maintenance_reaction&#39;),
 Text(0, 3, &#39;GAPOXNPHOSPHN-RXN&#39;),
 Text(0, 4, &#39;PHOSGLYPHOS-RXN (rev&#39;),
 Text(0, 5, &#39;NADH-DEHYDROG-A-RXN-&#39;),
 Text(0, 6, &#39;3PGAREARR-RXN (rever&#39;),
 Text(0, 7, &#39;2PGADEHYDRAT-RXN&#39;),
 Text(0, 8, &#39;TRANS-RXN0-545[CCO-P&#39;),
 Text(0, 9, &#39;RXN0-6717&#39;),
 Text(0, 10, &#39;TRANS-RXN0-582-FRU/P&#39;),
 Text(0, 11, &#39;TRANS-RXN0-474&#39;),
 Text(0, 12, &#39;RXN-21817-CPD-9956/P&#39;),
 Text(0, 13, &#39;1PFRUCTPHOSN-RXN&#39;),
 Text(0, 14, &#39;F16ALDOLASE-RXN__FRU&#39;),
 Text(0, 15, &#39;TRIOSEPISOMERIZATION&#39;),
 Text(0, 16, &#39;TRANS-RXN0-277 (reve&#39;),
 Text(0, 17, &#39;PYRUVDEH-RXN&#39;),
 Text(0, 18, &#39;RXN0-5224 (reverse)&#39;),
 Text(0, 19, &#39;GLUTDEHYD-RXN (rever&#39;),
 Text(0, 20, &#39;INORGPYROPHOSPHAT-RX&#39;),
 Text(0, 21, &#39;BIOTIN-CARBOXYL-RXN&#39;),
 Text(0, 22, &#39;RXN0-5055&#39;),
 Text(0, 23, &#39;MALONYL-COA-ACP-TRAN&#39;),
 Text(0, 24, &#39;CITSYN-RXN&#39;),
 Text(0, 25, &#39;RXN-14047&#39;),
 Text(0, 26, &#39;ASPARTASE-RXN (rever&#39;),
 Text(0, 27, &#39;ISOCITDEH-RXN&#39;),
 Text(0, 28, &#39;PEPCARBOX-RXN (rever&#39;),
 Text(0, 29, &#39;SUCCINATE-DEHYDROGEN&#39;),
 Text(0, 30, &#39;ADENYL-KIN-RXN&#39;),
 Text(0, 31, &#39;2OXOGLUTARATEDEH-RXN&#39;),
 Text(0, 32, &#39;PGLYCDEHYDROG-RXN&#39;),
 Text(0, 33, &#39;RXN0-5114[CCO-CYTOSO&#39;),
 Text(0, 34, &#39;PSERTRANSAM-RXN (rev&#39;),
 Text(0, 35, &#39;PEPDEPHOS-RXN (rever&#39;),
 Text(0, 36, &#39;TRANS-RXN-114&#39;),
 Text(0, 37, &#39;FRUCTOKINASE-RXN&#39;),
 Text(0, 38, &#39;RXN0-5186&#39;),
 Text(0, 39, &#39;ASPAMINOTRANS-RXN&#39;),
 Text(0, 40, &#39;GLUTAMINESYN-RXN&#39;),
 Text(0, 41, &#39;PGLUCISOM-RXN-GLC-6-&#39;),
 Text(0, 42, &#39;RIB5PISOM-RXN-CPD-16&#39;),
 Text(0, 43, &#39;ACETOLACTREDUCTOISOM&#39;),
 Text(0, 44, &#39;DIHYDROXYISOVALDEHYD&#39;),
 Text(0, 45, &#39;GLYOHMETRANS-RXN-SER&#39;),
 Text(0, 46, &#39;PRPPSYN-RXN-CPD-1655&#39;),
 Text(0, 47, &#39;METHENYLTHFCYCLOHYDR&#39;),
 Text(0, 48, &#39;METHYLENETHFDEHYDROG&#39;),
 Text(0, 49, &#39;SUCCCOASYN-RXN (reve&#39;),
 Text(0, 50, &#39;RXN-11832&#39;),
 Text(0, 51, &#39;CDPKIN-RXN&#39;),
 Text(0, 52, &#39;ACETOLACTSYN-RXN&#39;),
 Text(0, 53, &#39;ACECOATRANS-RXN-PROP&#39;),
 Text(0, 54, &#39;RXN0-268 (reverse)&#39;),
 Text(0, 55, &#39;ALANINE-AMINOTRANSFE&#39;),
 Text(0, 56, &#39;RXN-6161&#39;),
 Text(0, 57, &#39;RXN-13202&#39;),
 Text(0, 58, &#39;THREONINE-ALDOLASE-R&#39;),
 Text(0, 59, &#39;GLU6PDEHYDROG-RXN-GL&#39;),
 Text(0, 60, &#39;6PGLUCONOLACT-RXN&#39;),
 Text(0, 61, &#39;RXN-9952&#39;),
 Text(0, 62, &#39;2.3.1.180-RXN&#39;),
 Text(0, 63, &#39;RXN-9527&#39;),
 Text(0, 64, &#39;RXN-9523&#39;),
 Text(0, 65, &#39;RXN-9531&#39;),
 Text(0, 66, &#39;RXN-9516&#39;),
 Text(0, 67, &#39;RXN-9661 (reverse)&#39;),
 Text(0, 68, &#39;ENOYL-ACP-REDUCT-NAD&#39;),
 Text(0, 69, &#39;RXN-9659 (reverse)&#39;),
 Text(0, 70, &#39;RXN-9660 (reverse)&#39;),
 Text(0, 71, &#39;RXN-9658 (reverse)&#39;),
 Text(0, 72, &#39;3-OXOACYL-ACP-REDUCT&#39;),
 Text(0, 73, &#39;RXN-9532 (reverse)&#39;),
 Text(0, 74, &#39;RXN-9524 (reverse)&#39;),
 Text(0, 75, &#39;RXN-9518 (reverse)&#39;),
 Text(0, 76, &#39;RXN-9528 (reverse)&#39;),
 Text(0, 77, &#39;RXN-9655&#39;),
 Text(0, 78, &#39;RXN-9533&#39;),
 Text(0, 79, &#39;3-HYDROXYDECANOYL-AC&#39;),
 Text(0, 80, &#39;RXN-9520&#39;),
 Text(0, 81, &#39;4.2.1.59-RXN&#39;),
 Text(0, 82, &#39;RXN-9536 (reverse)&#39;),
 Text(0, 83, &#39;RXN-9535&#39;),
 Text(0, 84, &#39;ASPARTATE-SEMIALDEHY&#39;),
 Text(0, 85, &#39;GDPKIN-RXN&#39;),
 Text(0, 86, &#39;RXN-9662 (reverse)&#39;),
 Text(0, 87, &#39;RXN-9537&#39;),
 Text(0, 88, &#39;UDPKIN-RXN&#39;),
 Text(0, 89, &#39;ISOCIT-CLEAV-RXN&#39;),
 Text(0, 90, &#39;R15-RXN-MET/GLYOX//C&#39;),
 Text(0, 91, &#39;R15-RXN-MET/2-KETOGL&#39;),
 Text(0, 92, &#39;RXN-9539&#39;),
 Text(0, 93, &#39;RXN-9663 (reverse)&#39;),
 Text(0, 94, &#39;3-OXOACYL-ACP-REDUCT&#39;),
 Text(0, 95, &#39;3-HYDROXYDECANOYL-AC&#39;),
 Text(0, 96, &#39;AICARTRANSFORM-RXN-1&#39;),
 Text(0, 97, &#39;IMPCYCLOHYDROLASE-RX&#39;),
 Text(0, 98, &#39;2-ISOPROPYLMALATESYN&#39;),
 Text(0, 99, &#39;RXN-13158&#39;),
 Text(0, 100, &#39;RXN-13163 (reverse)&#39;),
 Text(0, 101, &#39;BRANCHED-CHAINAMINOT&#39;),
 Text(0, 102, &#39;BRANCHED-CHAINAMINOT&#39;),
 Text(0, 103, &#39;TRANS-RXN-3&#39;),
 Text(0, 104, &#39;2TRANSKETO-RXN (reve&#39;),
 Text(0, 105, &#39;SHIKIMATE-5-DEHYDROG&#39;),
 Text(0, 106, &#39;3-DEHYDROQUINATE-DEH&#39;),
 Text(0, 107, &#39;3-DEHYDROQUINATE-SYN&#39;),
 Text(0, 108, &#39;SHIKIMATE-KINASE-RXN&#39;),
 Text(0, 109, &#39;2.5.1.19-RXN&#39;),
 Text(0, 110, &#39;CHORISMATE-SYNTHASE-&#39;),
 Text(0, 111, &#39;RXN-12002&#39;),
 Text(0, 112, &#39;RXN-14014-DELTA1-PIP&#39;),
 Text(0, 113, &#39;TETHYDPICSUCC-RXN&#39;),
 Text(0, 114, &#39;DIHYDRODIPICSYN-RXN&#39;),
 Text(0, 115, &#39;SUCCINYLDIAMINOPIMTR&#39;),
 Text(0, 116, &#39;SUCCDIAMINOPIMDESUCC&#39;),
 Text(0, 117, &#39;DIAMINOPIMEPIM-RXN&#39;),
 Text(0, 118, &#39;DXS-RXN&#39;),
 Text(0, 119, &#39;PYRUFLAVREDUCT-RXN&#39;),
 Text(0, 120, &#39;PYFLAVOXRE-RXN&#39;),
 Text(0, 121, &#39;RXN-15878 (reverse)&#39;),
 Text(0, 122, &#39;2.7.7.60-RXN&#39;),
 Text(0, 123, &#39;DXPREDISOM-RXN (reve&#39;),
 Text(0, 124, &#39;2.7.1.148-RXN&#39;),
 Text(0, 125, &#39;RXN0-302&#39;),
 Text(0, 126, &#39;N-ACETYLGLUTPREDUCT-&#39;),
 Text(0, 127, &#39;N-ACETYLTRANSFER-RXN&#39;),
 Text(0, 128, &#39;ACETYLGLUTKIN-RXN&#39;),
 Text(0, 129, &#39;ACETYLORNTRANSAM-RXN&#39;),
 Text(0, 130, &#39;ACETYLORNDEACET-RXN&#39;),
 Text(0, 131, &#39;PHOSPHOGLUCMUT-RXN-G&#39;),
 Text(0, 132, &#39;DIAMINOPIMDECARB-RXN&#39;),
 Text(0, 133, &#39;ASPARTATEKIN-RXN&#39;),
 Text(0, 134, &#39;FGAMSYN-RXN&#39;),
 Text(0, 135, &#39;GLYRIBONUCSYN-RXN&#39;),
 Text(0, 136, &#39;AIRS-RXN&#39;),
 Text(0, 137, &#39;PRPPAMIDOTRANS-RXN (&#39;),
 Text(0, 138, &#39;GART-RXN-10-FORMYL-T&#39;),
 Text(0, 139, &#39;SAICARSYN-RXN&#39;),
 Text(0, 140, &#39;RXN0-742&#39;),
 Text(0, 141, &#39;AICARSYN-RXN&#39;),
 Text(0, 142, &#39;RXN0-743&#39;),
 Text(0, 143, &#39;CHORISMATEMUT-RXN__C&#39;),
 Text(0, 144, &#39;ISPH2-RXN (reverse)&#39;),
 Text(0, 145, &#39;RIBULP3EPIM-RXN (rev&#39;),
 Text(0, 146, &#39;ASPCARBTRANS-RXN&#39;),
 Text(0, 147, &#39;DIHYDROOROT-RXN (rev&#39;),
 Text(0, 148, &#39;DIHYDROOROTATE-DEHYD&#39;),
 Text(0, 149, &#39;ACETOOHBUTREDUCTOISO&#39;),
 Text(0, 150, &#39;ACETOOHBUTSYN-RXN&#39;),
 Text(0, 151, &#39;BRANCHED-CHAINAMINOT&#39;),
 Text(0, 152, &#39;DIHYDROXYMETVALDEHYD&#39;),
 Text(0, 153, &#39;THREDEHYD-RXN&#39;),
 Text(0, 154, &#39;GLYC3PDEHYDROGBIOSYN&#39;),
 Text(0, 155, &#39;OROPRIBTRANS-RXN (re&#39;),
 Text(0, 156, &#39;OROTPDECARB-RXN&#39;),
 Text(0, 157, &#39;ORNCARBAMTRANSFER-RX&#39;),
 Text(0, 158, &#39;DAHPSYN-RXN__AROG-CP&#39;),
 Text(0, 159, &#39;ARGSUCCINSYN-RXN&#39;),
 Text(0, 160, &#39;ARGSUCCINLYA-RXN&#39;),
 Text(0, 161, &#39;ADENYLOSUCCINATE-SYN&#39;),
 Text(0, 162, &#39;AMPSYN-RXN&#39;),
 Text(0, 163, &#39;GLUC1PADENYLTRANS-RX&#39;),
 Text(0, 164, &#39;glycogen-monomer-ext&#39;),
 Text(0, 165, &#39;SULFATE-ADENYLYLTRAN&#39;),
 Text(0, 166, &#39;TRANS-RXN0-586&#39;),
 Text(0, 167, &#39;1.8.4.8-RXN (reverse&#39;),
 Text(0, 168, &#39;SULFITE-REDUCT-RXN (&#39;),
 Text(0, 169, &#39;THIOREDOXIN-REDUCT-N&#39;),
 Text(0, 170, &#39;ADENYLYLSULFKIN-RXN&#39;),
 Text(0, 171, &#39;ACSERLY-RXN&#39;),
 Text(0, 172, &#39;325-BISPHOSPHATE-NUC&#39;),
 Text(0, 173, &#39;CDPDIGLYSYN-RXN-CTP/&#39;),
 Text(0, 174, &#39;RXN-17018&#39;),
 Text(0, 175, &#39;RXN0-6705&#39;),
 Text(0, 176, &#39;ASNSYNA-RXN&#39;),
 Text(0, 177, &#39;GUANYL-KIN-RXN&#39;),
 Text(0, 178, &#39;GLUTSEMIALDEHYDROG-R&#39;),
 Text(0, 179, &#39;PYRROLINECARBREDUCT-&#39;),
 Text(0, 180, &#39;SPONTPRO-RXN (revers&#39;),
 Text(0, 181, &#39;GLUTKIN-RXN&#39;),
 Text(0, 182, &#39;PREPHENATEDEHYDRAT-R&#39;),
 Text(0, 183, &#39;RXN-10814 (reverse)&#39;),
 Text(0, 184, &#39;ASPARTATEKIN-RXN__AS&#39;),
 Text(0, 185, &#39;PHOSPHASERSYN-RXN-CP&#39;),
 Text(0, 186, &#39;PHOSPHASERDECARB-RXN&#39;),
 Text(0, 187, &#39;ACETOLACTSYN-RXN__AC&#39;),
 Text(0, 188, &#39;GMP-SYN-NH3-RXN&#39;),
 Text(0, 189, &#39;IMP-DEHYDROG-RXN&#39;),
 Text(0, 190, &#39;PREPHENATEDEHYDROG-R&#39;),
 Text(0, 191, &#39;TYROSINE-AMINOTRANSF&#39;),
 Text(0, 192, &#39;HOMOSERDEHYDROG-RXN-&#39;),
 Text(0, 193, &#39;CYSTATHIONINE-BETA-L&#39;),
 Text(0, 194, &#39;O-SUCCHOMOSERLYASE-R&#39;),
 Text(0, 195, &#39;HOMSUCTRAN-RXN&#39;),
 Text(0, 196, &#39;GLYOHMETRANS-RXN-SER&#39;),
 Text(0, 197, &#39;SERINE-O-ACETTRAN-RX&#39;),
 Text(0, 198, &#39;GLUCOSAMINE-6-P-DEAM&#39;),
 Text(0, 199, &#39;2.3.1.157-RXN&#39;),
 Text(0, 200, &#39;5.4.2.10-RXN-CPD-134&#39;),
 Text(0, 201, &#39;NAG1P-URIDYLTRANS-RX&#39;),
 Text(0, 202, &#39;SERINE-O-ACETTRAN-RX&#39;),
 Text(0, 203, &#39;1.5.1.20-RXN-CPD-130&#39;),
 Text(0, 204, &#39;HOMOCYSMET-RXN&#39;),
 Text(0, 205, &#39;RXN-14325&#39;),
 Text(0, 206, &#39;DAHPSYN-RXN__AROH-CP&#39;),
 Text(0, 207, &#39;RXN-17900&#39;),
 Text(0, 208, &#39;HISTPRATPHYD-RXN&#39;),
 Text(0, 209, &#39;ATPPHOSPHORIBOSYLTRA&#39;),
 Text(0, 210, &#39;HISTIDPHOS-RXN[CCO-C&#39;),
 Text(0, 211, &#39;HISTAMINOTRANS-RXN (&#39;),
 Text(0, 212, &#39;HISTCYCLOHYD-RXN&#39;),
 Text(0, 213, &#39;IMIDPHOSDEHYD-RXN&#39;),
 Text(0, 214, &#39;PRIBFAICARPISOM-RXN&#39;),
 Text(0, 215, &#39;RXN-8001&#39;),
 Text(0, 216, &#39;F16BDEPHOS-RXN[CCO-C&#39;),
 Text(0, 217, &#39;ORNDECARBOX-RXN&#39;),
 Text(0, 218, &#39;GLUC1PURIDYLTRANS-RX&#39;),
 Text(0, 219, &#39;PHOSPHAGLYPSYN-RXN-C&#39;),
 Text(0, 220, &#39;PGPPHOSPHA-RXN-CPD-1&#39;),
 Text(0, 221, &#39;1TRANSKETO-RXN-D-SED&#39;),
 Text(0, 222, &#39;RXN0-4342&#39;),
 Text(0, 223, &#39;RXN0-4341&#39;),
 Text(0, 224, &#39;RXN0-4361&#39;),
 Text(0, 225, &#39;5.1.3.20-RXN&#39;),
 Text(0, 226, &#39;RXN0-4301&#39;),
 Text(0, 227, &#39;GLUTATHIONE-SYN-RXN&#39;),
 Text(0, 228, &#39;GLUTCYSLIG-RXN&#39;),
 Text(0, 229, &#39;ANTHRANSYN-RXN&#39;),
 Text(0, 230, &#39;IGPSYN-RXN&#39;),
 Text(0, 231, &#39;TRYPSYN-RXN&#39;),
 Text(0, 232, &#39;PRTRANS-RXN (reverse&#39;),
 Text(0, 233, &#39;PRAISOM-RXN&#39;),
 Text(0, 234, &#39;ALARACECAT-RXN&#39;),
 Text(0, 235, &#39;RXN0-884 (reverse)&#39;),
 Text(0, 236, &#39;FPPSYN-RXN&#39;),
 Text(0, 237, &#39;GPPSYN-RXN&#39;),
 Text(0, 238, &#39;RXN-8999&#39;),
 Text(0, 239, &#39;UDP-NACMUR-ALA-LIG-R&#39;),
 Text(0, 240, &#39;UDP-NACMURALGLDAPLIG&#39;),
 Text(0, 241, &#39;UDP-NACMURALA-GLU-LI&#39;),
 Text(0, 242, &#39;UDP-NACMURALGLDAPAAL&#39;),
 Text(0, 243, &#39;UDPNACETYLMURAMATEDE&#39;),
 Text(0, 244, &#39;NACGLCTRANS-RXN&#39;),
 Text(0, 245, &#39;UDPNACETYLGLUCOSAMEN&#39;),
 Text(0, 246, &#39;PHOSNACMURPENTATRANS&#39;),
 Text(0, 247, &#39;TRANS-RXN0-286&#39;),
 Text(0, 248, &#39;GLUTRACE-RXN&#39;),
 Text(0, 249, &#39;KDO-8PSYNTH-RXN&#39;),
 Text(0, 250, &#39;UDPHYDROXYMYRGLUCOSA&#39;),
 Text(0, 251, &#39;CPM-KDOSYNTH-RXN&#39;),
 Text(0, 252, &#39;KDO-8PPHOSPHAT-RXN&#39;),
 Text(0, 253, &#39;UDPACYLGLCNACDEACETY&#39;),
 Text(0, 254, &#39;UDPNACETYLGLUCOSAMAC&#39;),
 Text(0, 255, &#39;DARAB5PISOM-RXN__CPL&#39;),
 Text(0, 256, &#39;RXN-16804&#39;),
 Text(0, 257, &#39;UNDECAPRENYL-DIPHOSP&#39;),
 Text(0, 258, &#39;1.5.1.20-RXN-5-METHY&#39;),
 Text(0, 259, &#39;HOMOCYSMETB12-RXN-HO&#39;),
 Text(0, 260, &#39;F16BDEPHOS-RXN[CCO-C&#39;),
 Text(0, 261, &#39;RXN0-5186__G7408-MON&#39;),
 Text(0, 262, &#39;S-ADENMETSYN-RXN&#39;),
 Text(0, 263, &#39;ADENPRIBOSYLTRAN-RXN&#39;),
 Text(0, 264, &#39;RXN-19329 (reverse)&#39;),
 Text(0, 265, &#39;DTMPKI-RXN&#39;),
 Text(0, 266, &#39;THYMIDYLATESYN-RXN-M&#39;),
 Text(0, 267, &#39;325-BISPHOSPHATE-NUC&#39;),
 Text(0, 268, &#39;F16BDEPHOS-RXN[CCO-C&#39;),
 Text(0, 269, &#39;DTDPKIN-RXN&#39;),
 Text(0, 270, &#39;ALARACECAT-RXN__CPLX&#39;),
 Text(0, 271, &#39;TRANS-RXN-141&#39;),
 Text(0, 272, &#39;DALADALALIG-RXN__DAL&#39;),
 Text(0, 273, &#39;DEOXYRIBOSE-P-ALD-RX&#39;),
 Text(0, 274, &#39;RXN0-5405&#39;),
 Text(0, 275, &#39;D-PPENTOMUT-RXN (rev&#39;),
 Text(0, 276, &#39;DURIDKI-RXN&#39;),
 Text(0, 277, &#39;URA-PHOSPH-RXN (reve&#39;),
 Text(0, 278, &#39;3.2.2.10-RXN-UMP/WAT&#39;),
 Text(0, 279, &#39;RXN0-5121&#39;),
 Text(0, 280, &#39;TETRAACYLDISACC4KIN-&#39;),
 Text(0, 281, &#39;RXN0-5123&#39;),
 Text(0, 282, &#39;RXN0-5122&#39;),
 Text(0, 283, &#39;RXN0-5118&#39;),
 Text(0, 284, &#39;RXN0-5061&#39;),
 Text(0, 285, &#39;RXN0-5127&#39;),
 Text(0, 286, &#39;KDOTRANS2-RXN&#39;),
 Text(0, 287, &#39;KDOTRANS-RXN&#39;),
 Text(0, 288, &#39;RXN0-5120&#39;),
 Text(0, 289, &#39;RXN0-5126&#39;),
 Text(0, 290, &#39;RXN0-5125&#39;),
 Text(0, 291, &#39;LIPIDADISACCHARIDESY&#39;),
 Text(0, 292, &#39;RXN0-5124&#39;),
 Text(0, 293, &#39;RXN-19737&#39;),
 Text(0, 294, &#39;LIPIDXSYNTHESIS-RXN&#39;),
 Text(0, 295, &#39;LAUROYLACYLTRAN-RXN&#39;),
 Text(0, 296, &#39;MYRISTOYLACYLTRAN-RX&#39;),
 Text(0, 297, &#39;UDPGLUCEPIM-RXN&#39;),
 Text(0, 298, &#39;RXN0-2421&#39;),
 Text(0, 299, &#39;DALADALALIG-RXN__DAL&#39;),
 Text(0, 300, &#39;PRPPSYN-RXN&#39;),
 Text(0, 301, &#39;SPERMIDINESYN-RXN&#39;),
 Text(0, 302, &#39;METHYLTHIOADENOSINE-&#39;),
 Text(0, 303, &#39;SAMDECARB-RXN&#39;),
 Text(0, 304, &#39;TRANS-RXN0-461&#39;),
 Text(0, 305, &#39;GLYCDEH-RXN&#39;),
 Text(0, 306, &#39;CARDIOLIPSYN-RXN-CPD&#39;),
 Text(0, 307, &#39;RXN0-313 (reverse)&#39;),
 Text(0, 308, &#39;RXN-9772&#39;),
 Text(0, 309, &#39;QUINOLINATE-SYNTHA-R&#39;),
 Text(0, 310, &#39;NAD-SYNTH-NH3-RXN&#39;),
 Text(0, 311, &#39;QUINOPRIBOTRANS-RXN &#39;),
 Text(0, 312, &#39;NICONUCADENYLYLTRAN-&#39;),
 Text(0, 313, &#39;TRANS-RXN0-497&#39;),
 Text(0, 314, &#39;PANTOATE-BETA-ALANIN&#39;),
 Text(0, 315, &#39;2-DEHYDROPANTOATE-RE&#39;),
 Text(0, 316, &#39;3-CH3-2-OXOBUTANOATE&#39;),
 Text(0, 317, &#39;ASPDECARBOX-RXN&#39;),
 Text(0, 318, &#39;RXN-14025[CCO-CYTOSO&#39;),
 Text(0, 319, &#39;P-PANTOCYSLIG-RXN&#39;),
 Text(0, 320, &#39;PANTEPADENYLYLTRAN-R&#39;),
 Text(0, 321, &#39;DEPHOSPHOCOAKIN-RXN&#39;),
 Text(0, 322, &#39;PANTOTHENATE-KIN-RXN&#39;),
 Text(0, 323, &#39;P-PANTOCYSDECARB-RXN&#39;),
 Text(0, 324, &#39;RXN0-5461&#39;),
 Text(0, 325, &#39;RXN-15943 (reverse)&#39;),
 Text(0, 326, &#39;ADENOSYLHOMOCYSTEINE&#39;),
 Text(0, 327, &#39;RIBOSYLHOMOCYSTEINAS&#39;),
 Text(0, 328, &#39;RXN-15216&#39;),
 Text(0, 329, &#39;MALSYN-RXN&#39;),
 Text(0, 330, &#39;TRANS-RXN-62A&#39;),
 Text(0, 331, &#39;RXN-11302&#39;),
 Text(0, 332, &#39;GLURS-RXN-GLT-tRNAs/&#39;),
 Text(0, 333, &#39;GLUTRNAREDUCT-RXN (r&#39;),
 Text(0, 334, &#39;GSAAMINOTRANS-RXN&#39;),
 Text(0, 335, &#39;RXN0-5289 (reverse)&#39;),
 Text(0, 336, &#39;RXN0-6562&#39;),
 Text(0, 337, &#39;RXN0-305&#39;),
 Text(0, 338, &#39;PRODISULFREDUCT-A-RX&#39;),
 Text(0, 339, &#39;NUCLEOSIDE-DIPHOSPHA&#39;),
 Text(0, 340, &#39;RXN0-722 (reverse)&#39;),
 Text(0, 341, &#39;RXN0-2501&#39;),
 Text(0, 342, &#39;ACETATEKIN-RXN&#39;),
 Text(0, 343, &#39;TRANS-RXN-1&#39;),
 Text(0, 344, &#39;PORPHOBILSYNTH-RXN&#39;),
 Text(0, 345, &#39;RXN-8992&#39;),
 Text(0, 346, &#39;ASNSYNA-RXN__ASNSYNB&#39;),
 Text(0, 347, &#39;CHORPYRLY-RXN&#39;),
 Text(0, 348, &#39;ISOCHORSYN-RXN__ENTC&#39;),
 Text(0, 349, &#39;UGD-RXN&#39;),
 Text(0, 350, &#39;2-OCTAPRENYLPHENOL-H&#39;),
 Text(0, 351, &#39;2-OCTAPRENYL-6-METHO&#39;),
 Text(0, 352, &#39;OCTAPRENYL-METHYL-ME&#39;),
 Text(0, 353, &#39;2-OCTAPRENYL-6-OHPHE&#39;),
 Text(0, 354, &#39;2-OCTAPRENYL-METHOXY&#39;),
 Text(0, 355, &#39;DHHB-METHYLTRANSFER-&#39;),
 Text(0, 356, &#39;4OHBENZOATE-OCTAPREN&#39;),
 Text(0, 357, &#39;3-OCTAPRENYL-4-OHBEN&#39;),
 Text(0, 358, &#39;LUMAZINESYN-RXN&#39;),
 Text(0, 359, &#39;DIOHBUTANONEPSYN-RXN&#39;),
 Text(0, 360, &#39;DHBDEHYD-RXN&#39;),
 Text(0, 361, &#39;ISOCHORMAT-RXN&#39;),
 Text(0, 362, &#39;RXN-6081&#39;),
 Text(0, 363, &#39;RXN-11032 (reverse)&#39;),
 Text(0, 364, &#39;RXN3O-470-ACETALD//C&#39;),
 Text(0, 365, &#39;RXN0-16&#39;),
 Text(0, 366, &#39;GLUTDECARBOX-RXN__GL&#39;),
 Text(0, 367, &#39;UNDECAPRENYL-DIPHOSP&#39;),
 Text(0, 368, &#39;NAD-KIN-RXN&#39;),
 Text(0, 369, &#39;GTP-CYCLOHYDRO-II-RX&#39;),
 Text(0, 370, &#39;RIBOFLAVINSYNDEAM-RX&#39;),
 Text(0, 371, &#39;RIBOFLAVINSYNREDUC-R&#39;),
 Text(0, 372, &#39;RIBOPHOSPHAT-RXN&#39;),
 Text(0, 373, &#39;RIBOFLAVIN-SYN-RXN&#39;),
 Text(0, 374, &#39;RXN-9535__FABB-CPLX&#39;),
 Text(0, 375, &#39;RIBOFLAVINKIN-RXN&#39;),
 Text(0, 376, &#39;RXN0-6550&#39;),
 Text(0, 377, &#39;OHMETHYLBILANESYN-RX&#39;),
 Text(0, 378, &#39;UROGENIIISYN-RXN&#39;),
 Text(0, 379, &#39;O-SUCCINYLBENZOATE-C&#39;),
 Text(0, 380, &#39;DMK-RXN&#39;),
 Text(0, 381, &#39;2.5.1.64-RXN&#39;),
 Text(0, 382, &#39;RXN-9311&#39;),
 Text(0, 383, &#39;NAPHTHOATE-SYN-RXN&#39;),
 Text(0, 384, &#39;O-SUCCINYLBENZOATE-C&#39;),
 Text(0, 385, &#39;RXN-9310&#39;),
 Text(0, 386, &#39;DIHYDROFOLATESYNTH-R&#39;),
 Text(0, 387, &#39;GLYCOLALD-DEHYDROG-R&#39;),
 Text(0, 388, &#39;H2NEOPTERINP3PYROPHO&#39;),
 Text(0, 389, &#39;GTP-CYCLOHYDRO-I-RXN&#39;),
 Text(0, 390, &#39;H2PTERIDINEPYROPHOSP&#39;),
 Text(0, 391, &#39;ADCLY-RXN&#39;),
 Text(0, 392, &#39;H2PTEROATESYNTH-RXN&#39;),
 Text(0, 393, &#39;PABASYN-RXN&#39;),
 Text(0, 394, &#39;DIHYDRONEOPTERIN-MON&#39;),
 Text(0, 395, &#39;GLYCOLATEDEHYDRO-RXN&#39;),
 Text(0, 396, &#39;H2NEOPTERINALDOL-RXN&#39;),
 Text(0, 397, &#39;FADSYN-RXN&#39;),
 Text(0, 398, &#39;RXN0-12&#39;),
 Text(0, 399, &#39;TRANS-RXN-141B&#39;),
 Text(0, 400, &#39;ENTMULTI-RXN&#39;),
 Text(0, 401, &#39;RXN0-1461&#39;),
 Text(0, 402, &#39;DIMETHUROPORDEHYDROG&#39;),
 Text(0, 403, &#39;RXN-13403&#39;),
 Text(0, 404, &#39;PROTOHEMEFERROCHELAT&#39;),
 Text(0, 405, &#39;SIROHEME-FERROCHELAT&#39;),
 Text(0, 406, &#39;RXN-21483-PROTOPORPH&#39;),
 Text(0, 407, &#39;UROGENDECARBOX-RXN&#39;),
 Text(0, 408, &#39;ADOMET-DMK-METHYLTRA&#39;),
 Text(0, 409, &#39;RXN-11319&#39;),
 Text(0, 410, &#39;PYRIMSYN1-RXN&#39;),
 Text(0, 411, &#39;RXN-9788&#39;),
 Text(0, 412, &#39;PDXJ-RXN&#39;),
 Text(0, 413, &#39;RXN-12611&#39;),
 Text(0, 414, &#39;ERYTH4PDEHYDROG-RXN&#39;),
 Text(0, 415, &#39;THIAZOLSYN2-RXN&#39;),
 Text(0, 416, &#39;RXN-9789&#39;),
 Text(0, 417, &#39;ERYTHRON4PDEHYDROG-R&#39;),
 Text(0, 418, &#39;RXN-13179&#39;),
 Text(0, 419, &#39;PYRIMSYN3-RXN&#39;),
 Text(0, 420, &#39;PSERTRANSAMPYR-RXN (&#39;),
 Text(0, 421, &#39;RXN-9787&#39;),
 Text(0, 422, &#39;THI-P-KIN-RXN&#39;),
 Text(0, 423, &#39;PNPOXI-RXN&#39;),
 Text(0, 424, &#39;TRANS-RXN0-556[CCO-P&#39;),
 Text(0, 425, &#39;TRANS-RXN0-500&#39;),
 Text(0, 426, &#39;RXN0-7352-GMP/WATER/&#39;),
 Text(0, 427, &#39;F16ALDOLASE-RXN__FRU&#39;),
 Text(0, 428, &#39;RXN0-313__CPLX0-201 &#39;),
 Text(0, 429, &#39;RXN0-748 (reverse)&#39;),
 Text(0, 430, &#39;GMKALT-RXN (reverse)&#39;),
 Text(0, 431, &#39;GDPPYPHOSKIN-RXN&#39;),
 Text(0, 432, &#39;ISOCHORSYN-RXN__MENF&#39;),
 Text(0, 433, &#39;CATAL-RXN__CPLX0-168&#39;),
 Text(0, 434, &#39;RXN0-5185[CCO-CYTOSO&#39;),
 Text(0, 435, &#39;RXN0-723&#39;),
 Text(0, 436, &#39;RXN0-745&#39;),
 Text(0, 437, &#39;2.8.1.6-RXN&#39;),
 Text(0, 438, &#39;DETHIOBIOTIN-SYN-RXN&#39;),
 Text(0, 439, &#39;RXN-11479&#39;),
 Text(0, 440, &#39;RXN-11474&#39;),
 Text(0, 441, &#39;RXN-11484&#39;),
 Text(0, 442, &#39;RXN-11478 (reverse)&#39;),
 Text(0, 443, &#39;RXN-11482 (reverse)&#39;),
 Text(0, 444, &#39;RXN-11476 (reverse)&#39;),
 Text(0, 445, &#39;RXN-11480 (reverse)&#39;),
 Text(0, 446, &#39;RXN-11483&#39;),
 Text(0, 447, &#39;FERREDOXIN--NAD+-RED&#39;),
 Text(0, 448, &#39;RXN-12588&#39;),
 Text(0, 449, &#39;RXN-11475&#39;),
 Text(0, 450, &#39;DAPASYN-RXN&#39;),
 Text(0, 451, &#39;RXN-11477&#39;),
 Text(0, 452, &#39;RXN-11481&#39;),
 Text(0, 453, &#39;ACETYL-COA-ACETYLTRA&#39;),
 Text(0, 454, &#39;TRANS-RXN0-459&#39;),
 Text(0, 455, &#39;RXN0-746&#39;),
 Text(0, 456, &#39;ACONITATEDEHYDR-RXN&#39;),
 Text(0, 457, &#39;TRANS-RXN-141A&#39;),
 Text(0, 458, &#39;RXN0-384__H2NEOPTERI&#39;),
 Text(0, 459, &#39;F16BDEPHOS-RXN[CCO-C&#39;),
 Text(0, 460, &#39;3.2.2.10-RXN-CMP/WAT&#39;),
 Text(0, 461, &#39;INOSINEKIN-RXN&#39;),
 Text(0, 462, &#39;RXN-7609[CCO-CYTOSOL&#39;),
 Text(0, 463, &#39;RXN0-5199&#39;),
 Text(0, 464, &#39;RXN0-310&#39;),
 Text(0, 465, &#39;METHYLMALONYL-COA-MU&#39;),
 Text(0, 466, &#39;INOPHOSPHOR-RXN (rev&#39;),
 Text(0, 467, &#39;DEOXYADENPHOSPHOR-RX&#39;),
 Text(0, 468, &#39;RXN0-5038&#39;),
 Text(0, 469, &#39;RXN-14026[CCO-CYTOSO&#39;),
 Text(0, 470, &#39;DEOXYGUANPHOSPHOR-RX&#39;)]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_fbagd_generate_flow_data_39_1.png" src="../../_images/notebooks_fbagd_generate_flow_data_39_1.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">convex_kinetics_new</span> <span class="kn">import</span> <span class="n">ConvexKineticsNew</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E</span> <span class="o">=</span> <span class="n">ConvexKineticsNew</span><span class="p">()</span>
<span class="n">y_f</span><span class="p">,</span> <span class="n">y_r</span><span class="p">,</span> <span class="n">y_s</span><span class="p">,</span> <span class="n">y_p</span><span class="p">,</span> <span class="n">y_i</span><span class="p">,</span> <span class="n">y_a</span><span class="p">,</span> <span class="n">cfwd</span><span class="p">,</span> <span class="n">crev</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">Km_s</span><span class="p">,</span> <span class="n">Km_p</span><span class="p">,</span> <span class="n">Km_i</span><span class="p">,</span> <span class="n">Km_a</span><span class="p">,</span> <span class="n">S_s</span><span class="p">,</span> <span class="n">S_p</span><span class="p">,</span> <span class="n">S_i</span><span class="p">,</span> <span class="n">S_a</span><span class="p">,</span> \
            <span class="n">met_s_nz</span><span class="p">,</span> <span class="n">met_p_nz</span><span class="p">,</span> <span class="n">met_i_nz</span><span class="p">,</span> <span class="n">met_a_nz</span><span class="p">,</span> <span class="n">rxn_s_nz</span><span class="p">,</span> <span class="n">rxn_p_nz</span><span class="p">,</span> <span class="n">rxn_i_nz</span><span class="p">,</span> <span class="n">rxn_a_nz</span><span class="p">,</span> \
            <span class="n">n_rxn</span><span class="p">,</span> <span class="n">n_met</span><span class="p">,</span> <span class="n">n_flux_set</span><span class="p">,</span> <span class="n">S_s_nz</span><span class="p">,</span> <span class="n">S_p_nz</span><span class="p">,</span> <span class="n">S</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">set_up_variables</span><span class="p">(</span><span class="n">S_matrix</span><span class="o">=</span><span class="n">Sd</span><span class="p">,</span> <span class="n">R_matrix</span><span class="o">=</span><span class="n">Sr</span><span class="p">,</span> <span class="n">flow_data</span><span class="o">=</span><span class="n">vE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Number of metabolites: 491, number of reactions: 471, number of flux sets: 1
Number of Km_s: 998, number of Km_p: 1117, number of Km_i: None, number of Km_a: None
Number of concentrations: (491, 1), number of y_f: (1, 998), number of y_r: (1, 1117)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">C_alpha</span><span class="p">,</span> <span class="n">C_beta</span><span class="p">,</span> <span class="n">d_alpha</span><span class="p">,</span> <span class="n">d_beta</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">construct_binding_matrix</span><span class="p">(</span><span class="n">n_rxn</span><span class="p">,</span> <span class="n">S_s</span><span class="p">,</span> <span class="n">S_p</span><span class="p">,</span> <span class="n">S_i</span><span class="p">,</span> <span class="n">S_a</span><span class="p">,</span> <span class="n">Sr</span><span class="p">,</span> <span class="n">met_s_nz</span><span class="p">,</span> <span class="n">met_p_nz</span><span class="p">,</span> <span class="n">met_i_nz</span><span class="p">,</span> <span class="n">met_a_nz</span><span class="p">,</span> <span class="n">rxn_s_nz</span><span class="p">,</span> <span class="n">rxn_p_nz</span><span class="p">,</span> <span class="n">rxn_i_nz</span><span class="p">,</span> <span class="n">rxn_a_nz</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Shape of C_alpha: (1835, 998), shape of C_beta: (2481, 1117)
Shape of d_alpha: (1835,), shape of d_beta: (2481,)
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">LSE_expr</span><span class="p">,</span> <span class="n">denom_expr</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">construct_kinetic_objective</span><span class="p">(</span><span class="n">vE</span><span class="p">,</span> <span class="n">n_flux_set</span><span class="p">,</span> <span class="n">n_rxn</span><span class="p">,</span> <span class="n">C_alpha</span><span class="p">,</span> <span class="n">C_beta</span><span class="p">,</span> <span class="n">d_alpha</span><span class="p">,</span> <span class="n">d_beta</span><span class="p">,</span> <span class="n">S_s_nz</span><span class="p">,</span> <span class="n">S_p_nz</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">y_f</span><span class="p">,</span> <span class="n">y_r</span><span class="p">,</span> <span class="n">y_s</span><span class="p">,</span> <span class="n">y_p</span><span class="p">,</span> <span class="n">cfwd</span><span class="p">,</span> <span class="n">crev</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loss</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">create_objective_function</span><span class="p">(</span><span class="n">cfwd</span><span class="p">,</span> <span class="n">crev</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">Km_s</span><span class="p">,</span> <span class="n">Km_p</span><span class="p">,</span> <span class="n">Km_i</span><span class="p">,</span> <span class="n">Km_a</span><span class="p">,</span> <span class="n">y_s</span><span class="p">,</span> <span class="n">y_p</span><span class="p">,</span> <span class="n">LSE_expr</span><span class="p">,</span> <span class="n">denom_expr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">constr</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">set_parameter_bounds</span><span class="p">(</span><span class="n">cfwd</span><span class="p">,</span> <span class="n">crev</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">Km_s</span><span class="p">,</span> <span class="n">Km_p</span><span class="p">,</span> <span class="n">Km_i</span><span class="p">,</span> <span class="n">Km_a</span><span class="p">,</span> <span class="n">lower_bound</span><span class="o">=-</span><span class="mi">12</span><span class="p">,</span> <span class="n">upper_bound</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">problem</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">set_up_problem</span><span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="n">constr</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/cyrus/.pyenv/versions/3.9.9/envs/viv/lib/python3.9/site-packages/cvxpy/problems/problem.py:155: UserWarning: Objective contains too many subexpressions. Consider vectorizing your CVXPY code to speed up compilation.
  warnings.warn(&#34;Objective contains too many subexpressions. &#34;
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solution</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">problem</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solution</span><span class="o">.</span><span class="n">value</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
52.058741362824904
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reconstructed_vE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">vE</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_flux_set</span><span class="p">):</span>
    <span class="n">sat_expr</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">fwd_sat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_rxn</span><span class="p">)</span>
    <span class="n">back_sat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_rxn</span><span class="p">)</span>
    <span class="n">sat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_rxn</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_rxn</span><span class="p">):</span>
        <span class="c1"># sum terms are separate in logsumexp. one per saturation term (row in C_alpha, C_beta)</span>
        <span class="n">n_term_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">d_alpha</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">n_term_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">d_beta</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">n_term</span> <span class="o">=</span> <span class="n">n_term_s</span> <span class="o">+</span> <span class="n">n_term_p</span>


        <span class="n">Km_s_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">S_s_nz</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">S_s_idx</span> <span class="o">=</span> <span class="n">S_s_nz</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">S_s_nz</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span> <span class="c1"># negate -1 entries</span>

        <span class="n">Km_p_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">S_p_nz</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">S_p_idx</span> <span class="o">=</span> <span class="n">S_p_nz</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">S_p_nz</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span>

        <span class="c1">#S_s_idx = S_s_nz[0, S_s_nz[1, :] == i]</span>

        <span class="n">sat_expr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>           <span class="p">[</span> <span class="p">(</span><span class="n">C_alpha</span> <span class="o">@</span> <span class="n">y_f</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">flatten</span><span class="p">())[</span><span class="n">d_alpha</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span> <span class="p">,</span>
                                     <span class="p">(</span><span class="n">C_beta</span> <span class="o">@</span> <span class="n">y_r</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">flatten</span><span class="p">())[</span><span class="n">d_beta</span> <span class="o">==</span> <span class="n">i</span><span class="p">],</span>
                                     <span class="mi">0</span><span class="p">,</span>
                                     <span class="c1">#-1*np.ones(n_lse_terms - n_term + 1)</span>
                                   <span class="p">]</span>
                       <span class="p">)</span>
        <span class="n">fwd_sat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">S</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">S_s_idx</span><span class="p">]</span> <span class="o">@</span> <span class="n">y_s</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">Km_s_idx</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span> <span class="c1"># + cfwd.value[i]</span>
        <span class="n">back_sat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">S_p_idx</span><span class="p">]</span> <span class="o">@</span> <span class="n">y_p</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">Km_p_idx</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span> <span class="c1"># + cfwd.value[i]</span>



    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sat_expr</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">rxn</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">term</span><span class="p">))</span>

        <span class="n">sat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="p">)</span>

    <span class="n">reconstr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">cfwd</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">*</span> <span class="n">fwd_sat</span><span class="o">/</span><span class="n">sat</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">crev</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">*</span> <span class="n">back_sat</span><span class="o">/</span><span class="n">sat</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">reconstr</span><span class="p">)</span>
    <span class="n">reconstructed_vE</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">reconstr</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[3.85100016e+03 1.60950007e+04 1.23811803e+06 7.97400022e+03
 1.13100005e+03 5.62970029e+04 3.00000024e+02 3.00000011e+02
 3.00000011e+02 3.00000023e+02 1.65050006e+04 5.05770014e+04
 1.06000004e+02 4.73910017e+04 4.73910020e+04 1.00000013e+01
 2.48858990e+05 2.08335702e+06 5.06580014e+04 1.13100005e+03
 5.05840010e+04 5.05840010e+04 3.00000008e+02 4.00000011e+00
 1.96800005e+03 3.07090009e+04 2.08340601e+06 3.00000008e+02
 7.77200012e+03 1.65050003e+04 7.51950021e+04 8.31240023e+04
 5.68000016e+02 1.11928005e+05 9.02660025e+04 3.92070016e+04
 3.92070016e+04 1.00000002e+01 4.64800013e+04 4.64580013e+04
 4.64800013e+04 7.00000015e+00 3.33480012e+04 9.90000030e+01
 1.07100003e+03 2.82300008e+03 2.77348006e+05 3.62220024e+04
 3.33480012e+04 5.30000019e+01 4.39090009e+04 5.71510016e+04
 4.39580023e+04 8.14150023e+04 4.79000008e+03 3.62220008e+04
 6.46800034e+03 3.62390008e+04 3.63320024e+04 2.95130020e+04
 1.28030981e+05 4.27027987e+05 6.73230034e+04 4.39840012e+04
 4.24060016e+04 1.13100003e+03 1.32420004e+04 4.18174514e+06
 3.92070011e+04 5.62250016e+04 5.45000015e+04 1.48600003e+03
 3.06290013e+04 9.07680025e+04 5.05770010e+04 3.27000007e+02
 4.82743001e+05 3.88600011e+03 1.90710007e+04 1.97100003e+03
 1.00000003e+01 2.00000006e+00 1.00000003e+00 2.13100005e+03
 1.10700004e+03 1.00000007e+01 2.35000009e+02 3.00000011e+02
 4.40680012e+04 4.80680008e+04 4.81260018e+04 9.90000066e+01
 9.90000028e+01 4.20930012e+04 4.10590011e+04 1.11928002e+05
 3.92070008e+04 5.40000020e+01 2.58000008e+02 1.06000005e+02
 2.45600007e+03 2.65600007e+03 1.96800007e+03 4.73910020e+04
 4.74890020e+04 5.40000036e+01 4.90000025e+01 4.90000018e+01
 9.10000038e+01 4.39580055e+04 4.41900012e+03 1.71990006e+05
 2.30751007e+06 4.39580016e+04 6.51530018e+04 2.50000009e+01
 7.51950028e+04 3.51110015e+04 9.40100039e+03 1.71170005e+04
 1.22976008e+05 7.68200051e+03 7.68200051e+03 7.08489068e+05
 2.55650007e+04 4.00000006e+03 8.64000044e+02 2.55650013e+04
 3.90460016e+04 1.48600005e+03 9.90000050e+01 9.90000028e+01
 1.72260006e+04 1.07666004e+05 4.39580029e+04 2.70000008e+01
 2.05220014e+04 4.41900012e+03 8.64000014e+02 9.90000036e+01
 1.29000007e+02 2.92050008e+04 9.90000020e+01 9.90000036e+01
 9.90000036e+01 9.90000027e+01 1.32420004e+04 1.32420003e+04
 1.32420004e+04 1.32420005e+04 1.60950004e+04 3.85100011e+03
 1.91970008e+04 1.90710005e+04 6.46700024e+03 1.32420003e+04
 2.05220010e+04 5.71510012e+04 2.00000006e+00 5.35478015e+05
 3.00000011e+00 2.35000007e+02 6.25740013e+04 4.19041993e+05
 4.29720022e+04 3.88600011e+03 3.88600016e+03 1.94300007e+03
 1.94300007e+03 1.94300007e+03 1.94300007e+03 2.58000014e+02
 1.05500005e+03 1.01109003e+05 1.01109003e+05 3.00000005e+00
 1.63800005e+03 4.64800023e+04 4.64800017e+04 4.00000015e+03
 1.38000005e+02 1.40800009e+03 2.22374498e+06 1.64630007e+04
 1.06000003e+02 1.40800006e+03 6.88000025e+02 1.90710007e+04
 1.06000005e+02 1.06000002e+02 3.00000015e+02 1.08000003e+02
 3.67370014e+04 9.71600027e+03 3.81510011e+04 3.81510011e+04
 1.10700003e+03 1.10700007e+03 9.90000028e+01 1.10700005e+03
 1.13100008e+03 1.10700004e+03 4.90000026e+01 3.54713010e+05
 2.09423997e+05 1.22064002e+05 2.23277008e+05 8.32400023e+03
 2.30750204e+06 4.00000011e+03 8.32400031e+03 2.23050006e+04
 2.23050008e+04 4.45120007e+04 4.90000014e+01 4.32000013e+02
 6.46700010e+03 2.35520009e+04 1.97360007e+04 1.32420002e+04
 5.40000015e+01 4.39580022e+04 1.71200006e+03 1.04474004e+05
 6.46700018e+03 2.22527006e+05 4.90000014e+01 4.90000069e+01
 4.90000014e+01 2.55650011e+04 1.02775902e+06 1.41300005e+03
 1.40800007e+03 6.16180017e+04 6.16180017e+04 1.12400002e+05
 1.29000004e+02 1.19000004e+02 1.29000005e+02 1.29000005e+02
 1.29000004e+02 1.07100002e+03 4.25950007e+04 2.35050007e+04
 2.01000008e+02 4.90000073e+01 1.00000003e+01 1.00000005e+01
 9.07850025e+04 4.82580013e+04 1.00000003e+01 4.90000025e+01
 5.62970021e+04 5.62970009e+04 4.90000018e+01 7.91430053e+04
 5.40000020e+01 4.81260024e+04 1.11100003e+03 1.00000003e+00
 4.81759985e+05 1.48790010e+04 1.07100002e+03 4.73910025e+04
 1.07100003e+03 3.88600006e+03 1.32420007e+04 2.75500011e+03
 1.94300007e+03 5.40000015e+01 1.28871749e+06 2.01000010e+02
 8.08070022e+04 1.32360007e+04 4.06000011e+02 4.01300011e+03
 1.06000002e+02 1.06000004e+02 1.41300005e+03 7.40700027e+04
 8.90000014e+01 5.40000027e+01 1.81000003e+02 1.87800005e+03
 6.86000019e+02 8.31240023e+04 4.73910010e+04 7.50000012e+02
 3.00000008e+00 1.45500003e+03 7.77200012e+03 7.77200029e+03
 7.77200032e+03 7.77200021e+03 1.00000003e+00 1.94300007e+03
 2.22527006e+05 1.94300007e+03 1.94300007e+03 1.94300007e+03
 1.94300007e+03 1.94300007e+03 1.94300007e+03 1.94300007e+03
 1.94300007e+03 1.94300007e+03 2.10000006e+01 1.69011005e+05
 3.00000008e+00 9.74624027e+05 7.50000031e+02 1.07100004e+03
 1.18000003e+02 7.50000021e+02 4.80000013e+01 4.39090029e+04
 4.39090007e+04 4.41900022e+03 2.01000003e+02 2.93400015e+03
 4.39090029e+04 1.63800005e+03 5.05840021e+04 5.05770018e+04
 5.40000015e+01 1.63800006e+03 2.55650008e+04 9.84119823e+04
 4.81260013e+04 3.12468986e+05 4.81260013e+04 3.33510014e+04
 3.33480017e+04 4.81260020e+04 1.94300007e+03 4.90000014e+01
 3.92070008e+04 7.90780018e+04 2.65600007e+03 4.97000008e+02
 1.77622005e+05 2.28700004e+03 7.00000011e+00 8.50000014e+01
 1.73681573e+07 5.14570014e+04 1.00000003e+03 1.06738109e+06
 4.00000006e+03 1.00000002e+01 1.63800003e+03 1.28969595e+06
 1.37200002e+03 4.90000008e+01 1.89327296e+06 4.90000008e+01
 3.33510009e+04 1.17722101e+06 6.46700024e+03 1.97360005e+04
 4.00000027e+03 4.00000027e+03 4.00000027e+03 4.00000027e+03
 3.88600011e+03 1.94300003e+03 6.27210017e+04 4.00000011e+03
 4.00000017e+03 3.01000015e+02 3.85700014e+03 1.96800005e+03
 5.40000014e+01 1.08000002e+02 3.51100007e+04 8.64000044e+02
 2.00000006e+03 1.00000002e+03 3.33480018e+04 7.29160037e+04
 7.29160015e+04 6.12580013e+04 7.29160030e+04 6.12580025e+04
 7.29160015e+04 4.96859032e+05 7.29160030e+04 1.00000004e+01
 1.94300005e+03 4.96841014e+05 1.94300005e+03 7.15000020e+02
 4.73910037e+04 4.74400032e+04 1.00000005e+01 1.00000004e+01
 1.00000002e+01 1.00000004e+01 1.00000005e+01 1.00000004e+01
 1.00000002e+01 1.00000004e+01 1.00000004e+01 3.06290008e+04
 7.29160037e+04 7.29160030e+04 7.29160015e+04 7.29160037e+04
 7.29160030e+04 7.29160037e+04 7.29160030e+04 7.29160037e+04
 7.29160030e+04 7.29160015e+04 7.08540036e+04 7.09730029e+04
 6.32010013e+04 6.12580031e+04 7.29160015e+04 7.29160030e+04
 7.29160030e+04 7.29160030e+04 7.29160030e+04 6.32010026e+04
 6.12580025e+04 4.90000014e+01 4.90000033e+01 4.90000020e+01
 4.96859014e+05 3.06290008e+04 1.41010803e+06 6.88000025e+02
 1.80000009e+01 1.20000006e+01 8.00000041e+00 2.70000010e+01
 4.90000025e+01 3.33480014e+04 1.41010803e+06 3.88600014e+03
 3.88600011e+03 2.63900007e+03 2.18630006e+04 2.31800004e+03
 3.81000026e+02 2.33390006e+04 2.45000005e+01 4.32880007e+04
 3.64750015e+04 1.41090006e+04 1.87000010e+03 2.18400012e+03
 3.88600006e+03 1.21757701e+06 3.50000007e+01 1.12490003e+04
 3.29400009e+03 2.57000007e+03 4.00000011e+00 1.61000004e+02
 3.16000005e+02 2.50000004e+01 3.00000008e+00 1.19000006e+02
 3.10000007e+01 4.00000015e+00 2.97900008e+03 1.71620005e+04
 1.61860004e+04 1.43000005e+02 3.05899205e+06]
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_vE</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">vE</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">Sd</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Flux set 1&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">ignore_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">df_vE</span><span class="p">[</span><span class="s2">&quot;kind&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Actual flux&quot;</span>
<span class="n">df_recon</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">reconstructed_vE</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">Sd</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Flux set 1&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">ignore_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">df_recon</span><span class="p">[</span><span class="s2">&quot;kind&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Reconstructed flux&quot;</span>

<span class="n">df_reconstr_comp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_vE</span><span class="p">,</span> <span class="n">df_recon</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># df_reconstr_comp</span>
<br/><br/></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sort df_reconstr_comp by value</span>
<span class="n">df_reconstr_comp</span> <span class="o">=</span> <span class="n">df_reconstr_comp</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;variable&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_reconstr_comp</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># change x axis to log scale</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>

<span class="c1"># limit length of y axis labels to 20 characters</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="n">t</span><span class="o">.</span><span class="n">get_text</span><span class="p">()[:</span><span class="mi">20</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">()])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[Text(0, 0, &#39;TRANS-RXN-145&#39;),
 Text(0, 1, &#39;ATPSYN-RXN (reverse)&#39;),
 Text(0, 2, &#39;maintenance_reaction&#39;),
 Text(0, 3, &#39;GAPOXNPHOSPHN-RXN&#39;),
 Text(0, 4, &#39;PHOSGLYPHOS-RXN (rev&#39;),
 Text(0, 5, &#39;NADH-DEHYDROG-A-RXN-&#39;),
 Text(0, 6, &#39;3PGAREARR-RXN (rever&#39;),
 Text(0, 7, &#39;2PGADEHYDRAT-RXN&#39;),
 Text(0, 8, &#39;TRANS-RXN0-545[CCO-P&#39;),
 Text(0, 9, &#39;TRANS-RXN0-582-FRU/P&#39;),
 Text(0, 10, &#39;RXN0-6717&#39;),
 Text(0, 11, &#39;TRANS-RXN0-474&#39;),
 Text(0, 12, &#39;RXN-21817-CPD-9956/P&#39;),
 Text(0, 13, &#39;1PFRUCTPHOSN-RXN&#39;),
 Text(0, 14, &#39;F16ALDOLASE-RXN__FRU&#39;),
 Text(0, 15, &#39;TRIOSEPISOMERIZATION&#39;),
 Text(0, 16, &#39;TRANS-RXN0-277 (reve&#39;),
 Text(0, 17, &#39;PYRUVDEH-RXN&#39;),
 Text(0, 18, &#39;RXN0-5224 (reverse)&#39;),
 Text(0, 19, &#39;GLUTDEHYD-RXN (rever&#39;),
 Text(0, 20, &#39;INORGPYROPHOSPHAT-RX&#39;),
 Text(0, 21, &#39;BIOTIN-CARBOXYL-RXN&#39;),
 Text(0, 22, &#39;RXN0-5055&#39;),
 Text(0, 23, &#39;MALONYL-COA-ACP-TRAN&#39;),
 Text(0, 24, &#39;CITSYN-RXN&#39;),
 Text(0, 25, &#39;RXN-14047&#39;),
 Text(0, 26, &#39;ASPARTASE-RXN (rever&#39;),
 Text(0, 27, &#39;ISOCITDEH-RXN&#39;),
 Text(0, 28, &#39;PEPCARBOX-RXN (rever&#39;),
 Text(0, 29, &#39;SUCCINATE-DEHYDROGEN&#39;),
 Text(0, 30, &#39;ADENYL-KIN-RXN&#39;),
 Text(0, 31, &#39;2OXOGLUTARATEDEH-RXN&#39;),
 Text(0, 32, &#39;PGLYCDEHYDROG-RXN&#39;),
 Text(0, 33, &#39;RXN0-5114[CCO-CYTOSO&#39;),
 Text(0, 34, &#39;PSERTRANSAM-RXN (rev&#39;),
 Text(0, 35, &#39;PEPDEPHOS-RXN (rever&#39;),
 Text(0, 36, &#39;TRANS-RXN-114&#39;),
 Text(0, 37, &#39;FRUCTOKINASE-RXN&#39;),
 Text(0, 38, &#39;RXN0-5186&#39;),
 Text(0, 39, &#39;ASPAMINOTRANS-RXN&#39;),
 Text(0, 40, &#39;GLUTAMINESYN-RXN&#39;),
 Text(0, 41, &#39;PGLUCISOM-RXN-GLC-6-&#39;),
 Text(0, 42, &#39;RIB5PISOM-RXN-CPD-16&#39;),
 Text(0, 43, &#39;ACETOLACTREDUCTOISOM&#39;),
 Text(0, 44, &#39;DIHYDROXYISOVALDEHYD&#39;),
 Text(0, 45, &#39;GLYOHMETRANS-RXN-SER&#39;),
 Text(0, 46, &#39;PRPPSYN-RXN-CPD-1655&#39;),
 Text(0, 47, &#39;METHYLENETHFDEHYDROG&#39;),
 Text(0, 48, &#39;METHENYLTHFCYCLOHYDR&#39;),
 Text(0, 49, &#39;SUCCCOASYN-RXN (reve&#39;),
 Text(0, 50, &#39;RXN-11832&#39;),
 Text(0, 51, &#39;CDPKIN-RXN&#39;),
 Text(0, 52, &#39;ACETOLACTSYN-RXN&#39;),
 Text(0, 53, &#39;ACECOATRANS-RXN-PROP&#39;),
 Text(0, 54, &#39;RXN0-268 (reverse)&#39;),
 Text(0, 55, &#39;ALANINE-AMINOTRANSFE&#39;),
 Text(0, 56, &#39;RXN-6161&#39;),
 Text(0, 57, &#39;RXN-13202&#39;),
 Text(0, 58, &#39;THREONINE-ALDOLASE-R&#39;),
 Text(0, 59, &#39;GLU6PDEHYDROG-RXN-GL&#39;),
 Text(0, 60, &#39;6PGLUCONOLACT-RXN&#39;),
 Text(0, 61, &#39;RXN-9952&#39;),
 Text(0, 62, &#39;RXN-9531&#39;),
 Text(0, 63, &#39;RXN-9527&#39;),
 Text(0, 64, &#39;RXN-9523&#39;),
 Text(0, 65, &#39;RXN-9516&#39;),
 Text(0, 66, &#39;2.3.1.180-RXN&#39;),
 Text(0, 67, &#39;RXN-9660 (reverse)&#39;),
 Text(0, 68, &#39;RXN-9518 (reverse)&#39;),
 Text(0, 69, &#39;3-OXOACYL-ACP-REDUCT&#39;),
 Text(0, 70, &#39;RXN-9659 (reverse)&#39;),
 Text(0, 71, &#39;RXN-9528 (reverse)&#39;),
 Text(0, 72, &#39;RXN-9532 (reverse)&#39;),
 Text(0, 73, &#39;ENOYL-ACP-REDUCT-NAD&#39;),
 Text(0, 74, &#39;RXN-9658 (reverse)&#39;),
 Text(0, 75, &#39;RXN-9524 (reverse)&#39;),
 Text(0, 76, &#39;RXN-9661 (reverse)&#39;),
 Text(0, 77, &#39;RXN-9533&#39;),
 Text(0, 78, &#39;3-HYDROXYDECANOYL-AC&#39;),
 Text(0, 79, &#39;RXN-9520&#39;),
 Text(0, 80, &#39;4.2.1.59-RXN&#39;),
 Text(0, 81, &#39;RXN-9655&#39;),
 Text(0, 82, &#39;RXN-9536 (reverse)&#39;),
 Text(0, 83, &#39;RXN-9535&#39;),
 Text(0, 84, &#39;ASPARTATE-SEMIALDEHY&#39;),
 Text(0, 85, &#39;GDPKIN-RXN&#39;),
 Text(0, 86, &#39;RXN-9662 (reverse)&#39;),
 Text(0, 87, &#39;RXN-9537&#39;),
 Text(0, 88, &#39;UDPKIN-RXN&#39;),
 Text(0, 89, &#39;ISOCIT-CLEAV-RXN&#39;),
 Text(0, 90, &#39;R15-RXN-MET/GLYOX//C&#39;),
 Text(0, 91, &#39;R15-RXN-MET/2-KETOGL&#39;),
 Text(0, 92, &#39;RXN-9539&#39;),
 Text(0, 93, &#39;RXN-9663 (reverse)&#39;),
 Text(0, 94, &#39;3-OXOACYL-ACP-REDUCT&#39;),
 Text(0, 95, &#39;3-HYDROXYDECANOYL-AC&#39;),
 Text(0, 96, &#39;AICARTRANSFORM-RXN-1&#39;),
 Text(0, 97, &#39;IMPCYCLOHYDROLASE-RX&#39;),
 Text(0, 98, &#39;2-ISOPROPYLMALATESYN&#39;),
 Text(0, 99, &#39;RXN-13158&#39;),
 Text(0, 100, &#39;RXN-13163 (reverse)&#39;),
 Text(0, 101, &#39;BRANCHED-CHAINAMINOT&#39;),
 Text(0, 102, &#39;BRANCHED-CHAINAMINOT&#39;),
 Text(0, 103, &#39;TRANS-RXN-3&#39;),
 Text(0, 104, &#39;2TRANSKETO-RXN (reve&#39;),
 Text(0, 105, &#39;SHIKIMATE-5-DEHYDROG&#39;),
 Text(0, 106, &#39;3-DEHYDROQUINATE-DEH&#39;),
 Text(0, 107, &#39;3-DEHYDROQUINATE-SYN&#39;),
 Text(0, 108, &#39;SHIKIMATE-KINASE-RXN&#39;),
 Text(0, 109, &#39;2.5.1.19-RXN&#39;),
 Text(0, 110, &#39;CHORISMATE-SYNTHASE-&#39;),
 Text(0, 111, &#39;RXN-12002&#39;),
 Text(0, 112, &#39;RXN-14014-DELTA1-PIP&#39;),
 Text(0, 113, &#39;TETHYDPICSUCC-RXN&#39;),
 Text(0, 114, &#39;DIHYDRODIPICSYN-RXN&#39;),
 Text(0, 115, &#39;SUCCDIAMINOPIMDESUCC&#39;),
 Text(0, 116, &#39;SUCCINYLDIAMINOPIMTR&#39;),
 Text(0, 117, &#39;DIAMINOPIMEPIM-RXN&#39;),
 Text(0, 118, &#39;DXS-RXN&#39;),
 Text(0, 119, &#39;PYRUFLAVREDUCT-RXN&#39;),
 Text(0, 120, &#39;PYFLAVOXRE-RXN&#39;),
 Text(0, 121, &#39;RXN-15878 (reverse)&#39;),
 Text(0, 122, &#39;2.7.7.60-RXN&#39;),
 Text(0, 123, &#39;DXPREDISOM-RXN (reve&#39;),
 Text(0, 124, &#39;2.7.1.148-RXN&#39;),
 Text(0, 125, &#39;RXN0-302&#39;),
 Text(0, 126, &#39;N-ACETYLGLUTPREDUCT-&#39;),
 Text(0, 127, &#39;N-ACETYLTRANSFER-RXN&#39;),
 Text(0, 128, &#39;ACETYLORNTRANSAM-RXN&#39;),
 Text(0, 129, &#39;ACETYLGLUTKIN-RXN&#39;),
 Text(0, 130, &#39;ACETYLORNDEACET-RXN&#39;),
 Text(0, 131, &#39;PHOSPHOGLUCMUT-RXN-G&#39;),
 Text(0, 132, &#39;DIAMINOPIMDECARB-RXN&#39;),
 Text(0, 133, &#39;ASPARTATEKIN-RXN&#39;),
 Text(0, 134, &#39;FGAMSYN-RXN&#39;),
 Text(0, 135, &#39;GLYRIBONUCSYN-RXN&#39;),
 Text(0, 136, &#39;AIRS-RXN&#39;),
 Text(0, 137, &#39;PRPPAMIDOTRANS-RXN (&#39;),
 Text(0, 138, &#39;GART-RXN-10-FORMYL-T&#39;),
 Text(0, 139, &#39;RXN0-742&#39;),
 Text(0, 140, &#39;SAICARSYN-RXN&#39;),
 Text(0, 141, &#39;AICARSYN-RXN&#39;),
 Text(0, 142, &#39;RXN0-743&#39;),
 Text(0, 143, &#39;CHORISMATEMUT-RXN__C&#39;),
 Text(0, 144, &#39;ISPH2-RXN (reverse)&#39;),
 Text(0, 145, &#39;RIBULP3EPIM-RXN (rev&#39;),
 Text(0, 146, &#39;ASPCARBTRANS-RXN&#39;),
 Text(0, 147, &#39;DIHYDROOROT-RXN (rev&#39;),
 Text(0, 148, &#39;DIHYDROOROTATE-DEHYD&#39;),
 Text(0, 149, &#39;ACETOOHBUTSYN-RXN&#39;),
 Text(0, 150, &#39;ACETOOHBUTREDUCTOISO&#39;),
 Text(0, 151, &#39;BRANCHED-CHAINAMINOT&#39;),
 Text(0, 152, &#39;THREDEHYD-RXN&#39;),
 Text(0, 153, &#39;DIHYDROXYMETVALDEHYD&#39;),
 Text(0, 154, &#39;GLYC3PDEHYDROGBIOSYN&#39;),
 Text(0, 155, &#39;OROPRIBTRANS-RXN (re&#39;),
 Text(0, 156, &#39;OROTPDECARB-RXN&#39;),
 Text(0, 157, &#39;ORNCARBAMTRANSFER-RX&#39;),
 Text(0, 158, &#39;DAHPSYN-RXN__AROG-CP&#39;),
 Text(0, 159, &#39;ARGSUCCINSYN-RXN&#39;),
 Text(0, 160, &#39;ARGSUCCINLYA-RXN&#39;),
 Text(0, 161, &#39;ADENYLOSUCCINATE-SYN&#39;),
 Text(0, 162, &#39;AMPSYN-RXN&#39;),
 Text(0, 163, &#39;GLUC1PADENYLTRANS-RX&#39;),
 Text(0, 164, &#39;glycogen-monomer-ext&#39;),
 Text(0, 165, &#39;SULFATE-ADENYLYLTRAN&#39;),
 Text(0, 166, &#39;TRANS-RXN0-586&#39;),
 Text(0, 167, &#39;1.8.4.8-RXN (reverse&#39;),
 Text(0, 168, &#39;SULFITE-REDUCT-RXN (&#39;),
 Text(0, 169, &#39;THIOREDOXIN-REDUCT-N&#39;),
 Text(0, 170, &#39;ACSERLY-RXN&#39;),
 Text(0, 171, &#39;ADENYLYLSULFKIN-RXN&#39;),
 Text(0, 172, &#39;325-BISPHOSPHATE-NUC&#39;),
 Text(0, 173, &#39;CDPDIGLYSYN-RXN-CTP/&#39;),
 Text(0, 174, &#39;RXN-17018&#39;),
 Text(0, 175, &#39;RXN0-6705&#39;),
 Text(0, 176, &#39;ASNSYNA-RXN&#39;),
 Text(0, 177, &#39;GUANYL-KIN-RXN&#39;),
 Text(0, 178, &#39;GLUTSEMIALDEHYDROG-R&#39;),
 Text(0, 179, &#39;PYRROLINECARBREDUCT-&#39;),
 Text(0, 180, &#39;SPONTPRO-RXN (revers&#39;),
 Text(0, 181, &#39;GLUTKIN-RXN&#39;),
 Text(0, 182, &#39;PREPHENATEDEHYDRAT-R&#39;),
 Text(0, 183, &#39;RXN-10814 (reverse)&#39;),
 Text(0, 184, &#39;ASPARTATEKIN-RXN__AS&#39;),
 Text(0, 185, &#39;PHOSPHASERSYN-RXN-CP&#39;),
 Text(0, 186, &#39;PHOSPHASERDECARB-RXN&#39;),
 Text(0, 187, &#39;ACETOLACTSYN-RXN__AC&#39;),
 Text(0, 188, &#39;GMP-SYN-NH3-RXN&#39;),
 Text(0, 189, &#39;IMP-DEHYDROG-RXN&#39;),
 Text(0, 190, &#39;PREPHENATEDEHYDROG-R&#39;),
 Text(0, 191, &#39;TYROSINE-AMINOTRANSF&#39;),
 Text(0, 192, &#39;HOMOSERDEHYDROG-RXN-&#39;),
 Text(0, 193, &#39;O-SUCCHOMOSERLYASE-R&#39;),
 Text(0, 194, &#39;CYSTATHIONINE-BETA-L&#39;),
 Text(0, 195, &#39;HOMSUCTRAN-RXN&#39;),
 Text(0, 196, &#39;GLYOHMETRANS-RXN-SER&#39;),
 Text(0, 197, &#39;SERINE-O-ACETTRAN-RX&#39;),
 Text(0, 198, &#39;GLUCOSAMINE-6-P-DEAM&#39;),
 Text(0, 199, &#39;2.3.1.157-RXN&#39;),
 Text(0, 200, &#39;5.4.2.10-RXN-CPD-134&#39;),
 Text(0, 201, &#39;NAG1P-URIDYLTRANS-RX&#39;),
 Text(0, 202, &#39;SERINE-O-ACETTRAN-RX&#39;),
 Text(0, 203, &#39;1.5.1.20-RXN-CPD-130&#39;),
 Text(0, 204, &#39;HOMOCYSMET-RXN&#39;),
 Text(0, 205, &#39;RXN-14325&#39;),
 Text(0, 206, &#39;DAHPSYN-RXN__AROH-CP&#39;),
 Text(0, 207, &#39;RXN-17900&#39;),
 Text(0, 208, &#39;HISTPRATPHYD-RXN&#39;),
 Text(0, 209, &#39;ATPPHOSPHORIBOSYLTRA&#39;),
 Text(0, 210, &#39;HISTIDPHOS-RXN[CCO-C&#39;),
 Text(0, 211, &#39;HISTAMINOTRANS-RXN (&#39;),
 Text(0, 212, &#39;HISTCYCLOHYD-RXN&#39;),
 Text(0, 213, &#39;IMIDPHOSDEHYD-RXN&#39;),
 Text(0, 214, &#39;PRIBFAICARPISOM-RXN&#39;),
 Text(0, 215, &#39;RXN-8001&#39;),
 Text(0, 216, &#39;F16BDEPHOS-RXN[CCO-C&#39;),
 Text(0, 217, &#39;ORNDECARBOX-RXN&#39;),
 Text(0, 218, &#39;GLUC1PURIDYLTRANS-RX&#39;),
 Text(0, 219, &#39;PHOSPHAGLYPSYN-RXN-C&#39;),
 Text(0, 220, &#39;PGPPHOSPHA-RXN-CPD-1&#39;),
 Text(0, 221, &#39;1TRANSKETO-RXN-D-SED&#39;),
 Text(0, 222, &#39;RXN0-4342&#39;),
 Text(0, 223, &#39;RXN0-4341&#39;),
 Text(0, 224, &#39;RXN0-4361&#39;),
 Text(0, 225, &#39;RXN0-4301&#39;),
 Text(0, 226, &#39;5.1.3.20-RXN&#39;),
 Text(0, 227, &#39;GLUTATHIONE-SYN-RXN&#39;),
 Text(0, 228, &#39;GLUTCYSLIG-RXN&#39;),
 Text(0, 229, &#39;ANTHRANSYN-RXN&#39;),
 Text(0, 230, &#39;IGPSYN-RXN&#39;),
 Text(0, 231, &#39;TRYPSYN-RXN&#39;),
 Text(0, 232, &#39;PRTRANS-RXN (reverse&#39;),
 Text(0, 233, &#39;PRAISOM-RXN&#39;),
 Text(0, 234, &#39;ALARACECAT-RXN&#39;),
 Text(0, 235, &#39;RXN0-884 (reverse)&#39;),
 Text(0, 236, &#39;FPPSYN-RXN&#39;),
 Text(0, 237, &#39;GPPSYN-RXN&#39;),
 Text(0, 238, &#39;RXN-8999&#39;),
 Text(0, 239, &#39;UDP-NACMURALA-GLU-LI&#39;),
 Text(0, 240, &#39;UDP-NACMURALGLDAPLIG&#39;),
 Text(0, 241, &#39;UDP-NACMURALGLDAPAAL&#39;),
 Text(0, 242, &#39;UDP-NACMUR-ALA-LIG-R&#39;),
 Text(0, 243, &#39;UDPNACETYLMURAMATEDE&#39;),
 Text(0, 244, &#39;NACGLCTRANS-RXN&#39;),
 Text(0, 245, &#39;PHOSNACMURPENTATRANS&#39;),
 Text(0, 246, &#39;UDPNACETYLGLUCOSAMEN&#39;),
 Text(0, 247, &#39;TRANS-RXN0-286&#39;),
 Text(0, 248, &#39;GLUTRACE-RXN&#39;),
 Text(0, 249, &#39;KDO-8PSYNTH-RXN&#39;),
 Text(0, 250, &#39;UDPHYDROXYMYRGLUCOSA&#39;),
 Text(0, 251, &#39;UDPNACETYLGLUCOSAMAC&#39;),
 Text(0, 252, &#39;KDO-8PPHOSPHAT-RXN&#39;),
 Text(0, 253, &#39;CPM-KDOSYNTH-RXN&#39;),
 Text(0, 254, &#39;UDPACYLGLCNACDEACETY&#39;),
 Text(0, 255, &#39;DARAB5PISOM-RXN__CPL&#39;),
 Text(0, 256, &#39;RXN-16804&#39;),
 Text(0, 257, &#39;UNDECAPRENYL-DIPHOSP&#39;),
 Text(0, 258, &#39;1.5.1.20-RXN-5-METHY&#39;),
 Text(0, 259, &#39;HOMOCYSMETB12-RXN-HO&#39;),
 Text(0, 260, &#39;F16BDEPHOS-RXN[CCO-C&#39;),
 Text(0, 261, &#39;RXN0-5186__G7408-MON&#39;),
 Text(0, 262, &#39;S-ADENMETSYN-RXN&#39;),
 Text(0, 263, &#39;ADENPRIBOSYLTRAN-RXN&#39;),
 Text(0, 264, &#39;RXN-19329 (reverse)&#39;),
 Text(0, 265, &#39;THYMIDYLATESYN-RXN-M&#39;),
 Text(0, 266, &#39;DTMPKI-RXN&#39;),
 Text(0, 267, &#39;325-BISPHOSPHATE-NUC&#39;),
 Text(0, 268, &#39;F16BDEPHOS-RXN[CCO-C&#39;),
 Text(0, 269, &#39;DTDPKIN-RXN&#39;),
 Text(0, 270, &#39;ALARACECAT-RXN__CPLX&#39;),
 Text(0, 271, &#39;TRANS-RXN-141&#39;),
 Text(0, 272, &#39;DALADALALIG-RXN__DAL&#39;),
 Text(0, 273, &#39;DEOXYRIBOSE-P-ALD-RX&#39;),
 Text(0, 274, &#39;RXN0-5405&#39;),
 Text(0, 275, &#39;D-PPENTOMUT-RXN (rev&#39;),
 Text(0, 276, &#39;DURIDKI-RXN&#39;),
 Text(0, 277, &#39;3.2.2.10-RXN-UMP/WAT&#39;),
 Text(0, 278, &#39;URA-PHOSPH-RXN (reve&#39;),
 Text(0, 279, &#39;RXN0-5120&#39;),
 Text(0, 280, &#39;RXN0-5126&#39;),
 Text(0, 281, &#39;RXN-19737&#39;),
 Text(0, 282, &#39;KDOTRANS-RXN&#39;),
 Text(0, 283, &#39;RXN0-5061&#39;),
 Text(0, 284, &#39;KDOTRANS2-RXN&#39;),
 Text(0, 285, &#39;LIPIDXSYNTHESIS-RXN&#39;),
 Text(0, 286, &#39;RXN0-5125&#39;),
 Text(0, 287, &#39;RXN0-5118&#39;),
 Text(0, 288, &#39;RXN0-5124&#39;),
 Text(0, 289, &#39;RXN0-5121&#39;),
 Text(0, 290, &#39;RXN0-5123&#39;),
 Text(0, 291, &#39;RXN0-5127&#39;),
 Text(0, 292, &#39;TETRAACYLDISACC4KIN-&#39;),
 Text(0, 293, &#39;LIPIDADISACCHARIDESY&#39;),
 Text(0, 294, &#39;RXN0-5122&#39;),
 Text(0, 295, &#39;MYRISTOYLACYLTRAN-RX&#39;),
 Text(0, 296, &#39;LAUROYLACYLTRAN-RXN&#39;),
 Text(0, 297, &#39;UDPGLUCEPIM-RXN&#39;),
 Text(0, 298, &#39;RXN0-2421&#39;),
 Text(0, 299, &#39;DALADALALIG-RXN__DAL&#39;),
 Text(0, 300, &#39;PRPPSYN-RXN&#39;),
 Text(0, 301, &#39;SPERMIDINESYN-RXN&#39;),
 Text(0, 302, &#39;SAMDECARB-RXN&#39;),
 Text(0, 303, &#39;METHYLTHIOADENOSINE-&#39;),
 Text(0, 304, &#39;TRANS-RXN0-461&#39;),
 Text(0, 305, &#39;GLYCDEH-RXN&#39;),
 Text(0, 306, &#39;CARDIOLIPSYN-RXN-CPD&#39;),
 Text(0, 307, &#39;RXN0-313 (reverse)&#39;),
 Text(0, 308, &#39;RXN-9772&#39;),
 Text(0, 309, &#39;QUINOLINATE-SYNTHA-R&#39;),
 Text(0, 310, &#39;NAD-SYNTH-NH3-RXN&#39;),
 Text(0, 311, &#39;QUINOPRIBOTRANS-RXN &#39;),
 Text(0, 312, &#39;NICONUCADENYLYLTRAN-&#39;),
 Text(0, 313, &#39;TRANS-RXN0-497&#39;),
 Text(0, 314, &#39;PANTOATE-BETA-ALANIN&#39;),
 Text(0, 315, &#39;2-DEHYDROPANTOATE-RE&#39;),
 Text(0, 316, &#39;3-CH3-2-OXOBUTANOATE&#39;),
 Text(0, 317, &#39;ASPDECARBOX-RXN&#39;),
 Text(0, 318, &#39;RXN-14025[CCO-CYTOSO&#39;),
 Text(0, 319, &#39;P-PANTOCYSLIG-RXN&#39;),
 Text(0, 320, &#39;PANTEPADENYLYLTRAN-R&#39;),
 Text(0, 321, &#39;DEPHOSPHOCOAKIN-RXN&#39;),
 Text(0, 322, &#39;PANTOTHENATE-KIN-RXN&#39;),
 Text(0, 323, &#39;P-PANTOCYSDECARB-RXN&#39;),
 Text(0, 324, &#39;RXN0-5461&#39;),
 Text(0, 325, &#39;ADENOSYLHOMOCYSTEINE&#39;),
 Text(0, 326, &#39;RXN-15943 (reverse)&#39;),
 Text(0, 327, &#39;RIBOSYLHOMOCYSTEINAS&#39;),
 Text(0, 328, &#39;RXN-15216&#39;),
 Text(0, 329, &#39;MALSYN-RXN&#39;),
 Text(0, 330, &#39;TRANS-RXN-62A&#39;),
 Text(0, 331, &#39;RXN-11302&#39;),
 Text(0, 332, &#39;GLURS-RXN-GLT-tRNAs/&#39;),
 Text(0, 333, &#39;GLUTRNAREDUCT-RXN (r&#39;),
 Text(0, 334, &#39;GSAAMINOTRANS-RXN&#39;),
 Text(0, 335, &#39;RXN0-5289 (reverse)&#39;),
 Text(0, 336, &#39;RXN0-6562&#39;),
 Text(0, 337, &#39;RXN0-305&#39;),
 Text(0, 338, &#39;PRODISULFREDUCT-A-RX&#39;),
 Text(0, 339, &#39;RXN0-722 (reverse)&#39;),
 Text(0, 340, &#39;NUCLEOSIDE-DIPHOSPHA&#39;),
 Text(0, 341, &#39;RXN0-2501&#39;),
 Text(0, 342, &#39;ACETATEKIN-RXN&#39;),
 Text(0, 343, &#39;TRANS-RXN-1&#39;),
 Text(0, 344, &#39;PORPHOBILSYNTH-RXN&#39;),
 Text(0, 345, &#39;RXN-8992&#39;),
 Text(0, 346, &#39;ASNSYNA-RXN__ASNSYNB&#39;),
 Text(0, 347, &#39;CHORPYRLY-RXN&#39;),
 Text(0, 348, &#39;ISOCHORSYN-RXN__ENTC&#39;),
 Text(0, 349, &#39;UGD-RXN&#39;),
 Text(0, 350, &#39;2-OCTAPRENYL-6-METHO&#39;),
 Text(0, 351, &#39;2-OCTAPRENYLPHENOL-H&#39;),
 Text(0, 352, &#39;OCTAPRENYL-METHYL-ME&#39;),
 Text(0, 353, &#39;DHHB-METHYLTRANSFER-&#39;),
 Text(0, 354, &#39;2-OCTAPRENYL-METHOXY&#39;),
 Text(0, 355, &#39;2-OCTAPRENYL-6-OHPHE&#39;),
 Text(0, 356, &#39;3-OCTAPRENYL-4-OHBEN&#39;),
 Text(0, 357, &#39;4OHBENZOATE-OCTAPREN&#39;),
 Text(0, 358, &#39;LUMAZINESYN-RXN&#39;),
 Text(0, 359, &#39;DIOHBUTANONEPSYN-RXN&#39;),
 Text(0, 360, &#39;DHBDEHYD-RXN&#39;),
 Text(0, 361, &#39;ISOCHORMAT-RXN&#39;),
 Text(0, 362, &#39;RXN-6081&#39;),
 Text(0, 363, &#39;RXN-11032 (reverse)&#39;),
 Text(0, 364, &#39;RXN3O-470-ACETALD//C&#39;),
 Text(0, 365, &#39;RXN0-16&#39;),
 Text(0, 366, &#39;GLUTDECARBOX-RXN__GL&#39;),
 Text(0, 367, &#39;UNDECAPRENYL-DIPHOSP&#39;),
 Text(0, 368, &#39;NAD-KIN-RXN&#39;),
 Text(0, 369, &#39;GTP-CYCLOHYDRO-II-RX&#39;),
 Text(0, 370, &#39;RIBOFLAVINSYNDEAM-RX&#39;),
 Text(0, 371, &#39;RIBOFLAVINSYNREDUC-R&#39;),
 Text(0, 372, &#39;RIBOFLAVIN-SYN-RXN&#39;),
 Text(0, 373, &#39;RIBOPHOSPHAT-RXN&#39;),
 Text(0, 374, &#39;RXN-9535__FABB-CPLX&#39;),
 Text(0, 375, &#39;RIBOFLAVINKIN-RXN&#39;),
 Text(0, 376, &#39;RXN0-6550&#39;),
 Text(0, 377, &#39;OHMETHYLBILANESYN-RX&#39;),
 Text(0, 378, &#39;UROGENIIISYN-RXN&#39;),
 Text(0, 379, &#39;O-SUCCINYLBENZOATE-C&#39;),
 Text(0, 380, &#39;DMK-RXN&#39;),
 Text(0, 381, &#39;2.5.1.64-RXN&#39;),
 Text(0, 382, &#39;RXN-9311&#39;),
 Text(0, 383, &#39;NAPHTHOATE-SYN-RXN&#39;),
 Text(0, 384, &#39;RXN-9310&#39;),
 Text(0, 385, &#39;O-SUCCINYLBENZOATE-C&#39;),
 Text(0, 386, &#39;DIHYDROFOLATESYNTH-R&#39;),
 Text(0, 387, &#39;GLYCOLALD-DEHYDROG-R&#39;),
 Text(0, 388, &#39;GTP-CYCLOHYDRO-I-RXN&#39;),
 Text(0, 389, &#39;H2PTERIDINEPYROPHOSP&#39;),
 Text(0, 390, &#39;H2NEOPTERINP3PYROPHO&#39;),
 Text(0, 391, &#39;ADCLY-RXN&#39;),
 Text(0, 392, &#39;DIHYDRONEOPTERIN-MON&#39;),
 Text(0, 393, &#39;GLYCOLATEDEHYDRO-RXN&#39;),
 Text(0, 394, &#39;PABASYN-RXN&#39;),
 Text(0, 395, &#39;H2PTEROATESYNTH-RXN&#39;),
 Text(0, 396, &#39;H2NEOPTERINALDOL-RXN&#39;),
 Text(0, 397, &#39;FADSYN-RXN&#39;),
 Text(0, 398, &#39;RXN0-12&#39;),
 Text(0, 399, &#39;TRANS-RXN-141B&#39;),
 Text(0, 400, &#39;ENTMULTI-RXN&#39;),
 Text(0, 401, &#39;RXN0-1461&#39;),
 Text(0, 402, &#39;RXN-13403&#39;),
 Text(0, 403, &#39;DIMETHUROPORDEHYDROG&#39;),
 Text(0, 404, &#39;PROTOHEMEFERROCHELAT&#39;),
 Text(0, 405, &#39;SIROHEME-FERROCHELAT&#39;),
 Text(0, 406, &#39;RXN-21483-PROTOPORPH&#39;),
 Text(0, 407, &#39;UROGENDECARBOX-RXN&#39;),
 Text(0, 408, &#39;ADOMET-DMK-METHYLTRA&#39;),
 Text(0, 409, &#39;RXN-11319&#39;),
 Text(0, 410, &#39;PYRIMSYN1-RXN&#39;),
 Text(0, 411, &#39;RXN-9788&#39;),
 Text(0, 412, &#39;PDXJ-RXN&#39;),
 Text(0, 413, &#39;RXN-12611&#39;),
 Text(0, 414, &#39;ERYTH4PDEHYDROG-RXN&#39;),
 Text(0, 415, &#39;THIAZOLSYN2-RXN&#39;),
 Text(0, 416, &#39;RXN-9789&#39;),
 Text(0, 417, &#39;ERYTHRON4PDEHYDROG-R&#39;),
 Text(0, 418, &#39;RXN-13179&#39;),
 Text(0, 419, &#39;PNPOXI-RXN&#39;),
 Text(0, 420, &#39;THI-P-KIN-RXN&#39;),
 Text(0, 421, &#39;PSERTRANSAMPYR-RXN (&#39;),
 Text(0, 422, &#39;PYRIMSYN3-RXN&#39;),
 Text(0, 423, &#39;RXN-9787&#39;),
 Text(0, 424, &#39;TRANS-RXN0-500&#39;),
 Text(0, 425, &#39;TRANS-RXN0-556[CCO-P&#39;),
 Text(0, 426, &#39;RXN0-7352-GMP/WATER/&#39;),
 Text(0, 427, &#39;F16ALDOLASE-RXN__FRU&#39;),
 Text(0, 428, &#39;RXN0-313__CPLX0-201 &#39;),
 Text(0, 429, &#39;RXN0-748 (reverse)&#39;),
 Text(0, 430, &#39;GMKALT-RXN (reverse)&#39;),
 Text(0, 431, &#39;GDPPYPHOSKIN-RXN&#39;),
 Text(0, 432, &#39;ISOCHORSYN-RXN__MENF&#39;),
 Text(0, 433, &#39;CATAL-RXN__CPLX0-168&#39;),
 Text(0, 434, &#39;RXN0-5185[CCO-CYTOSO&#39;),
 Text(0, 435, &#39;RXN0-723&#39;),
 Text(0, 436, &#39;RXN0-745&#39;),
 Text(0, 437, &#39;2.8.1.6-RXN&#39;),
 Text(0, 438, &#39;DETHIOBIOTIN-SYN-RXN&#39;),
 Text(0, 439, &#39;RXN-11479&#39;),
 Text(0, 440, &#39;RXN-11484&#39;),
 Text(0, 441, &#39;RXN-11474&#39;),
 Text(0, 442, &#39;RXN-11480 (reverse)&#39;),
 Text(0, 443, &#39;RXN-11482 (reverse)&#39;),
 Text(0, 444, &#39;RXN-11476 (reverse)&#39;),
 Text(0, 445, &#39;RXN-11478 (reverse)&#39;),
 Text(0, 446, &#39;FERREDOXIN--NAD+-RED&#39;),
 Text(0, 447, &#39;RXN-11483&#39;),
 Text(0, 448, &#39;DAPASYN-RXN&#39;),
 Text(0, 449, &#39;RXN-11475&#39;),
 Text(0, 450, &#39;RXN-12588&#39;),
 Text(0, 451, &#39;ACETYL-COA-ACETYLTRA&#39;),
 Text(0, 452, &#39;RXN-11477&#39;),
 Text(0, 453, &#39;RXN-11481&#39;),
 Text(0, 454, &#39;TRANS-RXN0-459&#39;),
 Text(0, 455, &#39;RXN0-746&#39;),
 Text(0, 456, &#39;ACONITATEDEHYDR-RXN&#39;),
 Text(0, 457, &#39;TRANS-RXN-141A&#39;),
 Text(0, 458, &#39;RXN0-384__H2NEOPTERI&#39;),
 Text(0, 459, &#39;3.2.2.10-RXN-CMP/WAT&#39;),
 Text(0, 460, &#39;F16BDEPHOS-RXN[CCO-C&#39;),
 Text(0, 461, &#39;INOSINEKIN-RXN&#39;),
 Text(0, 462, &#39;RXN0-310&#39;),
 Text(0, 463, &#39;RXN-7609[CCO-CYTOSOL&#39;),
 Text(0, 464, &#39;RXN0-5199&#39;),
 Text(0, 465, &#39;METHYLMALONYL-COA-MU&#39;),
 Text(0, 466, &#39;INOPHOSPHOR-RXN (rev&#39;),
 Text(0, 467, &#39;DEOXYADENPHOSPHOR-RX&#39;),
 Text(0, 468, &#39;RXN0-5038&#39;),
 Text(0, 469, &#39;DEOXYGUANPHOSPHOR-RX&#39;),
 Text(0, 470, &#39;RXN-14026[CCO-CYTOSO&#39;)]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_fbagd_generate_flow_data_52_1.png" src="../../_images/notebooks_fbagd_generate_flow_data_52_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Sd</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;ADCLY-RXN&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
NAD[c]                          0
NADH[c]                         0
PROTON[c]                       1
GLUCONATE[c]                    0
NADP[c]                         0
                               ..
R-3-hydroxymyristoyl-ACPs[c]    0
Adenylated-ThiS-Proteins[c]     0
ThiS-CoASH-proteins[c]          0
Thi-S[c]                        0
FRU[p]                          0
Name: ADCLY-RXN, Length: 491, dtype: int8
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021-2023, The Vivarium E. coli Authors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>